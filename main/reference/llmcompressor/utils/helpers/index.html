<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Documentation for LLM Compressor, an easy-to-use library for compressing large language models for deployment with vLLM."><link href=https://vllm-project.github.io/llm-compressor/main/reference/llmcompressor/utils/helpers/ rel=canonical><link href=../dev/ rel=prev><link href=../metric_logging/ rel=next><link rel=icon href=../../../../assets/llmcompressor-icon-white.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.14"><title>llmcompressor.utils.helpers - LLM Compressor Docs</title><link rel=stylesheet href=../../../../assets/stylesheets/main.342714a4.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../assets/_mkdocstrings.css><link rel=stylesheet href=../../../../stylesheets/style.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta property=og:type content=website><meta property=og:title content="llmcompressor.utils.helpers - LLM Compressor Docs"><meta property=og:description content="Documentation for LLM Compressor, an easy-to-use library for compressing large language models for deployment with vLLM."><meta property=og:image content=https://vllm-project.github.io/llm-compressor/main/assets/images/social/reference/llmcompressor/utils/helpers.png><meta property=og:image:type content=image/png><meta property=og:image:width content=1200><meta property=og:image:height content=630><meta content=https://vllm-project.github.io/llm-compressor/main/reference/llmcompressor/utils/helpers/ property=og:url><meta name=twitter:card content=summary_large_image><meta name=twitter:title content="llmcompressor.utils.helpers - LLM Compressor Docs"><meta name=twitter:description content="Documentation for LLM Compressor, an easy-to-use library for compressing large language models for deployment with vLLM."><meta name=twitter:image content=https://vllm-project.github.io/llm-compressor/main/assets/images/social/reference/llmcompressor/utils/helpers.png></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#llmcompressor.utils.helpers class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title="LLM Compressor Docs" class="md-header__button md-logo" aria-label="LLM Compressor Docs" data-md-component=logo> <img src=../../../../assets/llmcompressor-icon-white.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> LLM Compressor Docs </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> llmcompressor.utils.helpers </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=youtube data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/vllm-project/llm-compressor title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title="LLM Compressor Docs" class="md-nav__button md-logo" aria-label="LLM Compressor Docs" data-md-component=logo> <img src=../../../../assets/llmcompressor-icon-white.png alt=logo> </a> LLM Compressor Docs </label> <div class=md-nav__source> <a href=https://github.com/vllm-project/llm-compressor title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <div class="md-nav__link md-nav__container"> <a href=../../../../getting-started/ class="md-nav__link "> <span class=md-ellipsis> Getting started </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Getting started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../getting-started/install/ class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting-started/compress/ class=md-nav__link> <span class=md-ellipsis> Compress Your Model </span> </a> </li> <li class=md-nav__item> <a href=../../../../getting-started/deploy/ class=md-nav__link> <span class=md-ellipsis> Deploy with vLLM </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../../../guides/ class="md-nav__link "> <span class=md-ellipsis> Guides </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../guides/compression_schemes/ class=md-nav__link> <span class=md-ellipsis> Compression Schemes </span> </a> </li> <li class=md-nav__item> <a href=../../../../guides/saving_a_model/ class=md-nav__link> <span class=md-ellipsis> Saving a Model </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../../../../examples/ class="md-nav__link "> <span class=md-ellipsis> Examples </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../examples/awq/ class=md-nav__link> <span class=md-ellipsis> Quantizing Models with Activation-Aware Quantization (AWQ) </span> </a> </li> <li class=md-nav__item> <a href=../../../../examples/big_models_with_accelerate/ class=md-nav__link> <span class=md-ellipsis> Quantizing Big Models with HF Accelerate </span> </a> </li> <li class=md-nav__item> <a href=../../../../examples/multimodal_audio/ class=md-nav__link> <span class=md-ellipsis> Quantizing Multimodal Audio Models </span> </a> </li> <li class=md-nav__item> <a href=../../../../examples/multimodal_vision/ class=md-nav__link> <span class=md-ellipsis> Quantizing Multimodal Vision-Language Models </span> </a> </li> <li class=md-nav__item> <a href=../../../../examples/quantization_2of4_sparse_w4a16/ class=md-nav__link> <span class=md-ellipsis> int4 Weight Quantization of a 2:4 Sparse Model </span> </a> </li> <li class=md-nav__item> <a href=../../../../examples/quantization_kv_cache/ class=md-nav__link> <span class=md-ellipsis> fp8 Weight, Activation, and KV Cache Quantization </span> </a> </li> <li class=md-nav__item> <a href=../../../../examples/quantization_w4a16/ class=md-nav__link> <span class=md-ellipsis> int4 Weight Quantization </span> </a> </li> <li class=md-nav__item> <a href=../../../../examples/quantization_w8a8_fp8/ class=md-nav__link> <span class=md-ellipsis> fp8 Weight and Activation Quantization </span> </a> </li> <li class=md-nav__item> <a href=../../../../examples/quantization_w8a8_int8/ class=md-nav__link> <span class=md-ellipsis> int8 Weight and Activation Quantization </span> </a> </li> <li class=md-nav__item> <a href=../../../../examples/quantizing_moe/ class=md-nav__link> <span class=md-ellipsis> Quantizing Mixtral-8x7B-Instruct-v0.1 Model with FP8 </span> </a> </li> <li class=md-nav__item> <a href=../../../../examples/sparse_2of4_quantization_fp8/ class=md-nav__link> <span class=md-ellipsis> Applying 2:4 Sparsity with Optional FP8 Quantization </span> </a> </li> <li class=md-nav__item> <a href=../../../../examples/trl_mixin/ class=md-nav__link> <span class=md-ellipsis> Sparse Finetuning with TRL's SFTTrainer </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <div class="md-nav__link md-nav__container"> <a href=../../../../developer/ class="md-nav__link "> <span class=md-ellipsis> Developer </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Developer </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../developer/code-of-conduct/ class=md-nav__link> <span class=md-ellipsis> Code of Conduct </span> </a> </li> <li class=md-nav__item> <a href=../../../../developer/contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing Guide </span> </a> </li> <li class=md-nav__item> <a href=../../../../developer/developing/ class=md-nav__link> <span class=md-ellipsis> Development Guide </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6 checked> <label class=md-nav__link for=__nav_6 id=__nav_6_label tabindex=0> <span class=md-ellipsis> API Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=true> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> API Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1 checked> <div class="md-nav__link md-nav__container"> <a href=../../ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>llmcompressor </span> </a> <label class="md-nav__link " for=__nav_6_1 id=__nav_6_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_1_label aria-expanded=true> <label class=md-nav__title for=__nav_6_1> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>llmcompressor </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../logger/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.logger </span> </a> </li> <li class=md-nav__item> <a href=../../typing/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.typing </span> </a> </li> <li class=md-nav__item> <a href=../../version/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.version </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_5> <div class="md-nav__link md-nav__container"> <a href=../../args/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>args </span> </a> <label class="md-nav__link " for=__nav_6_1_5 id=__nav_6_1_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_1_5_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_5> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>args </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../args/dataset_arguments/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.args.dataset_arguments </span> </a> </li> <li class=md-nav__item> <a href=../../args/model_arguments/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.args.model_arguments </span> </a> </li> <li class=md-nav__item> <a href=../../args/recipe_arguments/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.args.recipe_arguments </span> </a> </li> <li class=md-nav__item> <a href=../../args/training_arguments/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.args.training_arguments </span> </a> </li> <li class=md-nav__item> <a href=../../args/utils/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.args.utils </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_6> <div class="md-nav__link md-nav__container"> <a href=../../core/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>core </span> </a> <label class="md-nav__link " for=__nav_6_1_6 id=__nav_6_1_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_1_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_6> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>core </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../core/helpers/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.core.helpers </span> </a> </li> <li class=md-nav__item> <a href=../../core/lifecycle/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.core.lifecycle </span> </a> </li> <li class=md-nav__item> <a href=../../core/model_layer/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.core.model_layer </span> </a> </li> <li class=md-nav__item> <a href=../../core/session/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.core.session </span> </a> </li> <li class=md-nav__item> <a href=../../core/session_functions/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.core.session_functions </span> </a> </li> <li class=md-nav__item> <a href=../../core/state/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.core.state </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_6_8> <div class="md-nav__link md-nav__container"> <a href=../../core/events/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>events </span> </a> <label class="md-nav__link " for=__nav_6_1_6_8 id=__nav_6_1_6_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_6_8_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_6_8> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>events </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../core/events/event/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.core.events.event </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_7> <div class="md-nav__link md-nav__container"> <a href=../../datasets/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>datasets </span> </a> <label class="md-nav__link " for=__nav_6_1_7 id=__nav_6_1_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_1_7_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_7> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>datasets </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../datasets/utils/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.datasets.utils </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_8> <div class="md-nav__link md-nav__container"> <a href=../../entrypoints/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>entrypoints </span> </a> <label class="md-nav__link " for=__nav_6_1_8 id=__nav_6_1_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_1_8_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_8> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>entrypoints </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../entrypoints/oneshot/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.entrypoints.oneshot </span> </a> </li> <li class=md-nav__item> <a href=../../entrypoints/train/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.entrypoints.train </span> </a> </li> <li class=md-nav__item> <a href=../../entrypoints/utils/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.entrypoints.utils </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_9> <div class="md-nav__link md-nav__container"> <a href=../../metrics/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>metrics </span> </a> <label class="md-nav__link " for=__nav_6_1_9 id=__nav_6_1_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_1_9_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_9> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>metrics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../metrics/logger/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.metrics.logger </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_9_3> <div class="md-nav__link md-nav__container"> <a href=../../metrics/utils/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>utils </span> </a> <label class="md-nav__link " for=__nav_6_1_9_3 id=__nav_6_1_9_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_9_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_9_3> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>utils </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../metrics/utils/frequency_manager/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.metrics.utils.frequency_manager </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>modifiers </span> </a> <label class="md-nav__link " for=__nav_6_1_10 id=__nav_6_1_10_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_1_10_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>modifiers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/factory/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.factory </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/interface/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.interface </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/modifier/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.modifier </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/stage/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.stage </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_6> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/awq/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>awq </span> </a> <label class="md-nav__link " for=__nav_6_1_10_6 id=__nav_6_1_10_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_10_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_6> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>awq </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/awq/base/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.awq.base </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/awq/mappings/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.awq.mappings </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_7> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/distillation/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>distillation </span> </a> <label class="md-nav__link " for=__nav_6_1_10_7 id=__nav_6_1_10_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_10_7_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_7> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>distillation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_7_2> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/distillation/output/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>output </span> </a> <label class="md-nav__link " for=__nav_6_1_10_7_2 id=__nav_6_1_10_7_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_6_1_10_7_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_7_2> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>output </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/distillation/output/base/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.distillation.output.base </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_7_3> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/distillation/utils/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>utils </span> </a> <label class="md-nav__link " for=__nav_6_1_10_7_3 id=__nav_6_1_10_7_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_6_1_10_7_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_7_3> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>utils </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_7_3_2> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/distillation/utils/pytorch/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>pytorch </span> </a> <label class="md-nav__link " for=__nav_6_1_10_7_3_2 id=__nav_6_1_10_7_3_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=6 aria-labelledby=__nav_6_1_10_7_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_7_3_2> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>pytorch </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/distillation/utils/pytorch/kd_factory/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.distillation.utils.pytorch.kd_factory </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/distillation/utils/pytorch/kd_wrapper/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.distillation.utils.pytorch.kd_wrapper </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/distillation/utils/pytorch/model_wrapper/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.distillation.utils.pytorch.model_wrapper </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_8> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/experimental/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>experimental </span> </a> <label class="md-nav__link " for=__nav_6_1_10_8 id=__nav_6_1_10_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_10_8_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_8> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>experimental </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_9> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/logarithmic_equalization/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>logarithmic equalization </span> </a> <label class="md-nav__link " for=__nav_6_1_10_9 id=__nav_6_1_10_9_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_10_9_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_9> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>logarithmic equalization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/logarithmic_equalization/base/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.logarithmic_equalization.base </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_10> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/obcq/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>obcq </span> </a> <label class="md-nav__link " for=__nav_6_1_10_10 id=__nav_6_1_10_10_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_10_10_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_10> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>obcq </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/obcq/base/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.obcq.base </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/obcq/sgpt_base/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.obcq.sgpt_base </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/obcq/sgpt_sparsify/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.obcq.sgpt_sparsify </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_11> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/pruning/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>pruning </span> </a> <label class="md-nav__link " for=__nav_6_1_10_11 id=__nav_6_1_10_11_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_10_11_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_11> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>pruning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/pruning/helpers/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.pruning.helpers </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_11_3> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/pruning/constant/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>constant </span> </a> <label class="md-nav__link " for=__nav_6_1_10_11_3 id=__nav_6_1_10_11_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_6_1_10_11_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_11_3> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>constant </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/pruning/constant/base/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.pruning.constant.base </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_11_4> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/pruning/magnitude/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>magnitude </span> </a> <label class="md-nav__link " for=__nav_6_1_10_11_4 id=__nav_6_1_10_11_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_6_1_10_11_4_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_11_4> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>magnitude </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/pruning/magnitude/base/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.pruning.magnitude.base </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_11_5> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/pruning/utils/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>utils </span> </a> <label class="md-nav__link " for=__nav_6_1_10_11_5 id=__nav_6_1_10_11_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_6_1_10_11_5_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_11_5> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>utils </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_11_5_2> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/pruning/utils/pytorch/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>pytorch </span> </a> <label class="md-nav__link " for=__nav_6_1_10_11_5_2 id=__nav_6_1_10_11_5_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=6 aria-labelledby=__nav_6_1_10_11_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_11_5_2> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>pytorch </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/pruning/utils/pytorch/layer_mask/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.pruning.utils.pytorch.layer_mask </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/pruning/utils/pytorch/mask_factory/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.pruning.utils.pytorch.mask_factory </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_11_6> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/pruning/wanda/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>wanda </span> </a> <label class="md-nav__link " for=__nav_6_1_10_11_6 id=__nav_6_1_10_11_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_6_1_10_11_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_11_6> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>wanda </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/pruning/wanda/base/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.pruning.wanda.base </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/pruning/wanda/wanda_sparsify/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.pruning.wanda.wanda_sparsify </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_12> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/quantization/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>quantization </span> </a> <label class="md-nav__link " for=__nav_6_1_10_12 id=__nav_6_1_10_12_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_10_12_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_12> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>quantization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/quantization/cache/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.quantization.cache </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/quantization/calibration/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.quantization.calibration </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_12_4> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/quantization/gptq/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>gptq </span> </a> <label class="md-nav__link " for=__nav_6_1_10_12_4 id=__nav_6_1_10_12_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_6_1_10_12_4_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_12_4> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>gptq </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/quantization/gptq/base/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.quantization.gptq.base </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/quantization/gptq/gptq_quantize/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.quantization.gptq.gptq_quantize </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_12_5> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/quantization/quantization/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>quantization </span> </a> <label class="md-nav__link " for=__nav_6_1_10_12_5 id=__nav_6_1_10_12_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_6_1_10_12_5_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_12_5> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>quantization </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/quantization/quantization/base/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.quantization.quantization.base </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/quantization/quantization/mixin/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.quantization.quantization.mixin </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_13> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/smoothquant/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>smoothquant </span> </a> <label class="md-nav__link " for=__nav_6_1_10_13 id=__nav_6_1_10_13_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_10_13_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_13> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>smoothquant </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/smoothquant/base/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.smoothquant.base </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/smoothquant/utils/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.smoothquant.utils </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_10_14> <div class="md-nav__link md-nav__container"> <a href=../../modifiers/utils/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>utils </span> </a> <label class="md-nav__link " for=__nav_6_1_10_14 id=__nav_6_1_10_14_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_10_14_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_10_14> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>utils </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../modifiers/utils/constants/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.utils.constants </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/utils/hooks/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.utils.hooks </span> </a> </li> <li class=md-nav__item> <a href=../../modifiers/utils/pytorch_helpers/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.modifiers.utils.pytorch_helpers </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_11> <div class="md-nav__link md-nav__container"> <a href=../../observers/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>observers </span> </a> <label class="md-nav__link " for=__nav_6_1_11 id=__nav_6_1_11_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_1_11_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_11> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>observers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../observers/base/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.observers.base </span> </a> </li> <li class=md-nav__item> <a href=../../observers/helpers/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.observers.helpers </span> </a> </li> <li class=md-nav__item> <a href=../../observers/min_max/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.observers.min_max </span> </a> </li> <li class=md-nav__item> <a href=../../observers/mse/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.observers.mse </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_12> <div class="md-nav__link md-nav__container"> <a href=../../pipelines/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>pipelines </span> </a> <label class="md-nav__link " for=__nav_6_1_12 id=__nav_6_1_12_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_1_12_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_12> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>pipelines </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../pipelines/cache/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.pipelines.cache </span> </a> </li> <li class=md-nav__item> <a href=../../pipelines/registry/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.pipelines.registry </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_12_4> <div class="md-nav__link md-nav__container"> <a href=../../pipelines/basic/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>basic </span> </a> <label class="md-nav__link " for=__nav_6_1_12_4 id=__nav_6_1_12_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_12_4_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_12_4> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>basic </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../pipelines/basic/pipeline/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.pipelines.basic.pipeline </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_12_5> <div class="md-nav__link md-nav__container"> <a href=../../pipelines/data_free/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>data free </span> </a> <label class="md-nav__link " for=__nav_6_1_12_5 id=__nav_6_1_12_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_12_5_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_12_5> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>data free </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../pipelines/data_free/pipeline/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.pipelines.data_free.pipeline </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_12_6> <div class="md-nav__link md-nav__container"> <a href=../../pipelines/independent/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>independent </span> </a> <label class="md-nav__link " for=__nav_6_1_12_6 id=__nav_6_1_12_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_12_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_12_6> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>independent </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../pipelines/independent/pipeline/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.pipelines.independent.pipeline </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_12_7> <div class="md-nav__link md-nav__container"> <a href=../../pipelines/layer_sequential/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>layer sequential </span> </a> <label class="md-nav__link " for=__nav_6_1_12_7 id=__nav_6_1_12_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_12_7_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_12_7> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>layer sequential </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../pipelines/layer_sequential/helpers/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.pipelines.layer_sequential.helpers </span> </a> </li> <li class=md-nav__item> <a href=../../pipelines/layer_sequential/pipeline/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.pipelines.layer_sequential.pipeline </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_12_8> <div class="md-nav__link md-nav__container"> <a href=../../pipelines/sequential/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>sequential </span> </a> <label class="md-nav__link " for=__nav_6_1_12_8 id=__nav_6_1_12_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_12_8_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_12_8> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>sequential </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../pipelines/sequential/helpers/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.pipelines.sequential.helpers </span> </a> </li> <li class=md-nav__item> <a href=../../pipelines/sequential/pipeline/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.pipelines.sequential.pipeline </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_13> <div class="md-nav__link md-nav__container"> <a href=../../pytorch/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>pytorch </span> </a> <label class="md-nav__link " for=__nav_6_1_13 id=__nav_6_1_13_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_1_13_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_13> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>pytorch </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_13_2> <div class="md-nav__link md-nav__container"> <a href=../../pytorch/model_load/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>model load </span> </a> <label class="md-nav__link " for=__nav_6_1_13_2 id=__nav_6_1_13_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_13_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_13_2> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>model load </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../pytorch/model_load/helpers/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.pytorch.model_load.helpers </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_13_3> <div class="md-nav__link md-nav__container"> <a href=../../pytorch/utils/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>utils </span> </a> <label class="md-nav__link " for=__nav_6_1_13_3 id=__nav_6_1_13_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_13_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_13_3> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>utils </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../pytorch/utils/helpers/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.pytorch.utils.helpers </span> </a> </li> <li class=md-nav__item> <a href=../../pytorch/utils/sparsification/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.pytorch.utils.sparsification </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_13_3_4> <div class="md-nav__link md-nav__container"> <a href=../../pytorch/utils/sparsification_info/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>sparsification info </span> </a> <label class="md-nav__link " for=__nav_6_1_13_3_4 id=__nav_6_1_13_3_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_6_1_13_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_13_3_4> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>sparsification info </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../pytorch/utils/sparsification_info/configs/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.pytorch.utils.sparsification_info.configs </span> </a> </li> <li class=md-nav__item> <a href=../../pytorch/utils/sparsification_info/helpers/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.pytorch.utils.sparsification_info.helpers </span> </a> </li> <li class=md-nav__item> <a href=../../pytorch/utils/sparsification_info/module_sparsification_info/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.pytorch.utils.sparsification_info.module_sparsification_info </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_14> <div class="md-nav__link md-nav__container"> <a href=../../recipe/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>recipe </span> </a> <label class="md-nav__link " for=__nav_6_1_14 id=__nav_6_1_14_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_1_14_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_14> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>recipe </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../recipe/base/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.recipe.base </span> </a> </li> <li class=md-nav__item> <a href=../../recipe/container/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.recipe.container </span> </a> </li> <li class=md-nav__item> <a href=../../recipe/metadata/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.recipe.metadata </span> </a> </li> <li class=md-nav__item> <a href=../../recipe/modifier/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.recipe.modifier </span> </a> </li> <li class=md-nav__item> <a href=../../recipe/recipe/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.recipe.recipe </span> </a> </li> <li class=md-nav__item> <a href=../../recipe/stage/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.recipe.stage </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_15> <div class="md-nav__link md-nav__container"> <a href=../../transformers/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>transformers </span> </a> <label class="md-nav__link " for=__nav_6_1_15 id=__nav_6_1_15_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_1_15_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_15> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>transformers </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_15_2> <div class="md-nav__link md-nav__container"> <a href=../../transformers/compression/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>compression </span> </a> <label class="md-nav__link " for=__nav_6_1_15_2 id=__nav_6_1_15_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_15_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_15_2> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>compression </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../transformers/compression/helpers/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.compression.helpers </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/compression/quantization_format/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.compression.quantization_format </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/compression/sparsity_metadata_config/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.compression.sparsity_metadata_config </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_15_3> <div class="md-nav__link md-nav__container"> <a href=../../transformers/finetune/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>finetune </span> </a> <label class="md-nav__link " for=__nav_6_1_15_3 id=__nav_6_1_15_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_15_3_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_15_3> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>finetune </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../transformers/finetune/callbacks/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.callbacks </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/finetune/session_mixin/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.session_mixin </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/finetune/text_generation/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.text_generation </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/finetune/trainer/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.trainer </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_15_3_6> <div class="md-nav__link md-nav__container"> <a href=../../transformers/finetune/data/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>data </span> </a> <label class="md-nav__link " for=__nav_6_1_15_3_6 id=__nav_6_1_15_3_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=5 aria-labelledby=__nav_6_1_15_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_15_3_6> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../transformers/finetune/data/base/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.data.base </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/finetune/data/c4/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.data.c4 </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/finetune/data/cnn_dailymail/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.data.cnn_dailymail </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/finetune/data/custom/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.data.custom </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/finetune/data/data_helpers/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.data.data_helpers </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/finetune/data/evolcodealpaca/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.data.evolcodealpaca </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/finetune/data/flickr_30k/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.data.flickr_30k </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/finetune/data/gsm8k/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.data.gsm8k </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/finetune/data/open_platypus/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.data.open_platypus </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/finetune/data/peoples_speech/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.data.peoples_speech </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/finetune/data/ptb/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.data.ptb </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/finetune/data/ultrachat_200k/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.data.ultrachat_200k </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/finetune/data/wikitext/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.finetune.data.wikitext </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_15_4> <div class="md-nav__link md-nav__container"> <a href=../../transformers/sparsification/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>sparsification </span> </a> <label class="md-nav__link " for=__nav_6_1_15_4 id=__nav_6_1_15_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_15_4_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_15_4> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>sparsification </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../transformers/sparsification/compressed_tensors_utils/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.sparsification.compressed_tensors_utils </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/sparsification/sparse_model/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.sparsification.sparse_model </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_15_5> <div class="md-nav__link md-nav__container"> <a href=../../transformers/tracing/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>tracing </span> </a> <label class="md-nav__link " for=__nav_6_1_15_5 id=__nav_6_1_15_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_15_5_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_15_5> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>tracing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../transformers/tracing/debug/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.tracing.debug </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/tracing/gemma3/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.tracing.gemma3 </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/tracing/idefics3/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.tracing.idefics3 </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/tracing/llava/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.tracing.llava </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/tracing/mllama/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.tracing.mllama </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/tracing/qwen2_5_vl/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.tracing.qwen2_5_vl </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/tracing/qwen2_vl/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.tracing.qwen2_vl </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_15_6> <div class="md-nav__link md-nav__container"> <a href=../../transformers/utils/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>utils </span> </a> <label class="md-nav__link " for=__nav_6_1_15_6 id=__nav_6_1_15_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_15_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_15_6> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>utils </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../transformers/utils/helpers/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.utils.helpers </span> </a> </li> <li class=md-nav__item> <a href=../../transformers/utils/preprocessing_functions/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.transformers.utils.preprocessing_functions </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_16 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>utils </span> </a> <label class="md-nav__link " for=__nav_6_1_16 id=__nav_6_1_16_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_6_1_16_label aria-expanded=true> <label class=md-nav__title for=__nav_6_1_16> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>utils </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../dev/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.utils.dev </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> llmcompressor.utils.helpers </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> llmcompressor.utils.helpers </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers class=md-nav__link> <span class=md-ellipsis> helpers </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.DisableKVCache class=md-nav__link> <span class=md-ellipsis> DisableKVCache </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.NumpyArrayBatcher class=md-nav__link> <span class=md-ellipsis> NumpyArrayBatcher </span> </a> <nav class=md-nav aria-label=NumpyArrayBatcher> <ul class=md-nav__list> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.NumpyArrayBatcher.append class=md-nav__link> <span class=md-ellipsis> append </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.NumpyArrayBatcher.stack class=md-nav__link> <span class=md-ellipsis> stack </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.DisableQuantization class=md-nav__link> <span class=md-ellipsis> DisableQuantization </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.bucket_iterable class=md-nav__link> <span class=md-ellipsis> bucket_iterable </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.calibration_forward_context class=md-nav__link> <span class=md-ellipsis> calibration_forward_context </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.clean_path class=md-nav__link> <span class=md-ellipsis> clean_path </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.convert_to_bool class=md-nav__link> <span class=md-ellipsis> convert_to_bool </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.create_dirs class=md-nav__link> <span class=md-ellipsis> create_dirs </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.create_parent_dirs class=md-nav__link> <span class=md-ellipsis> create_parent_dirs </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.create_unique_dir class=md-nav__link> <span class=md-ellipsis> create_unique_dir </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.flatten_iterable class=md-nav__link> <span class=md-ellipsis> flatten_iterable </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.getattr_chain class=md-nav__link> <span class=md-ellipsis> getattr_chain </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.import_from_path class=md-nav__link> <span class=md-ellipsis> import_from_path </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.interpolate class=md-nav__link> <span class=md-ellipsis> interpolate </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.interpolate_list_linear class=md-nav__link> <span class=md-ellipsis> interpolate_list_linear </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.interpolated_integral class=md-nav__link> <span class=md-ellipsis> interpolated_integral </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.is_package_available class=md-nav__link> <span class=md-ellipsis> is_package_available </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.is_url class=md-nav__link> <span class=md-ellipsis> is_url </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.json_to_jsonl class=md-nav__link> <span class=md-ellipsis> json_to_jsonl </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.load_labeled_data class=md-nav__link> <span class=md-ellipsis> load_labeled_data </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.load_numpy class=md-nav__link> <span class=md-ellipsis> load_numpy </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.load_numpy_from_tar class=md-nav__link> <span class=md-ellipsis> load_numpy_from_tar </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.load_numpy_list class=md-nav__link> <span class=md-ellipsis> load_numpy_list </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.patch_attr class=md-nav__link> <span class=md-ellipsis> patch_attr </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.path_file_count class=md-nav__link> <span class=md-ellipsis> path_file_count </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.path_file_size class=md-nav__link> <span class=md-ellipsis> path_file_size </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.save_numpy class=md-nav__link> <span class=md-ellipsis> save_numpy </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.tensor_export class=md-nav__link> <span class=md-ellipsis> tensor_export </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.tensors_export class=md-nav__link> <span class=md-ellipsis> tensors_export </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.validate_str_iterable class=md-nav__link> <span class=md-ellipsis> validate_str_iterable </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../metric_logging/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.utils.metric_logging </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_16_5> <div class="md-nav__link md-nav__container"> <a href=../fsdp/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>fsdp </span> </a> <label class="md-nav__link " for=__nav_6_1_16_5 id=__nav_6_1_16_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_16_5_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_16_5> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>fsdp </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../fsdp/context/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.utils.fsdp.context </span> </a> </li> <li class=md-nav__item> <a href=../fsdp/helpers/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.utils.fsdp.helpers </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_1_16_6> <div class="md-nav__link md-nav__container"> <a href=../pytorch/ class="md-nav__link "> <span class=md-ellipsis> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>pytorch </span> </a> <label class="md-nav__link " for=__nav_6_1_16_6 id=__nav_6_1_16_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_6_1_16_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6_1_16_6> <span class="md-nav__icon md-icon"></span> <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code>pytorch </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../pytorch/module/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.utils.pytorch.module </span> </a> </li> <li class=md-nav__item> <a href=../pytorch/utils/ class=md-nav__link> <span class=md-ellipsis> llmcompressor.utils.pytorch.utils </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers class=md-nav__link> <span class=md-ellipsis> helpers </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.DisableKVCache class=md-nav__link> <span class=md-ellipsis> DisableKVCache </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.NumpyArrayBatcher class=md-nav__link> <span class=md-ellipsis> NumpyArrayBatcher </span> </a> <nav class=md-nav aria-label=NumpyArrayBatcher> <ul class=md-nav__list> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.NumpyArrayBatcher.append class=md-nav__link> <span class=md-ellipsis> append </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.NumpyArrayBatcher.stack class=md-nav__link> <span class=md-ellipsis> stack </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.DisableQuantization class=md-nav__link> <span class=md-ellipsis> DisableQuantization </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.bucket_iterable class=md-nav__link> <span class=md-ellipsis> bucket_iterable </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.calibration_forward_context class=md-nav__link> <span class=md-ellipsis> calibration_forward_context </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.clean_path class=md-nav__link> <span class=md-ellipsis> clean_path </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.convert_to_bool class=md-nav__link> <span class=md-ellipsis> convert_to_bool </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.create_dirs class=md-nav__link> <span class=md-ellipsis> create_dirs </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.create_parent_dirs class=md-nav__link> <span class=md-ellipsis> create_parent_dirs </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.create_unique_dir class=md-nav__link> <span class=md-ellipsis> create_unique_dir </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.flatten_iterable class=md-nav__link> <span class=md-ellipsis> flatten_iterable </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.getattr_chain class=md-nav__link> <span class=md-ellipsis> getattr_chain </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.import_from_path class=md-nav__link> <span class=md-ellipsis> import_from_path </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.interpolate class=md-nav__link> <span class=md-ellipsis> interpolate </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.interpolate_list_linear class=md-nav__link> <span class=md-ellipsis> interpolate_list_linear </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.interpolated_integral class=md-nav__link> <span class=md-ellipsis> interpolated_integral </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.is_package_available class=md-nav__link> <span class=md-ellipsis> is_package_available </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.is_url class=md-nav__link> <span class=md-ellipsis> is_url </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.json_to_jsonl class=md-nav__link> <span class=md-ellipsis> json_to_jsonl </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.load_labeled_data class=md-nav__link> <span class=md-ellipsis> load_labeled_data </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.load_numpy class=md-nav__link> <span class=md-ellipsis> load_numpy </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.load_numpy_from_tar class=md-nav__link> <span class=md-ellipsis> load_numpy_from_tar </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.load_numpy_list class=md-nav__link> <span class=md-ellipsis> load_numpy_list </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.patch_attr class=md-nav__link> <span class=md-ellipsis> patch_attr </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.path_file_count class=md-nav__link> <span class=md-ellipsis> path_file_count </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.path_file_size class=md-nav__link> <span class=md-ellipsis> path_file_size </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.save_numpy class=md-nav__link> <span class=md-ellipsis> save_numpy </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.tensor_export class=md-nav__link> <span class=md-ellipsis> tensor_export </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.tensors_export class=md-nav__link> <span class=md-ellipsis> tensors_export </span> </a> </li> <li class=md-nav__item> <a href=#llmcompressor.utils.helpers.validate_str_iterable class=md-nav__link> <span class=md-ellipsis> validate_str_iterable </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>llmcompressor.utils.helpers</h1> <div class="doc doc-object doc-module"> <a id=llmcompressor.utils.helpers></a> <div class="doc doc-contents first"> <p>General utility helper functions. Common functions for interfacing with python primitives and directories/files.</p> <div class="doc doc-children"> <div class="doc doc-object doc-class"> <h2 id=llmcompressor.utils.helpers.DisableKVCache class="doc doc-heading"> <code>DisableKVCache</code> </h2> <div class="doc doc-contents "> <p>Temporarily disable the key-value cache for transformer models. Used to prevent excess memory use in one-shot cases where the model only performs the prefill phase and not the generation phase.</p> <p>Example:</p> <blockquote> <blockquote> <blockquote> <p>model = AutoModel.from_pretrained("TinyLlama/TinyLlama-1.1B-Chat-v1.0") input = torch.randint(0, 32, size=(1, 32)) with DisableKVCache(model): ... output = model(input)</p> </blockquote> </blockquote> </blockquote> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-976> 976</a></span>
<span class=normal><a href=#__codelineno-0-977> 977</a></span>
<span class=normal><a href=#__codelineno-0-978> 978</a></span>
<span class=normal><a href=#__codelineno-0-979> 979</a></span>
<span class=normal><a href=#__codelineno-0-980> 980</a></span>
<span class=normal><a href=#__codelineno-0-981> 981</a></span>
<span class=normal><a href=#__codelineno-0-982> 982</a></span>
<span class=normal><a href=#__codelineno-0-983> 983</a></span>
<span class=normal><a href=#__codelineno-0-984> 984</a></span>
<span class=normal><a href=#__codelineno-0-985> 985</a></span>
<span class=normal><a href=#__codelineno-0-986> 986</a></span>
<span class=normal><a href=#__codelineno-0-987> 987</a></span>
<span class=normal><a href=#__codelineno-0-988> 988</a></span>
<span class=normal><a href=#__codelineno-0-989> 989</a></span>
<span class=normal><a href=#__codelineno-0-990> 990</a></span>
<span class=normal><a href=#__codelineno-0-991> 991</a></span>
<span class=normal><a href=#__codelineno-0-992> 992</a></span>
<span class=normal><a href=#__codelineno-0-993> 993</a></span>
<span class=normal><a href=#__codelineno-0-994> 994</a></span>
<span class=normal><a href=#__codelineno-0-995> 995</a></span>
<span class=normal><a href=#__codelineno-0-996> 996</a></span>
<span class=normal><a href=#__codelineno-0-997> 997</a></span>
<span class=normal><a href=#__codelineno-0-998> 998</a></span>
<span class=normal><a href=#__codelineno-0-999> 999</a></span>
<span class=normal><a href=#__codelineno-0-1000>1000</a></span>
<span class=normal><a href=#__codelineno-0-1001>1001</a></span>
<span class=normal><a href=#__codelineno-0-1002>1002</a></span>
<span class=normal><a href=#__codelineno-0-1003>1003</a></span>
<span class=normal><a href=#__codelineno-0-1004>1004</a></span>
<span class=normal><a href=#__codelineno-0-1005>1005</a></span>
<span class=normal><a href=#__codelineno-0-1006>1006</a></span>
<span class=normal><a href=#__codelineno-0-1007>1007</a></span>
<span class=normal><a href=#__codelineno-0-1008>1008</a></span>
<span class=normal><a href=#__codelineno-0-1009>1009</a></span>
<span class=normal><a href=#__codelineno-0-1010>1010</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-976><a id=__codelineno-0-976 name=__codelineno-0-976></a><span class=k>class</span><span class=w> </span><span class=nc>DisableKVCache</span><span class=p>:</span>
</span><span id=__span-0-977><a id=__codelineno-0-977 name=__codelineno-0-977></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-978><a id=__codelineno-0-978 name=__codelineno-0-978></a><span class=sd>    Temporarily disable the key-value cache for transformer models. Used to prevent</span>
</span><span id=__span-0-979><a id=__codelineno-0-979 name=__codelineno-0-979></a><span class=sd>    excess memory use in one-shot cases where the model only performs the prefill</span>
</span><span id=__span-0-980><a id=__codelineno-0-980 name=__codelineno-0-980></a><span class=sd>    phase and not the generation phase.</span>
</span><span id=__span-0-981><a id=__codelineno-0-981 name=__codelineno-0-981></a>
</span><span id=__span-0-982><a id=__codelineno-0-982 name=__codelineno-0-982></a><span class=sd>    Example:</span>
</span><span id=__span-0-983><a id=__codelineno-0-983 name=__codelineno-0-983></a><span class=sd>    &gt;&gt;&gt; model = AutoModel.from_pretrained(&quot;TinyLlama/TinyLlama-1.1B-Chat-v1.0&quot;)</span>
</span><span id=__span-0-984><a id=__codelineno-0-984 name=__codelineno-0-984></a><span class=sd>    &gt;&gt;&gt; input = torch.randint(0, 32, size=(1, 32))</span>
</span><span id=__span-0-985><a id=__codelineno-0-985 name=__codelineno-0-985></a><span class=sd>    &gt;&gt;&gt; with DisableKVCache(model):</span>
</span><span id=__span-0-986><a id=__codelineno-0-986 name=__codelineno-0-986></a><span class=sd>    ...     output = model(input)</span>
</span><span id=__span-0-987><a id=__codelineno-0-987 name=__codelineno-0-987></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-988><a id=__codelineno-0-988 name=__codelineno-0-988></a>
</span><span id=__span-0-989><a id=__codelineno-0-989 name=__codelineno-0-989></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>model</span><span class=p>:</span> <span class=n>PreTrainedModel</span><span class=p>):</span>
</span><span id=__span-0-990><a id=__codelineno-0-990 name=__codelineno-0-990></a>        <span class=k>if</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>config</span><span class=p>,</span> <span class=s2>&quot;use_cache&quot;</span><span class=p>):</span>
</span><span id=__span-0-991><a id=__codelineno-0-991 name=__codelineno-0-991></a>            <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>config</span>
</span><span id=__span-0-992><a id=__codelineno-0-992 name=__codelineno-0-992></a>
</span><span id=__span-0-993><a id=__codelineno-0-993 name=__codelineno-0-993></a>        <span class=c1># MllamaConfig</span>
</span><span id=__span-0-994><a id=__codelineno-0-994 name=__codelineno-0-994></a>        <span class=k>elif</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>model</span><span class=o>.</span><span class=n>config</span><span class=p>,</span> <span class=s2>&quot;text_config&quot;</span><span class=p>)</span> <span class=ow>and</span> <span class=nb>hasattr</span><span class=p>(</span>
</span><span id=__span-0-995><a id=__codelineno-0-995 name=__codelineno-0-995></a>            <span class=n>model</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>text_config</span><span class=p>,</span> <span class=s2>&quot;use_cache&quot;</span>
</span><span id=__span-0-996><a id=__codelineno-0-996 name=__codelineno-0-996></a>        <span class=p>):</span>
</span><span id=__span-0-997><a id=__codelineno-0-997 name=__codelineno-0-997></a>            <span class=bp>self</span><span class=o>.</span><span class=n>config</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>text_config</span>
</span><span id=__span-0-998><a id=__codelineno-0-998 name=__codelineno-0-998></a>
</span><span id=__span-0-999><a id=__codelineno-0-999 name=__codelineno-0-999></a>        <span class=c1># unknown config structure</span>
</span><span id=__span-0-1000><a id=__codelineno-0-1000 name=__codelineno-0-1000></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-1001><a id=__codelineno-0-1001 name=__codelineno-0-1001></a>            <span class=k>raise</span> <span class=ne>NotImplementedError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Cannot find `use_cache` for </span><span class=si>{</span><span class=n>model</span><span class=o>.</span><span class=n>config</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-1002><a id=__codelineno-0-1002 name=__codelineno-0-1002></a>
</span><span id=__span-0-1003><a id=__codelineno-0-1003 name=__codelineno-0-1003></a>        <span class=bp>self</span><span class=o>.</span><span class=n>restore_value</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>use_cache</span>
</span><span id=__span-0-1004><a id=__codelineno-0-1004 name=__codelineno-0-1004></a>
</span><span id=__span-0-1005><a id=__codelineno-0-1005 name=__codelineno-0-1005></a>    <span class=k>def</span><span class=w> </span><span class=fm>__enter__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-1006><a id=__codelineno-0-1006 name=__codelineno-0-1006></a>        <span class=bp>self</span><span class=o>.</span><span class=n>restore_value</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>use_cache</span>
</span><span id=__span-0-1007><a id=__codelineno-0-1007 name=__codelineno-0-1007></a>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>use_cache</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-1008><a id=__codelineno-0-1008 name=__codelineno-0-1008></a>
</span><span id=__span-0-1009><a id=__codelineno-0-1009 name=__codelineno-0-1009></a>    <span class=k>def</span><span class=w> </span><span class=fm>__exit__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>_exc_type</span><span class=p>,</span> <span class=n>_exc_val</span><span class=p>,</span> <span class=n>_exc_tb</span><span class=p>):</span>
</span><span id=__span-0-1010><a id=__codelineno-0-1010 name=__codelineno-0-1010></a>        <span class=bp>self</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>use_cache</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>restore_value</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> </div> </div> </div> <div class="doc doc-object doc-class"> <h2 id=llmcompressor.utils.helpers.NumpyArrayBatcher class="doc doc-heading"> <code>NumpyArrayBatcher</code> </h2> <div class="doc doc-contents "> <p class="doc doc-class-bases"> Bases: <code><span title=object>object</span></code></p> <p>Batcher instance to handle taking in dictionaries of numpy arrays, appending multiple items to them to increase their batch size, and then stack them into a single batched numpy array for all keys in the dicts.</p> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-613>613</a></span>
<span class=normal><a href=#__codelineno-0-614>614</a></span>
<span class=normal><a href=#__codelineno-0-615>615</a></span>
<span class=normal><a href=#__codelineno-0-616>616</a></span>
<span class=normal><a href=#__codelineno-0-617>617</a></span>
<span class=normal><a href=#__codelineno-0-618>618</a></span>
<span class=normal><a href=#__codelineno-0-619>619</a></span>
<span class=normal><a href=#__codelineno-0-620>620</a></span>
<span class=normal><a href=#__codelineno-0-621>621</a></span>
<span class=normal><a href=#__codelineno-0-622>622</a></span>
<span class=normal><a href=#__codelineno-0-623>623</a></span>
<span class=normal><a href=#__codelineno-0-624>624</a></span>
<span class=normal><a href=#__codelineno-0-625>625</a></span>
<span class=normal><a href=#__codelineno-0-626>626</a></span>
<span class=normal><a href=#__codelineno-0-627>627</a></span>
<span class=normal><a href=#__codelineno-0-628>628</a></span>
<span class=normal><a href=#__codelineno-0-629>629</a></span>
<span class=normal><a href=#__codelineno-0-630>630</a></span>
<span class=normal><a href=#__codelineno-0-631>631</a></span>
<span class=normal><a href=#__codelineno-0-632>632</a></span>
<span class=normal><a href=#__codelineno-0-633>633</a></span>
<span class=normal><a href=#__codelineno-0-634>634</a></span>
<span class=normal><a href=#__codelineno-0-635>635</a></span>
<span class=normal><a href=#__codelineno-0-636>636</a></span>
<span class=normal><a href=#__codelineno-0-637>637</a></span>
<span class=normal><a href=#__codelineno-0-638>638</a></span>
<span class=normal><a href=#__codelineno-0-639>639</a></span>
<span class=normal><a href=#__codelineno-0-640>640</a></span>
<span class=normal><a href=#__codelineno-0-641>641</a></span>
<span class=normal><a href=#__codelineno-0-642>642</a></span>
<span class=normal><a href=#__codelineno-0-643>643</a></span>
<span class=normal><a href=#__codelineno-0-644>644</a></span>
<span class=normal><a href=#__codelineno-0-645>645</a></span>
<span class=normal><a href=#__codelineno-0-646>646</a></span>
<span class=normal><a href=#__codelineno-0-647>647</a></span>
<span class=normal><a href=#__codelineno-0-648>648</a></span>
<span class=normal><a href=#__codelineno-0-649>649</a></span>
<span class=normal><a href=#__codelineno-0-650>650</a></span>
<span class=normal><a href=#__codelineno-0-651>651</a></span>
<span class=normal><a href=#__codelineno-0-652>652</a></span>
<span class=normal><a href=#__codelineno-0-653>653</a></span>
<span class=normal><a href=#__codelineno-0-654>654</a></span>
<span class=normal><a href=#__codelineno-0-655>655</a></span>
<span class=normal><a href=#__codelineno-0-656>656</a></span>
<span class=normal><a href=#__codelineno-0-657>657</a></span>
<span class=normal><a href=#__codelineno-0-658>658</a></span>
<span class=normal><a href=#__codelineno-0-659>659</a></span>
<span class=normal><a href=#__codelineno-0-660>660</a></span>
<span class=normal><a href=#__codelineno-0-661>661</a></span>
<span class=normal><a href=#__codelineno-0-662>662</a></span>
<span class=normal><a href=#__codelineno-0-663>663</a></span>
<span class=normal><a href=#__codelineno-0-664>664</a></span>
<span class=normal><a href=#__codelineno-0-665>665</a></span>
<span class=normal><a href=#__codelineno-0-666>666</a></span>
<span class=normal><a href=#__codelineno-0-667>667</a></span>
<span class=normal><a href=#__codelineno-0-668>668</a></span>
<span class=normal><a href=#__codelineno-0-669>669</a></span>
<span class=normal><a href=#__codelineno-0-670>670</a></span>
<span class=normal><a href=#__codelineno-0-671>671</a></span>
<span class=normal><a href=#__codelineno-0-672>672</a></span>
<span class=normal><a href=#__codelineno-0-673>673</a></span>
<span class=normal><a href=#__codelineno-0-674>674</a></span>
<span class=normal><a href=#__codelineno-0-675>675</a></span>
<span class=normal><a href=#__codelineno-0-676>676</a></span>
<span class=normal><a href=#__codelineno-0-677>677</a></span>
<span class=normal><a href=#__codelineno-0-678>678</a></span>
<span class=normal><a href=#__codelineno-0-679>679</a></span>
<span class=normal><a href=#__codelineno-0-680>680</a></span>
<span class=normal><a href=#__codelineno-0-681>681</a></span>
<span class=normal><a href=#__codelineno-0-682>682</a></span>
<span class=normal><a href=#__codelineno-0-683>683</a></span>
<span class=normal><a href=#__codelineno-0-684>684</a></span>
<span class=normal><a href=#__codelineno-0-685>685</a></span>
<span class=normal><a href=#__codelineno-0-686>686</a></span>
<span class=normal><a href=#__codelineno-0-687>687</a></span>
<span class=normal><a href=#__codelineno-0-688>688</a></span>
<span class=normal><a href=#__codelineno-0-689>689</a></span>
<span class=normal><a href=#__codelineno-0-690>690</a></span>
<span class=normal><a href=#__codelineno-0-691>691</a></span>
<span class=normal><a href=#__codelineno-0-692>692</a></span>
<span class=normal><a href=#__codelineno-0-693>693</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-613><a id=__codelineno-0-613 name=__codelineno-0-613></a><span class=k>class</span><span class=w> </span><span class=nc>NumpyArrayBatcher</span><span class=p>(</span><span class=nb>object</span><span class=p>):</span>
</span><span id=__span-0-614><a id=__codelineno-0-614 name=__codelineno-0-614></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-615><a id=__codelineno-0-615 name=__codelineno-0-615></a><span class=sd>    Batcher instance to handle taking in dictionaries of numpy arrays,</span>
</span><span id=__span-0-616><a id=__codelineno-0-616 name=__codelineno-0-616></a><span class=sd>    appending multiple items to them to increase their batch size,</span>
</span><span id=__span-0-617><a id=__codelineno-0-617 name=__codelineno-0-617></a><span class=sd>    and then stack them into a single batched numpy array for all keys in the dicts.</span>
</span><span id=__span-0-618><a id=__codelineno-0-618 name=__codelineno-0-618></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-619><a id=__codelineno-0-619 name=__codelineno-0-619></a>
</span><span id=__span-0-620><a id=__codelineno-0-620 name=__codelineno-0-620></a>    <span class=k>def</span><span class=w> </span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-621><a id=__codelineno-0-621 name=__codelineno-0-621></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_items</span> <span class=o>=</span> <span class=n>OrderedDict</span><span class=p>()</span>  <span class=c1># type: Dict[str, List[numpy.ndarray]]</span>
</span><span id=__span-0-622><a id=__codelineno-0-622 name=__codelineno-0-622></a>
</span><span id=__span-0-623><a id=__codelineno-0-623 name=__codelineno-0-623></a>    <span class=k>def</span><span class=w> </span><span class=fm>__len__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span><span id=__span-0-624><a id=__codelineno-0-624 name=__codelineno-0-624></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-625><a id=__codelineno-0-625 name=__codelineno-0-625></a>            <span class=k>return</span> <span class=mi>0</span>
</span><span id=__span-0-626><a id=__codelineno-0-626 name=__codelineno-0-626></a>
</span><span id=__span-0-627><a id=__codelineno-0-627 name=__codelineno-0-627></a>        <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=nb>list</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=o>.</span><span class=n>keys</span><span class=p>())[</span><span class=mi>0</span><span class=p>]])</span>
</span><span id=__span-0-628><a id=__codelineno-0-628 name=__codelineno-0-628></a>
</span><span id=__span-0-629><a id=__codelineno-0-629 name=__codelineno-0-629></a>    <span class=k>def</span><span class=w> </span><span class=nf>append</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>item</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]]):</span>
</span><span id=__span-0-630><a id=__codelineno-0-630 name=__codelineno-0-630></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-631><a id=__codelineno-0-631 name=__codelineno-0-631></a><span class=sd>        Append a new item into the current batch.</span>
</span><span id=__span-0-632><a id=__codelineno-0-632 name=__codelineno-0-632></a><span class=sd>        All keys and shapes must match the current state.</span>
</span><span id=__span-0-633><a id=__codelineno-0-633 name=__codelineno-0-633></a>
</span><span id=__span-0-634><a id=__codelineno-0-634 name=__codelineno-0-634></a><span class=sd>        :param item: the item to add for batching</span>
</span><span id=__span-0-635><a id=__codelineno-0-635 name=__codelineno-0-635></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-636><a id=__codelineno-0-636 name=__codelineno-0-636></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>1</span> <span class=ow>and</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
</span><span id=__span-0-637><a id=__codelineno-0-637 name=__codelineno-0-637></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>NDARRAY_KEY</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>item</span><span class=p>]</span>
</span><span id=__span-0-638><a id=__codelineno-0-638 name=__codelineno-0-638></a>        <span class=k>elif</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-639><a id=__codelineno-0-639 name=__codelineno-0-639></a>            <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>item</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-640><a id=__codelineno-0-640 name=__codelineno-0-640></a>                <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>val</span><span class=p>]</span>
</span><span id=__span-0-641><a id=__codelineno-0-641 name=__codelineno-0-641></a>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
</span><span id=__span-0-642><a id=__codelineno-0-642 name=__codelineno-0-642></a>            <span class=k>if</span> <span class=n>NDARRAY_KEY</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>:</span>
</span><span id=__span-0-643><a id=__codelineno-0-643 name=__codelineno-0-643></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-644><a id=__codelineno-0-644 name=__codelineno-0-644></a>                    <span class=s2>&quot;numpy ndarray passed for item, but prev_batch does not contain one&quot;</span>
</span><span id=__span-0-645><a id=__codelineno-0-645 name=__codelineno-0-645></a>                <span class=p>)</span>
</span><span id=__span-0-646><a id=__codelineno-0-646 name=__codelineno-0-646></a>
</span><span id=__span-0-647><a id=__codelineno-0-647 name=__codelineno-0-647></a>            <span class=k>if</span> <span class=n>item</span><span class=o>.</span><span class=n>shape</span> <span class=o>!=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>NDARRAY_KEY</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span><span class=p>:</span>
</span><span id=__span-0-648><a id=__codelineno-0-648 name=__codelineno-0-648></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-649><a id=__codelineno-0-649 name=__codelineno-0-649></a>                    <span class=p>(</span>
</span><span id=__span-0-650><a id=__codelineno-0-650 name=__codelineno-0-650></a>                        <span class=s2>&quot;item of numpy ndarray of shape </span><span class=si>{}</span><span class=s2> does not &quot;</span>
</span><span id=__span-0-651><a id=__codelineno-0-651 name=__codelineno-0-651></a>                        <span class=s2>&quot;match the current batch shape of </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span><span id=__span-0-652><a id=__codelineno-0-652 name=__codelineno-0-652></a>                            <span class=n>item</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>NDARRAY_KEY</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-0-653><a id=__codelineno-0-653 name=__codelineno-0-653></a>                        <span class=p>)</span>
</span><span id=__span-0-654><a id=__codelineno-0-654 name=__codelineno-0-654></a>                    <span class=p>)</span>
</span><span id=__span-0-655><a id=__codelineno-0-655 name=__codelineno-0-655></a>                <span class=p>)</span>
</span><span id=__span-0-656><a id=__codelineno-0-656 name=__codelineno-0-656></a>
</span><span id=__span-0-657><a id=__codelineno-0-657 name=__codelineno-0-657></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>NDARRAY_KEY</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span><span id=__span-0-658><a id=__codelineno-0-658 name=__codelineno-0-658></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-659><a id=__codelineno-0-659 name=__codelineno-0-659></a>            <span class=n>diff_keys</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>item</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span> <span class=o>-</span> <span class=nb>set</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=o>.</span><span class=n>keys</span><span class=p>()))</span>
</span><span id=__span-0-660><a id=__codelineno-0-660 name=__codelineno-0-660></a>
</span><span id=__span-0-661><a id=__codelineno-0-661 name=__codelineno-0-661></a>            <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>diff_keys</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-662><a id=__codelineno-0-662 name=__codelineno-0-662></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-663><a id=__codelineno-0-663 name=__codelineno-0-663></a>                    <span class=p>(</span>
</span><span id=__span-0-664><a id=__codelineno-0-664 name=__codelineno-0-664></a>                        <span class=s2>&quot;numpy dict passed for item, not all keys match &quot;</span>
</span><span id=__span-0-665><a id=__codelineno-0-665 name=__codelineno-0-665></a>                        <span class=s2>&quot;with the prev_batch. difference: </span><span class=si>{}</span><span class=s2>&quot;</span>
</span><span id=__span-0-666><a id=__codelineno-0-666 name=__codelineno-0-666></a>                    <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>diff_keys</span><span class=p>)</span>
</span><span id=__span-0-667><a id=__codelineno-0-667 name=__codelineno-0-667></a>                <span class=p>)</span>
</span><span id=__span-0-668><a id=__codelineno-0-668 name=__codelineno-0-668></a>
</span><span id=__span-0-669><a id=__codelineno-0-669 name=__codelineno-0-669></a>            <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>item</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-670><a id=__codelineno-0-670 name=__codelineno-0-670></a>                <span class=k>if</span> <span class=n>val</span><span class=o>.</span><span class=n>shape</span> <span class=o>!=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>key</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span><span class=p>:</span>
</span><span id=__span-0-671><a id=__codelineno-0-671 name=__codelineno-0-671></a>                    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-672><a id=__codelineno-0-672 name=__codelineno-0-672></a>                        <span class=p>(</span>
</span><span id=__span-0-673><a id=__codelineno-0-673 name=__codelineno-0-673></a>                            <span class=s2>&quot;item with key </span><span class=si>{}</span><span class=s2> of shape </span><span class=si>{}</span><span class=s2> does not &quot;</span>
</span><span id=__span-0-674><a id=__codelineno-0-674 name=__codelineno-0-674></a>                            <span class=s2>&quot;match the current batch shape of </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span><span id=__span-0-675><a id=__codelineno-0-675 name=__codelineno-0-675></a>                                <span class=n>key</span><span class=p>,</span> <span class=n>val</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>key</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-0-676><a id=__codelineno-0-676 name=__codelineno-0-676></a>                            <span class=p>)</span>
</span><span id=__span-0-677><a id=__codelineno-0-677 name=__codelineno-0-677></a>                        <span class=p>)</span>
</span><span id=__span-0-678><a id=__codelineno-0-678 name=__codelineno-0-678></a>                    <span class=p>)</span>
</span><span id=__span-0-679><a id=__codelineno-0-679 name=__codelineno-0-679></a>
</span><span id=__span-0-680><a id=__codelineno-0-680 name=__codelineno-0-680></a>                <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
</span><span id=__span-0-681><a id=__codelineno-0-681 name=__codelineno-0-681></a>
</span><span id=__span-0-682><a id=__codelineno-0-682 name=__codelineno-0-682></a>    <span class=k>def</span><span class=w> </span><span class=nf>stack</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]:</span>
</span><span id=__span-0-683><a id=__codelineno-0-683 name=__codelineno-0-683></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-684><a id=__codelineno-0-684 name=__codelineno-0-684></a><span class=sd>        Stack the current items into a batch along a new, zeroed dimension</span>
</span><span id=__span-0-685><a id=__codelineno-0-685 name=__codelineno-0-685></a>
</span><span id=__span-0-686><a id=__codelineno-0-686 name=__codelineno-0-686></a><span class=sd>        :return: the stacked items</span>
</span><span id=__span-0-687><a id=__codelineno-0-687 name=__codelineno-0-687></a><span class=sd>        &quot;&quot;&quot;</span>
</span><span id=__span-0-688><a id=__codelineno-0-688 name=__codelineno-0-688></a>        <span class=n>batch_dict</span> <span class=o>=</span> <span class=n>OrderedDict</span><span class=p>()</span>
</span><span id=__span-0-689><a id=__codelineno-0-689 name=__codelineno-0-689></a>
</span><span id=__span-0-690><a id=__codelineno-0-690 name=__codelineno-0-690></a>        <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-691><a id=__codelineno-0-691 name=__codelineno-0-691></a>            <span class=n>batch_dict</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>stack</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>key</span><span class=p>])</span>
</span><span id=__span-0-692><a id=__codelineno-0-692 name=__codelineno-0-692></a>
</span><span id=__span-0-693><a id=__codelineno-0-693 name=__codelineno-0-693></a>        <span class=k>return</span> <span class=n>batch_dict</span>
</span></code></pre></div></td></tr></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-function"> <h3 id=llmcompressor.utils.helpers.NumpyArrayBatcher.append class="doc doc-heading"> <code class="highlight language-python"><span class=n>append</span><span class=p>(</span><span class=n>item</span><span class=p>)</span></code> </h3> <div class="doc doc-contents "> <p>Append a new item into the current batch. All keys and shapes must match the current state.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>item</code> </td> <td> <code><span title=typing.Union>Union</span>[<span title=numpy.ndarray>ndarray</span>, <span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>]]</code> </td> <td> <div class=doc-md-description> <p>the item to add for batching</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-629>629</a></span>
<span class=normal><a href=#__codelineno-0-630>630</a></span>
<span class=normal><a href=#__codelineno-0-631>631</a></span>
<span class=normal><a href=#__codelineno-0-632>632</a></span>
<span class=normal><a href=#__codelineno-0-633>633</a></span>
<span class=normal><a href=#__codelineno-0-634>634</a></span>
<span class=normal><a href=#__codelineno-0-635>635</a></span>
<span class=normal><a href=#__codelineno-0-636>636</a></span>
<span class=normal><a href=#__codelineno-0-637>637</a></span>
<span class=normal><a href=#__codelineno-0-638>638</a></span>
<span class=normal><a href=#__codelineno-0-639>639</a></span>
<span class=normal><a href=#__codelineno-0-640>640</a></span>
<span class=normal><a href=#__codelineno-0-641>641</a></span>
<span class=normal><a href=#__codelineno-0-642>642</a></span>
<span class=normal><a href=#__codelineno-0-643>643</a></span>
<span class=normal><a href=#__codelineno-0-644>644</a></span>
<span class=normal><a href=#__codelineno-0-645>645</a></span>
<span class=normal><a href=#__codelineno-0-646>646</a></span>
<span class=normal><a href=#__codelineno-0-647>647</a></span>
<span class=normal><a href=#__codelineno-0-648>648</a></span>
<span class=normal><a href=#__codelineno-0-649>649</a></span>
<span class=normal><a href=#__codelineno-0-650>650</a></span>
<span class=normal><a href=#__codelineno-0-651>651</a></span>
<span class=normal><a href=#__codelineno-0-652>652</a></span>
<span class=normal><a href=#__codelineno-0-653>653</a></span>
<span class=normal><a href=#__codelineno-0-654>654</a></span>
<span class=normal><a href=#__codelineno-0-655>655</a></span>
<span class=normal><a href=#__codelineno-0-656>656</a></span>
<span class=normal><a href=#__codelineno-0-657>657</a></span>
<span class=normal><a href=#__codelineno-0-658>658</a></span>
<span class=normal><a href=#__codelineno-0-659>659</a></span>
<span class=normal><a href=#__codelineno-0-660>660</a></span>
<span class=normal><a href=#__codelineno-0-661>661</a></span>
<span class=normal><a href=#__codelineno-0-662>662</a></span>
<span class=normal><a href=#__codelineno-0-663>663</a></span>
<span class=normal><a href=#__codelineno-0-664>664</a></span>
<span class=normal><a href=#__codelineno-0-665>665</a></span>
<span class=normal><a href=#__codelineno-0-666>666</a></span>
<span class=normal><a href=#__codelineno-0-667>667</a></span>
<span class=normal><a href=#__codelineno-0-668>668</a></span>
<span class=normal><a href=#__codelineno-0-669>669</a></span>
<span class=normal><a href=#__codelineno-0-670>670</a></span>
<span class=normal><a href=#__codelineno-0-671>671</a></span>
<span class=normal><a href=#__codelineno-0-672>672</a></span>
<span class=normal><a href=#__codelineno-0-673>673</a></span>
<span class=normal><a href=#__codelineno-0-674>674</a></span>
<span class=normal><a href=#__codelineno-0-675>675</a></span>
<span class=normal><a href=#__codelineno-0-676>676</a></span>
<span class=normal><a href=#__codelineno-0-677>677</a></span>
<span class=normal><a href=#__codelineno-0-678>678</a></span>
<span class=normal><a href=#__codelineno-0-679>679</a></span>
<span class=normal><a href=#__codelineno-0-680>680</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-629><a id=__codelineno-0-629 name=__codelineno-0-629></a><span class=k>def</span><span class=w> </span><span class=nf>append</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>item</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]]):</span>
</span><span id=__span-0-630><a id=__codelineno-0-630 name=__codelineno-0-630></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-631><a id=__codelineno-0-631 name=__codelineno-0-631></a><span class=sd>    Append a new item into the current batch.</span>
</span><span id=__span-0-632><a id=__codelineno-0-632 name=__codelineno-0-632></a><span class=sd>    All keys and shapes must match the current state.</span>
</span><span id=__span-0-633><a id=__codelineno-0-633 name=__codelineno-0-633></a>
</span><span id=__span-0-634><a id=__codelineno-0-634 name=__codelineno-0-634></a><span class=sd>    :param item: the item to add for batching</span>
</span><span id=__span-0-635><a id=__codelineno-0-635 name=__codelineno-0-635></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-636><a id=__codelineno-0-636 name=__codelineno-0-636></a>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>1</span> <span class=ow>and</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
</span><span id=__span-0-637><a id=__codelineno-0-637 name=__codelineno-0-637></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>NDARRAY_KEY</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>item</span><span class=p>]</span>
</span><span id=__span-0-638><a id=__codelineno-0-638 name=__codelineno-0-638></a>    <span class=k>elif</span> <span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-639><a id=__codelineno-0-639 name=__codelineno-0-639></a>        <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>item</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-640><a id=__codelineno-0-640 name=__codelineno-0-640></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=p>[</span><span class=n>val</span><span class=p>]</span>
</span><span id=__span-0-641><a id=__codelineno-0-641 name=__codelineno-0-641></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>item</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
</span><span id=__span-0-642><a id=__codelineno-0-642 name=__codelineno-0-642></a>        <span class=k>if</span> <span class=n>NDARRAY_KEY</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>:</span>
</span><span id=__span-0-643><a id=__codelineno-0-643 name=__codelineno-0-643></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-644><a id=__codelineno-0-644 name=__codelineno-0-644></a>                <span class=s2>&quot;numpy ndarray passed for item, but prev_batch does not contain one&quot;</span>
</span><span id=__span-0-645><a id=__codelineno-0-645 name=__codelineno-0-645></a>            <span class=p>)</span>
</span><span id=__span-0-646><a id=__codelineno-0-646 name=__codelineno-0-646></a>
</span><span id=__span-0-647><a id=__codelineno-0-647 name=__codelineno-0-647></a>        <span class=k>if</span> <span class=n>item</span><span class=o>.</span><span class=n>shape</span> <span class=o>!=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>NDARRAY_KEY</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span><span class=p>:</span>
</span><span id=__span-0-648><a id=__codelineno-0-648 name=__codelineno-0-648></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-649><a id=__codelineno-0-649 name=__codelineno-0-649></a>                <span class=p>(</span>
</span><span id=__span-0-650><a id=__codelineno-0-650 name=__codelineno-0-650></a>                    <span class=s2>&quot;item of numpy ndarray of shape </span><span class=si>{}</span><span class=s2> does not &quot;</span>
</span><span id=__span-0-651><a id=__codelineno-0-651 name=__codelineno-0-651></a>                    <span class=s2>&quot;match the current batch shape of </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span><span id=__span-0-652><a id=__codelineno-0-652 name=__codelineno-0-652></a>                        <span class=n>item</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>NDARRAY_KEY</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-0-653><a id=__codelineno-0-653 name=__codelineno-0-653></a>                    <span class=p>)</span>
</span><span id=__span-0-654><a id=__codelineno-0-654 name=__codelineno-0-654></a>                <span class=p>)</span>
</span><span id=__span-0-655><a id=__codelineno-0-655 name=__codelineno-0-655></a>            <span class=p>)</span>
</span><span id=__span-0-656><a id=__codelineno-0-656 name=__codelineno-0-656></a>
</span><span id=__span-0-657><a id=__codelineno-0-657 name=__codelineno-0-657></a>        <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>NDARRAY_KEY</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>item</span><span class=p>)</span>
</span><span id=__span-0-658><a id=__codelineno-0-658 name=__codelineno-0-658></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-659><a id=__codelineno-0-659 name=__codelineno-0-659></a>        <span class=n>diff_keys</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=nb>set</span><span class=p>(</span><span class=n>item</span><span class=o>.</span><span class=n>keys</span><span class=p>())</span> <span class=o>-</span> <span class=nb>set</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=o>.</span><span class=n>keys</span><span class=p>()))</span>
</span><span id=__span-0-660><a id=__codelineno-0-660 name=__codelineno-0-660></a>
</span><span id=__span-0-661><a id=__codelineno-0-661 name=__codelineno-0-661></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>diff_keys</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-662><a id=__codelineno-0-662 name=__codelineno-0-662></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-663><a id=__codelineno-0-663 name=__codelineno-0-663></a>                <span class=p>(</span>
</span><span id=__span-0-664><a id=__codelineno-0-664 name=__codelineno-0-664></a>                    <span class=s2>&quot;numpy dict passed for item, not all keys match &quot;</span>
</span><span id=__span-0-665><a id=__codelineno-0-665 name=__codelineno-0-665></a>                    <span class=s2>&quot;with the prev_batch. difference: </span><span class=si>{}</span><span class=s2>&quot;</span>
</span><span id=__span-0-666><a id=__codelineno-0-666 name=__codelineno-0-666></a>                <span class=p>)</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>diff_keys</span><span class=p>)</span>
</span><span id=__span-0-667><a id=__codelineno-0-667 name=__codelineno-0-667></a>            <span class=p>)</span>
</span><span id=__span-0-668><a id=__codelineno-0-668 name=__codelineno-0-668></a>
</span><span id=__span-0-669><a id=__codelineno-0-669 name=__codelineno-0-669></a>        <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>item</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-670><a id=__codelineno-0-670 name=__codelineno-0-670></a>            <span class=k>if</span> <span class=n>val</span><span class=o>.</span><span class=n>shape</span> <span class=o>!=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>key</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span><span class=p>:</span>
</span><span id=__span-0-671><a id=__codelineno-0-671 name=__codelineno-0-671></a>                <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-672><a id=__codelineno-0-672 name=__codelineno-0-672></a>                    <span class=p>(</span>
</span><span id=__span-0-673><a id=__codelineno-0-673 name=__codelineno-0-673></a>                        <span class=s2>&quot;item with key </span><span class=si>{}</span><span class=s2> of shape </span><span class=si>{}</span><span class=s2> does not &quot;</span>
</span><span id=__span-0-674><a id=__codelineno-0-674 name=__codelineno-0-674></a>                        <span class=s2>&quot;match the current batch shape of </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span><span id=__span-0-675><a id=__codelineno-0-675 name=__codelineno-0-675></a>                            <span class=n>key</span><span class=p>,</span> <span class=n>val</span><span class=o>.</span><span class=n>shape</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>key</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>shape</span>
</span><span id=__span-0-676><a id=__codelineno-0-676 name=__codelineno-0-676></a>                        <span class=p>)</span>
</span><span id=__span-0-677><a id=__codelineno-0-677 name=__codelineno-0-677></a>                    <span class=p>)</span>
</span><span id=__span-0-678><a id=__codelineno-0-678 name=__codelineno-0-678></a>                <span class=p>)</span>
</span><span id=__span-0-679><a id=__codelineno-0-679 name=__codelineno-0-679></a>
</span><span id=__span-0-680><a id=__codelineno-0-680 name=__codelineno-0-680></a>            <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>key</span><span class=p>]</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id=llmcompressor.utils.helpers.NumpyArrayBatcher.stack class="doc doc-heading"> <code class="highlight language-python"><span class=n>stack</span><span class=p>()</span></code> </h3> <div class="doc doc-contents "> <p>Stack the current items into a batch along a new, zeroed dimension</p> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>]</code> </td> <td> <div class=doc-md-description> <p>the stacked items</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-682>682</a></span>
<span class=normal><a href=#__codelineno-0-683>683</a></span>
<span class=normal><a href=#__codelineno-0-684>684</a></span>
<span class=normal><a href=#__codelineno-0-685>685</a></span>
<span class=normal><a href=#__codelineno-0-686>686</a></span>
<span class=normal><a href=#__codelineno-0-687>687</a></span>
<span class=normal><a href=#__codelineno-0-688>688</a></span>
<span class=normal><a href=#__codelineno-0-689>689</a></span>
<span class=normal><a href=#__codelineno-0-690>690</a></span>
<span class=normal><a href=#__codelineno-0-691>691</a></span>
<span class=normal><a href=#__codelineno-0-692>692</a></span>
<span class=normal><a href=#__codelineno-0-693>693</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-682><a id=__codelineno-0-682 name=__codelineno-0-682></a><span class=k>def</span><span class=w> </span><span class=nf>stack</span><span class=p>(</span><span class=bp>self</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]:</span>
</span><span id=__span-0-683><a id=__codelineno-0-683 name=__codelineno-0-683></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-684><a id=__codelineno-0-684 name=__codelineno-0-684></a><span class=sd>    Stack the current items into a batch along a new, zeroed dimension</span>
</span><span id=__span-0-685><a id=__codelineno-0-685 name=__codelineno-0-685></a>
</span><span id=__span-0-686><a id=__codelineno-0-686 name=__codelineno-0-686></a><span class=sd>    :return: the stacked items</span>
</span><span id=__span-0-687><a id=__codelineno-0-687 name=__codelineno-0-687></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-688><a id=__codelineno-0-688 name=__codelineno-0-688></a>    <span class=n>batch_dict</span> <span class=o>=</span> <span class=n>OrderedDict</span><span class=p>()</span>
</span><span id=__span-0-689><a id=__codelineno-0-689 name=__codelineno-0-689></a>
</span><span id=__span-0-690><a id=__codelineno-0-690 name=__codelineno-0-690></a>    <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-691><a id=__codelineno-0-691 name=__codelineno-0-691></a>        <span class=n>batch_dict</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>stack</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_items</span><span class=p>[</span><span class=n>key</span><span class=p>])</span>
</span><span id=__span-0-692><a id=__codelineno-0-692 name=__codelineno-0-692></a>
</span><span id=__span-0-693><a id=__codelineno-0-693 name=__codelineno-0-693></a>    <span class=k>return</span> <span class=n>batch_dict</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.DisableQuantization class="doc doc-heading"> <code class="highlight language-python"><span class=n>DisableQuantization</span><span class=p>(</span><span class=n>module</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Disable quantization during forward passes after applying a quantization config</p> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1013>1013</a></span>
<span class=normal><a href=#__codelineno-0-1014>1014</a></span>
<span class=normal><a href=#__codelineno-0-1015>1015</a></span>
<span class=normal><a href=#__codelineno-0-1016>1016</a></span>
<span class=normal><a href=#__codelineno-0-1017>1017</a></span>
<span class=normal><a href=#__codelineno-0-1018>1018</a></span>
<span class=normal><a href=#__codelineno-0-1019>1019</a></span>
<span class=normal><a href=#__codelineno-0-1020>1020</a></span>
<span class=normal><a href=#__codelineno-0-1021>1021</a></span>
<span class=normal><a href=#__codelineno-0-1022>1022</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1013><a id=__codelineno-0-1013 name=__codelineno-0-1013></a><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
</span><span id=__span-0-1014><a id=__codelineno-0-1014 name=__codelineno-0-1014></a><span class=k>def</span><span class=w> </span><span class=nf>DisableQuantization</span><span class=p>(</span><span class=n>module</span><span class=p>:</span> <span class=n>torch</span><span class=o>.</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>):</span>
</span><span id=__span-0-1015><a id=__codelineno-0-1015 name=__codelineno-0-1015></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-1016><a id=__codelineno-0-1016 name=__codelineno-0-1016></a><span class=sd>    Disable quantization during forward passes after applying a quantization config</span>
</span><span id=__span-0-1017><a id=__codelineno-0-1017 name=__codelineno-0-1017></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-1018><a id=__codelineno-0-1018 name=__codelineno-0-1018></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-1019><a id=__codelineno-0-1019 name=__codelineno-0-1019></a>        <span class=n>module</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>disable_quantization</span><span class=p>)</span>
</span><span id=__span-0-1020><a id=__codelineno-0-1020 name=__codelineno-0-1020></a>        <span class=k>yield</span>
</span><span id=__span-0-1021><a id=__codelineno-0-1021 name=__codelineno-0-1021></a>    <span class=k>finally</span><span class=p>:</span>
</span><span id=__span-0-1022><a id=__codelineno-0-1022 name=__codelineno-0-1022></a>        <span class=n>module</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=n>enable_quantization</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.bucket_iterable class="doc doc-heading"> <code class="highlight language-python"><span class=n>bucket_iterable</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=n>num_buckets</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>edge_percent</span><span class=o>=</span><span class=mf>0.05</span><span class=p>,</span> <span class=n>sort_highest</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>sort_key</span><span class=o>=</span><span class=kc>None</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Bucket iterable into subarray consisting of the first top percentage followed by the rest of the iterable sliced into equal sliced groups.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>val</code> </td> <td> <code><span title=typing.Iterable>Iterable</span>[<span title=typing.Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>The iterable to bucket</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>num_buckets</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>The number of buckets to group the iterable into, does not include the top bucket</p> </div> </td> <td> <code>3</code> </td> </tr> <tr class=doc-section-item> <td> <code>edge_percent</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>Group the first percent into its own bucket. If sort_highest, then this is the top percent, else bottom percent. If &lt;= 0, then will not create an edge bucket</p> </div> </td> <td> <code>0.05</code> </td> </tr> <tr class=doc-section-item> <td> <code>sort_highest</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>True to sort such that the highest percent is first and will create buckets in descending order. False to sort so lowest is first and create buckets in ascending order.</p> </div> </td> <td> <code>True</code> </td> </tr> <tr class=doc-section-item> <td> <code>sort_key</code> </td> <td> <code><span title=typing.Callable>Callable</span>[[<span title=typing.Any>Any</span>], <span title=typing.Any>Any</span>]</code> </td> <td> <div class=doc-md-description> <p>The sort_key, if any, to use for sorting the iterable after converting it to a list</p> </div> </td> <td> <code>None</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.List>List</span>[<span title=typing.Tuple>Tuple</span>[<span title=int>int</span>, <span title=typing.Any>Any</span>]]</code> </td> <td> <div class=doc-md-description> <p>a list of each value mapped to the bucket it was sorted into</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-142>142</a></span>
<span class=normal><a href=#__codelineno-0-143>143</a></span>
<span class=normal><a href=#__codelineno-0-144>144</a></span>
<span class=normal><a href=#__codelineno-0-145>145</a></span>
<span class=normal><a href=#__codelineno-0-146>146</a></span>
<span class=normal><a href=#__codelineno-0-147>147</a></span>
<span class=normal><a href=#__codelineno-0-148>148</a></span>
<span class=normal><a href=#__codelineno-0-149>149</a></span>
<span class=normal><a href=#__codelineno-0-150>150</a></span>
<span class=normal><a href=#__codelineno-0-151>151</a></span>
<span class=normal><a href=#__codelineno-0-152>152</a></span>
<span class=normal><a href=#__codelineno-0-153>153</a></span>
<span class=normal><a href=#__codelineno-0-154>154</a></span>
<span class=normal><a href=#__codelineno-0-155>155</a></span>
<span class=normal><a href=#__codelineno-0-156>156</a></span>
<span class=normal><a href=#__codelineno-0-157>157</a></span>
<span class=normal><a href=#__codelineno-0-158>158</a></span>
<span class=normal><a href=#__codelineno-0-159>159</a></span>
<span class=normal><a href=#__codelineno-0-160>160</a></span>
<span class=normal><a href=#__codelineno-0-161>161</a></span>
<span class=normal><a href=#__codelineno-0-162>162</a></span>
<span class=normal><a href=#__codelineno-0-163>163</a></span>
<span class=normal><a href=#__codelineno-0-164>164</a></span>
<span class=normal><a href=#__codelineno-0-165>165</a></span>
<span class=normal><a href=#__codelineno-0-166>166</a></span>
<span class=normal><a href=#__codelineno-0-167>167</a></span>
<span class=normal><a href=#__codelineno-0-168>168</a></span>
<span class=normal><a href=#__codelineno-0-169>169</a></span>
<span class=normal><a href=#__codelineno-0-170>170</a></span>
<span class=normal><a href=#__codelineno-0-171>171</a></span>
<span class=normal><a href=#__codelineno-0-172>172</a></span>
<span class=normal><a href=#__codelineno-0-173>173</a></span>
<span class=normal><a href=#__codelineno-0-174>174</a></span>
<span class=normal><a href=#__codelineno-0-175>175</a></span>
<span class=normal><a href=#__codelineno-0-176>176</a></span>
<span class=normal><a href=#__codelineno-0-177>177</a></span>
<span class=normal><a href=#__codelineno-0-178>178</a></span>
<span class=normal><a href=#__codelineno-0-179>179</a></span>
<span class=normal><a href=#__codelineno-0-180>180</a></span>
<span class=normal><a href=#__codelineno-0-181>181</a></span>
<span class=normal><a href=#__codelineno-0-182>182</a></span>
<span class=normal><a href=#__codelineno-0-183>183</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-142><a id=__codelineno-0-142 name=__codelineno-0-142></a><span class=k>def</span><span class=w> </span><span class=nf>bucket_iterable</span><span class=p>(</span>
</span><span id=__span-0-143><a id=__codelineno-0-143 name=__codelineno-0-143></a>    <span class=n>val</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Any</span><span class=p>],</span>
</span><span id=__span-0-144><a id=__codelineno-0-144 name=__codelineno-0-144></a>    <span class=n>num_buckets</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>3</span><span class=p>,</span>
</span><span id=__span-0-145><a id=__codelineno-0-145 name=__codelineno-0-145></a>    <span class=n>edge_percent</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.05</span><span class=p>,</span>
</span><span id=__span-0-146><a id=__codelineno-0-146 name=__codelineno-0-146></a>    <span class=n>sort_highest</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-147><a id=__codelineno-0-147 name=__codelineno-0-147></a>    <span class=n>sort_key</span><span class=p>:</span> <span class=n>Callable</span><span class=p>[[</span><span class=n>Any</span><span class=p>],</span> <span class=n>Any</span><span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
</span><span id=__span-0-148><a id=__codelineno-0-148 name=__codelineno-0-148></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=n>Any</span><span class=p>]]:</span>
</span><span id=__span-0-149><a id=__codelineno-0-149 name=__codelineno-0-149></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-150><a id=__codelineno-0-150 name=__codelineno-0-150></a><span class=sd>    Bucket iterable into subarray consisting of the first top percentage</span>
</span><span id=__span-0-151><a id=__codelineno-0-151 name=__codelineno-0-151></a><span class=sd>    followed by the rest of the iterable sliced into equal sliced groups.</span>
</span><span id=__span-0-152><a id=__codelineno-0-152 name=__codelineno-0-152></a>
</span><span id=__span-0-153><a id=__codelineno-0-153 name=__codelineno-0-153></a><span class=sd>    :param val: The iterable to bucket</span>
</span><span id=__span-0-154><a id=__codelineno-0-154 name=__codelineno-0-154></a><span class=sd>    :param num_buckets: The number of buckets to group the iterable into,</span>
</span><span id=__span-0-155><a id=__codelineno-0-155 name=__codelineno-0-155></a><span class=sd>        does not include the top bucket</span>
</span><span id=__span-0-156><a id=__codelineno-0-156 name=__codelineno-0-156></a><span class=sd>    :param edge_percent: Group the first percent into its own bucket.</span>
</span><span id=__span-0-157><a id=__codelineno-0-157 name=__codelineno-0-157></a><span class=sd>        If sort_highest, then this is the top percent, else bottom percent.</span>
</span><span id=__span-0-158><a id=__codelineno-0-158 name=__codelineno-0-158></a><span class=sd>        If &lt;= 0, then will not create an edge bucket</span>
</span><span id=__span-0-159><a id=__codelineno-0-159 name=__codelineno-0-159></a><span class=sd>    :param sort_highest: True to sort such that the highest percent is first</span>
</span><span id=__span-0-160><a id=__codelineno-0-160 name=__codelineno-0-160></a><span class=sd>        and will create buckets in descending order.</span>
</span><span id=__span-0-161><a id=__codelineno-0-161 name=__codelineno-0-161></a><span class=sd>        False to sort so lowest is first and create buckets in ascending order.</span>
</span><span id=__span-0-162><a id=__codelineno-0-162 name=__codelineno-0-162></a><span class=sd>    :param sort_key: The sort_key, if any, to use for sorting the iterable</span>
</span><span id=__span-0-163><a id=__codelineno-0-163 name=__codelineno-0-163></a><span class=sd>        after converting it to a list</span>
</span><span id=__span-0-164><a id=__codelineno-0-164 name=__codelineno-0-164></a><span class=sd>    :return: a list of each value mapped to the bucket it was sorted into</span>
</span><span id=__span-0-165><a id=__codelineno-0-165 name=__codelineno-0-165></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-166><a id=__codelineno-0-166 name=__codelineno-0-166></a>
</span><span id=__span-0-167><a id=__codelineno-0-167 name=__codelineno-0-167></a>    <span class=n>val_list</span> <span class=o>=</span> <span class=p>[</span><span class=n>v</span> <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>val</span><span class=p>]</span>
</span><span id=__span-0-168><a id=__codelineno-0-168 name=__codelineno-0-168></a>    <span class=n>val_list</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=n>sort_key</span><span class=p>,</span> <span class=n>reverse</span><span class=o>=</span><span class=n>sort_highest</span><span class=p>)</span>
</span><span id=__span-0-169><a id=__codelineno-0-169 name=__codelineno-0-169></a>    <span class=n>bucketed_values</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-170><a id=__codelineno-0-170 name=__codelineno-0-170></a>    <span class=n>edge_count</span> <span class=o>=</span> <span class=nb>round</span><span class=p>(</span><span class=n>edge_percent</span> <span class=o>*</span> <span class=nb>len</span><span class=p>(</span><span class=n>val_list</span><span class=p>))</span>
</span><span id=__span-0-171><a id=__codelineno-0-171 name=__codelineno-0-171></a>
</span><span id=__span-0-172><a id=__codelineno-0-172 name=__codelineno-0-172></a>    <span class=k>if</span> <span class=n>edge_count</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span><span id=__span-0-173><a id=__codelineno-0-173 name=__codelineno-0-173></a>        <span class=n>bucketed_values</span><span class=o>.</span><span class=n>extend</span><span class=p>([(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>val</span><span class=p>)</span> <span class=k>for</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>val_list</span><span class=p>[:</span><span class=n>edge_count</span><span class=p>]])</span>
</span><span id=__span-0-174><a id=__codelineno-0-174 name=__codelineno-0-174></a>        <span class=n>val_list</span> <span class=o>=</span> <span class=n>val_list</span><span class=p>[</span><span class=n>edge_count</span><span class=p>:]</span>
</span><span id=__span-0-175><a id=__codelineno-0-175 name=__codelineno-0-175></a>
</span><span id=__span-0-176><a id=__codelineno-0-176 name=__codelineno-0-176></a>    <span class=n>buckets_count</span> <span class=o>=</span> <span class=nb>round</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>val_list</span><span class=p>)</span> <span class=o>/</span> <span class=nb>float</span><span class=p>(</span><span class=n>num_buckets</span><span class=p>))</span>
</span><span id=__span-0-177><a id=__codelineno-0-177 name=__codelineno-0-177></a>
</span><span id=__span-0-178><a id=__codelineno-0-178 name=__codelineno-0-178></a>    <span class=k>for</span> <span class=n>bucket</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>num_buckets</span><span class=p>):</span>
</span><span id=__span-0-179><a id=__codelineno-0-179 name=__codelineno-0-179></a>        <span class=n>add_vals</span> <span class=o>=</span> <span class=n>val_list</span><span class=p>[:</span><span class=n>buckets_count</span><span class=p>]</span> <span class=k>if</span> <span class=n>bucket</span> <span class=o>&lt;</span> <span class=n>num_buckets</span> <span class=o>-</span> <span class=mi>1</span> <span class=k>else</span> <span class=n>val_list</span>
</span><span id=__span-0-180><a id=__codelineno-0-180 name=__codelineno-0-180></a>        <span class=n>val_list</span> <span class=o>=</span> <span class=n>val_list</span><span class=p>[</span><span class=n>buckets_count</span><span class=p>:]</span> <span class=k>if</span> <span class=n>bucket</span> <span class=o>&lt;</span> <span class=n>num_buckets</span> <span class=o>-</span> <span class=mi>1</span> <span class=k>else</span> <span class=p>[]</span>
</span><span id=__span-0-181><a id=__codelineno-0-181 name=__codelineno-0-181></a>        <span class=n>bucketed_values</span><span class=o>.</span><span class=n>extend</span><span class=p>([(</span><span class=n>bucket</span><span class=p>,</span> <span class=n>val</span><span class=p>)</span> <span class=k>for</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>add_vals</span><span class=p>])</span>
</span><span id=__span-0-182><a id=__codelineno-0-182 name=__codelineno-0-182></a>
</span><span id=__span-0-183><a id=__codelineno-0-183 name=__codelineno-0-183></a>    <span class=k>return</span> <span class=n>bucketed_values</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.calibration_forward_context class="doc doc-heading"> <code class="highlight language-python"><span class=n>calibration_forward_context</span><span class=p>(</span><span class=n>model</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Context in which all calibration forward passes should occur.</p> <ul> <li>Remove gradient calculations</li> <li>Disable the KV cache</li> <li>Disable train mode and enable eval mode</li> </ul> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1036>1036</a></span>
<span class=normal><a href=#__codelineno-0-1037>1037</a></span>
<span class=normal><a href=#__codelineno-0-1038>1038</a></span>
<span class=normal><a href=#__codelineno-0-1039>1039</a></span>
<span class=normal><a href=#__codelineno-0-1040>1040</a></span>
<span class=normal><a href=#__codelineno-0-1041>1041</a></span>
<span class=normal><a href=#__codelineno-0-1042>1042</a></span>
<span class=normal><a href=#__codelineno-0-1043>1043</a></span>
<span class=normal><a href=#__codelineno-0-1044>1044</a></span>
<span class=normal><a href=#__codelineno-0-1045>1045</a></span>
<span class=normal><a href=#__codelineno-0-1046>1046</a></span>
<span class=normal><a href=#__codelineno-0-1047>1047</a></span>
<span class=normal><a href=#__codelineno-0-1048>1048</a></span>
<span class=normal><a href=#__codelineno-0-1049>1049</a></span>
<span class=normal><a href=#__codelineno-0-1050>1050</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1036><a id=__codelineno-0-1036 name=__codelineno-0-1036></a><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
</span><span id=__span-0-1037><a id=__codelineno-0-1037 name=__codelineno-0-1037></a><span class=k>def</span><span class=w> </span><span class=nf>calibration_forward_context</span><span class=p>(</span><span class=n>model</span><span class=p>:</span> <span class=n>PreTrainedModel</span><span class=p>):</span>
</span><span id=__span-0-1038><a id=__codelineno-0-1038 name=__codelineno-0-1038></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-1039><a id=__codelineno-0-1039 name=__codelineno-0-1039></a><span class=sd>    Context in which all calibration forward passes should occur.</span>
</span><span id=__span-0-1040><a id=__codelineno-0-1040 name=__codelineno-0-1040></a>
</span><span id=__span-0-1041><a id=__codelineno-0-1041 name=__codelineno-0-1041></a><span class=sd>    - Remove gradient calculations</span>
</span><span id=__span-0-1042><a id=__codelineno-0-1042 name=__codelineno-0-1042></a><span class=sd>    - Disable the KV cache</span>
</span><span id=__span-0-1043><a id=__codelineno-0-1043 name=__codelineno-0-1043></a><span class=sd>    - Disable train mode and enable eval mode</span>
</span><span id=__span-0-1044><a id=__codelineno-0-1044 name=__codelineno-0-1044></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-1045><a id=__codelineno-0-1045 name=__codelineno-0-1045></a>    <span class=k>with</span> <span class=p>(</span>
</span><span id=__span-0-1046><a id=__codelineno-0-1046 name=__codelineno-0-1046></a>        <span class=n>torch</span><span class=o>.</span><span class=n>no_grad</span><span class=p>(),</span>
</span><span id=__span-0-1047><a id=__codelineno-0-1047 name=__codelineno-0-1047></a>        <span class=n>DisableKVCache</span><span class=p>(</span><span class=n>model</span><span class=p>),</span>
</span><span id=__span-0-1048><a id=__codelineno-0-1048 name=__codelineno-0-1048></a>        <span class=n>eval_context</span><span class=p>(</span><span class=n>model</span><span class=p>),</span>
</span><span id=__span-0-1049><a id=__codelineno-0-1049 name=__codelineno-0-1049></a>    <span class=p>):</span>
</span><span id=__span-0-1050><a id=__codelineno-0-1050 name=__codelineno-0-1050></a>        <span class=k>yield</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.clean_path class="doc doc-heading"> <code class="highlight language-python"><span class=n>clean_path</span><span class=p>(</span><span class=n>path</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the directory or file path to clean</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>a cleaned version that expands the user path and creates an absolute path</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-306>306</a></span>
<span class=normal><a href=#__codelineno-0-307>307</a></span>
<span class=normal><a href=#__codelineno-0-308>308</a></span>
<span class=normal><a href=#__codelineno-0-309>309</a></span>
<span class=normal><a href=#__codelineno-0-310>310</a></span>
<span class=normal><a href=#__codelineno-0-311>311</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-306><a id=__codelineno-0-306 name=__codelineno-0-306></a><span class=k>def</span><span class=w> </span><span class=nf>clean_path</span><span class=p>(</span><span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-307><a id=__codelineno-0-307 name=__codelineno-0-307></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-308><a id=__codelineno-0-308 name=__codelineno-0-308></a><span class=sd>    :param path: the directory or file path to clean</span>
</span><span id=__span-0-309><a id=__codelineno-0-309 name=__codelineno-0-309></a><span class=sd>    :return: a cleaned version that expands the user path and creates an absolute path</span>
</span><span id=__span-0-310><a id=__codelineno-0-310 name=__codelineno-0-310></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-311><a id=__codelineno-0-311 name=__codelineno-0-311></a>    <span class=k>return</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>expanduser</span><span class=p>(</span><span class=n>path</span><span class=p>))</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.convert_to_bool class="doc doc-heading"> <code class="highlight language-python"><span class=n>convert_to_bool</span><span class=p>(</span><span class=n>val</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>val</code> </td> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>the value to be converted to a bool, supports logical values as strings ie True, t, false, 0</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>the boolean representation of the value, if it can't be determined, falls back on returning True</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-103>103</a></span>
<span class=normal><a href=#__codelineno-0-104>104</a></span>
<span class=normal><a href=#__codelineno-0-105>105</a></span>
<span class=normal><a href=#__codelineno-0-106>106</a></span>
<span class=normal><a href=#__codelineno-0-107>107</a></span>
<span class=normal><a href=#__codelineno-0-108>108</a></span>
<span class=normal><a href=#__codelineno-0-109>109</a></span>
<span class=normal><a href=#__codelineno-0-110>110</a></span>
<span class=normal><a href=#__codelineno-0-111>111</a></span>
<span class=normal><a href=#__codelineno-0-112>112</a></span>
<span class=normal><a href=#__codelineno-0-113>113</a></span>
<span class=normal><a href=#__codelineno-0-114>114</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-103><a id=__codelineno-0-103 name=__codelineno-0-103></a><span class=k>def</span><span class=w> </span><span class=nf>convert_to_bool</span><span class=p>(</span><span class=n>val</span><span class=p>:</span> <span class=n>Any</span><span class=p>):</span>
</span><span id=__span-0-104><a id=__codelineno-0-104 name=__codelineno-0-104></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-105><a id=__codelineno-0-105 name=__codelineno-0-105></a><span class=sd>    :param val: the value to be converted to a bool,</span>
</span><span id=__span-0-106><a id=__codelineno-0-106 name=__codelineno-0-106></a><span class=sd>        supports logical values as strings ie True, t, false, 0</span>
</span><span id=__span-0-107><a id=__codelineno-0-107 name=__codelineno-0-107></a><span class=sd>    :return: the boolean representation of the value, if it can&#39;t be determined,</span>
</span><span id=__span-0-108><a id=__codelineno-0-108 name=__codelineno-0-108></a><span class=sd>        falls back on returning True</span>
</span><span id=__span-0-109><a id=__codelineno-0-109 name=__codelineno-0-109></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-110><a id=__codelineno-0-110 name=__codelineno-0-110></a>    <span class=k>return</span> <span class=p>(</span>
</span><span id=__span-0-111><a id=__codelineno-0-111 name=__codelineno-0-111></a>        <span class=nb>bool</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
</span><span id=__span-0-112><a id=__codelineno-0-112 name=__codelineno-0-112></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=nb>str</span><span class=p>)</span>
</span><span id=__span-0-113><a id=__codelineno-0-113 name=__codelineno-0-113></a>        <span class=k>else</span> <span class=nb>bool</span><span class=p>(</span><span class=n>val</span><span class=p>)</span> <span class=ow>and</span> <span class=s2>&quot;f&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>val</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>and</span> <span class=s2>&quot;0&quot;</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>val</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span><span id=__span-0-114><a id=__codelineno-0-114 name=__codelineno-0-114></a>    <span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.create_dirs class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_dirs</span><span class=p>(</span><span class=n>path</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the directory path to try and create</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-314>314</a></span>
<span class=normal><a href=#__codelineno-0-315>315</a></span>
<span class=normal><a href=#__codelineno-0-316>316</a></span>
<span class=normal><a href=#__codelineno-0-317>317</a></span>
<span class=normal><a href=#__codelineno-0-318>318</a></span>
<span class=normal><a href=#__codelineno-0-319>319</a></span>
<span class=normal><a href=#__codelineno-0-320>320</a></span>
<span class=normal><a href=#__codelineno-0-321>321</a></span>
<span class=normal><a href=#__codelineno-0-322>322</a></span>
<span class=normal><a href=#__codelineno-0-323>323</a></span>
<span class=normal><a href=#__codelineno-0-324>324</a></span>
<span class=normal><a href=#__codelineno-0-325>325</a></span>
<span class=normal><a href=#__codelineno-0-326>326</a></span>
<span class=normal><a href=#__codelineno-0-327>327</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-314><a id=__codelineno-0-314 name=__codelineno-0-314></a><span class=k>def</span><span class=w> </span><span class=nf>create_dirs</span><span class=p>(</span><span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-315><a id=__codelineno-0-315 name=__codelineno-0-315></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-316><a id=__codelineno-0-316 name=__codelineno-0-316></a><span class=sd>    :param path: the directory path to try and create</span>
</span><span id=__span-0-317><a id=__codelineno-0-317 name=__codelineno-0-317></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-318><a id=__codelineno-0-318 name=__codelineno-0-318></a>    <span class=n>path</span> <span class=o>=</span> <span class=n>clean_path</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span><span id=__span-0-319><a id=__codelineno-0-319 name=__codelineno-0-319></a>
</span><span id=__span-0-320><a id=__codelineno-0-320 name=__codelineno-0-320></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-321><a id=__codelineno-0-321 name=__codelineno-0-321></a>        <span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span><span id=__span-0-322><a id=__codelineno-0-322 name=__codelineno-0-322></a>    <span class=k>except</span> <span class=ne>OSError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span><span id=__span-0-323><a id=__codelineno-0-323 name=__codelineno-0-323></a>        <span class=k>if</span> <span class=n>e</span><span class=o>.</span><span class=n>errno</span> <span class=o>==</span> <span class=n>errno</span><span class=o>.</span><span class=n>EEXIST</span><span class=p>:</span>
</span><span id=__span-0-324><a id=__codelineno-0-324 name=__codelineno-0-324></a>            <span class=k>pass</span>
</span><span id=__span-0-325><a id=__codelineno-0-325 name=__codelineno-0-325></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-326><a id=__codelineno-0-326 name=__codelineno-0-326></a>            <span class=c1># Unexpected OSError, re-raise.</span>
</span><span id=__span-0-327><a id=__codelineno-0-327 name=__codelineno-0-327></a>            <span class=k>raise</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.create_parent_dirs class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_parent_dirs</span><span class=p>(</span><span class=n>path</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the file path to try to create the parent directories for</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-330>330</a></span>
<span class=normal><a href=#__codelineno-0-331>331</a></span>
<span class=normal><a href=#__codelineno-0-332>332</a></span>
<span class=normal><a href=#__codelineno-0-333>333</a></span>
<span class=normal><a href=#__codelineno-0-334>334</a></span>
<span class=normal><a href=#__codelineno-0-335>335</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-330><a id=__codelineno-0-330 name=__codelineno-0-330></a><span class=k>def</span><span class=w> </span><span class=nf>create_parent_dirs</span><span class=p>(</span><span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-331><a id=__codelineno-0-331 name=__codelineno-0-331></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-332><a id=__codelineno-0-332 name=__codelineno-0-332></a><span class=sd>    :param path: the file path to try to create the parent directories for</span>
</span><span id=__span-0-333><a id=__codelineno-0-333 name=__codelineno-0-333></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-334><a id=__codelineno-0-334 name=__codelineno-0-334></a>    <span class=n>parent</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span><span id=__span-0-335><a id=__codelineno-0-335 name=__codelineno-0-335></a>    <span class=n>create_dirs</span><span class=p>(</span><span class=n>parent</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.create_unique_dir class="doc doc-heading"> <code class="highlight language-python"><span class=n>create_unique_dir</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>check_number</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the file path to create a unique version of (append numbers until one doesn't exist)</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>check_number</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>the number to begin checking for unique versions at</p> </div> </td> <td> <code>0</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the unique directory path</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-338>338</a></span>
<span class=normal><a href=#__codelineno-0-339>339</a></span>
<span class=normal><a href=#__codelineno-0-340>340</a></span>
<span class=normal><a href=#__codelineno-0-341>341</a></span>
<span class=normal><a href=#__codelineno-0-342>342</a></span>
<span class=normal><a href=#__codelineno-0-343>343</a></span>
<span class=normal><a href=#__codelineno-0-344>344</a></span>
<span class=normal><a href=#__codelineno-0-345>345</a></span>
<span class=normal><a href=#__codelineno-0-346>346</a></span>
<span class=normal><a href=#__codelineno-0-347>347</a></span>
<span class=normal><a href=#__codelineno-0-348>348</a></span>
<span class=normal><a href=#__codelineno-0-349>349</a></span>
<span class=normal><a href=#__codelineno-0-350>350</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-338><a id=__codelineno-0-338 name=__codelineno-0-338></a><span class=k>def</span><span class=w> </span><span class=nf>create_unique_dir</span><span class=p>(</span><span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>check_number</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-339><a id=__codelineno-0-339 name=__codelineno-0-339></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-340><a id=__codelineno-0-340 name=__codelineno-0-340></a><span class=sd>    :param path: the file path to create a unique version of</span>
</span><span id=__span-0-341><a id=__codelineno-0-341 name=__codelineno-0-341></a><span class=sd>        (append numbers until one doesn&#39;t exist)</span>
</span><span id=__span-0-342><a id=__codelineno-0-342 name=__codelineno-0-342></a><span class=sd>    :param check_number: the number to begin checking for unique versions at</span>
</span><span id=__span-0-343><a id=__codelineno-0-343 name=__codelineno-0-343></a><span class=sd>    :return: the unique directory path</span>
</span><span id=__span-0-344><a id=__codelineno-0-344 name=__codelineno-0-344></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-345><a id=__codelineno-0-345 name=__codelineno-0-345></a>    <span class=n>check_path</span> <span class=o>=</span> <span class=n>clean_path</span><span class=p>(</span><span class=s2>&quot;</span><span class=si>{}</span><span class=s2>-</span><span class=si>{:04d}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>check_number</span><span class=p>))</span>
</span><span id=__span-0-346><a id=__codelineno-0-346 name=__codelineno-0-346></a>
</span><span id=__span-0-347><a id=__codelineno-0-347 name=__codelineno-0-347></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>check_path</span><span class=p>):</span>
</span><span id=__span-0-348><a id=__codelineno-0-348 name=__codelineno-0-348></a>        <span class=k>return</span> <span class=n>check_path</span>
</span><span id=__span-0-349><a id=__codelineno-0-349 name=__codelineno-0-349></a>
</span><span id=__span-0-350><a id=__codelineno-0-350 name=__codelineno-0-350></a>    <span class=k>return</span> <span class=n>create_unique_dir</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>check_number</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.flatten_iterable class="doc doc-heading"> <code class="highlight language-python"><span class=n>flatten_iterable</span><span class=p>(</span><span class=n>li</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>li</code> </td> <td> <code><span title=typing.Iterable>Iterable</span></code> </td> <td> <div class=doc-md-description> <p>a possibly nested iterable of items to be flattened</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>a flattened version of the list where all elements are in a single list flattened in a depth first pattern</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-86> 86</a></span>
<span class=normal><a href=#__codelineno-0-87> 87</a></span>
<span class=normal><a href=#__codelineno-0-88> 88</a></span>
<span class=normal><a href=#__codelineno-0-89> 89</a></span>
<span class=normal><a href=#__codelineno-0-90> 90</a></span>
<span class=normal><a href=#__codelineno-0-91> 91</a></span>
<span class=normal><a href=#__codelineno-0-92> 92</a></span>
<span class=normal><a href=#__codelineno-0-93> 93</a></span>
<span class=normal><a href=#__codelineno-0-94> 94</a></span>
<span class=normal><a href=#__codelineno-0-95> 95</a></span>
<span class=normal><a href=#__codelineno-0-96> 96</a></span>
<span class=normal><a href=#__codelineno-0-97> 97</a></span>
<span class=normal><a href=#__codelineno-0-98> 98</a></span>
<span class=normal><a href=#__codelineno-0-99> 99</a></span>
<span class=normal><a href=#__codelineno-0-100>100</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-86><a id=__codelineno-0-86 name=__codelineno-0-86></a><span class=k>def</span><span class=w> </span><span class=nf>flatten_iterable</span><span class=p>(</span><span class=n>li</span><span class=p>:</span> <span class=n>Iterable</span><span class=p>):</span>
</span><span id=__span-0-87><a id=__codelineno-0-87 name=__codelineno-0-87></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-88><a id=__codelineno-0-88 name=__codelineno-0-88></a><span class=sd>    :param li: a possibly nested iterable of items to be flattened</span>
</span><span id=__span-0-89><a id=__codelineno-0-89 name=__codelineno-0-89></a><span class=sd>    :return: a flattened version of the list where all elements are in a single list</span>
</span><span id=__span-0-90><a id=__codelineno-0-90 name=__codelineno-0-90></a><span class=sd>             flattened in a depth first pattern</span>
</span><span id=__span-0-91><a id=__codelineno-0-91 name=__codelineno-0-91></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-92><a id=__codelineno-0-92 name=__codelineno-0-92></a>
</span><span id=__span-0-93><a id=__codelineno-0-93 name=__codelineno-0-93></a>    <span class=k>def</span><span class=w> </span><span class=nf>_flatten_gen</span><span class=p>(</span><span class=n>_li</span><span class=p>):</span>
</span><span id=__span-0-94><a id=__codelineno-0-94 name=__codelineno-0-94></a>        <span class=k>for</span> <span class=n>el</span> <span class=ow>in</span> <span class=n>_li</span><span class=p>:</span>
</span><span id=__span-0-95><a id=__codelineno-0-95 name=__codelineno-0-95></a>            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>el</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>)</span> <span class=ow>and</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>el</span><span class=p>,</span> <span class=p>(</span><span class=nb>str</span><span class=p>,</span> <span class=nb>bytes</span><span class=p>)):</span>
</span><span id=__span-0-96><a id=__codelineno-0-96 name=__codelineno-0-96></a>                <span class=k>yield from</span> <span class=n>_flatten_gen</span><span class=p>(</span><span class=n>el</span><span class=p>)</span>
</span><span id=__span-0-97><a id=__codelineno-0-97 name=__codelineno-0-97></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-98><a id=__codelineno-0-98 name=__codelineno-0-98></a>                <span class=k>yield</span> <span class=n>el</span>
</span><span id=__span-0-99><a id=__codelineno-0-99 name=__codelineno-0-99></a>
</span><span id=__span-0-100><a id=__codelineno-0-100 name=__codelineno-0-100></a>    <span class=k>return</span> <span class=nb>list</span><span class=p>(</span><span class=n>_flatten_gen</span><span class=p>(</span><span class=n>li</span><span class=p>))</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.getattr_chain class="doc doc-heading"> <code class="highlight language-python"><span class=n>getattr_chain</span><span class=p>(</span><span class=n>obj</span><span class=p>,</span> <span class=n>chain_str</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Chain multiple getattr calls, separated by <code>.</code></p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>obj</code> </td> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>base object whose attributes are being retrieved</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>chain_str</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>attribute names separated by <code>.</code></p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>default</code> </td> <td> </td> <td> <div class=doc-md-description> <p>default value, throw error otherwise</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-944>944</a></span>
<span class=normal><a href=#__codelineno-0-945>945</a></span>
<span class=normal><a href=#__codelineno-0-946>946</a></span>
<span class=normal><a href=#__codelineno-0-947>947</a></span>
<span class=normal><a href=#__codelineno-0-948>948</a></span>
<span class=normal><a href=#__codelineno-0-949>949</a></span>
<span class=normal><a href=#__codelineno-0-950>950</a></span>
<span class=normal><a href=#__codelineno-0-951>951</a></span>
<span class=normal><a href=#__codelineno-0-952>952</a></span>
<span class=normal><a href=#__codelineno-0-953>953</a></span>
<span class=normal><a href=#__codelineno-0-954>954</a></span>
<span class=normal><a href=#__codelineno-0-955>955</a></span>
<span class=normal><a href=#__codelineno-0-956>956</a></span>
<span class=normal><a href=#__codelineno-0-957>957</a></span>
<span class=normal><a href=#__codelineno-0-958>958</a></span>
<span class=normal><a href=#__codelineno-0-959>959</a></span>
<span class=normal><a href=#__codelineno-0-960>960</a></span>
<span class=normal><a href=#__codelineno-0-961>961</a></span>
<span class=normal><a href=#__codelineno-0-962>962</a></span>
<span class=normal><a href=#__codelineno-0-963>963</a></span>
<span class=normal><a href=#__codelineno-0-964>964</a></span>
<span class=normal><a href=#__codelineno-0-965>965</a></span>
<span class=normal><a href=#__codelineno-0-966>966</a></span>
<span class=normal><a href=#__codelineno-0-967>967</a></span>
<span class=normal><a href=#__codelineno-0-968>968</a></span>
<span class=normal><a href=#__codelineno-0-969>969</a></span>
<span class=normal><a href=#__codelineno-0-970>970</a></span>
<span class=normal><a href=#__codelineno-0-971>971</a></span>
<span class=normal><a href=#__codelineno-0-972>972</a></span>
<span class=normal><a href=#__codelineno-0-973>973</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-944><a id=__codelineno-0-944 name=__codelineno-0-944></a><span class=k>def</span><span class=w> </span><span class=nf>getattr_chain</span><span class=p>(</span><span class=n>obj</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span> <span class=n>chain_str</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-945><a id=__codelineno-0-945 name=__codelineno-0-945></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-946><a id=__codelineno-0-946 name=__codelineno-0-946></a><span class=sd>    Chain multiple getattr calls, separated by `.`</span>
</span><span id=__span-0-947><a id=__codelineno-0-947 name=__codelineno-0-947></a>
</span><span id=__span-0-948><a id=__codelineno-0-948 name=__codelineno-0-948></a><span class=sd>    :param obj: base object whose attributes are being retrieved</span>
</span><span id=__span-0-949><a id=__codelineno-0-949 name=__codelineno-0-949></a><span class=sd>    :param chain_str: attribute names separated by `.`</span>
</span><span id=__span-0-950><a id=__codelineno-0-950 name=__codelineno-0-950></a><span class=sd>    :param default: default value, throw error otherwise</span>
</span><span id=__span-0-951><a id=__codelineno-0-951 name=__codelineno-0-951></a>
</span><span id=__span-0-952><a id=__codelineno-0-952 name=__codelineno-0-952></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-953><a id=__codelineno-0-953 name=__codelineno-0-953></a>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>args</span><span class=p>)</span> <span class=o>&gt;=</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-954><a id=__codelineno-0-954 name=__codelineno-0-954></a>        <span class=n>has_default</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-955><a id=__codelineno-0-955 name=__codelineno-0-955></a>        <span class=n>default</span> <span class=o>=</span> <span class=n>args</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-956><a id=__codelineno-0-956 name=__codelineno-0-956></a>    <span class=k>elif</span> <span class=s2>&quot;default&quot;</span> <span class=ow>in</span> <span class=n>kwargs</span><span class=p>:</span>
</span><span id=__span-0-957><a id=__codelineno-0-957 name=__codelineno-0-957></a>        <span class=n>has_default</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-958><a id=__codelineno-0-958 name=__codelineno-0-958></a>        <span class=n>default</span> <span class=o>=</span> <span class=n>kwargs</span><span class=p>[</span><span class=s2>&quot;default&quot;</span><span class=p>]</span>
</span><span id=__span-0-959><a id=__codelineno-0-959 name=__codelineno-0-959></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-960><a id=__codelineno-0-960 name=__codelineno-0-960></a>        <span class=n>has_default</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-961><a id=__codelineno-0-961 name=__codelineno-0-961></a>
</span><span id=__span-0-962><a id=__codelineno-0-962 name=__codelineno-0-962></a>    <span class=n>attr_names</span> <span class=o>=</span> <span class=n>chain_str</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;.&quot;</span><span class=p>)</span>
</span><span id=__span-0-963><a id=__codelineno-0-963 name=__codelineno-0-963></a>
</span><span id=__span-0-964><a id=__codelineno-0-964 name=__codelineno-0-964></a>    <span class=n>res</span> <span class=o>=</span> <span class=n>obj</span>
</span><span id=__span-0-965><a id=__codelineno-0-965 name=__codelineno-0-965></a>    <span class=k>for</span> <span class=n>attr_name</span> <span class=ow>in</span> <span class=n>attr_names</span><span class=p>:</span>
</span><span id=__span-0-966><a id=__codelineno-0-966 name=__codelineno-0-966></a>        <span class=k>if</span> <span class=ow>not</span> <span class=nb>hasattr</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>attr_name</span><span class=p>):</span>
</span><span id=__span-0-967><a id=__codelineno-0-967 name=__codelineno-0-967></a>            <span class=k>if</span> <span class=n>has_default</span><span class=p>:</span>
</span><span id=__span-0-968><a id=__codelineno-0-968 name=__codelineno-0-968></a>                <span class=k>return</span> <span class=n>default</span>
</span><span id=__span-0-969><a id=__codelineno-0-969 name=__codelineno-0-969></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-970><a id=__codelineno-0-970 name=__codelineno-0-970></a>                <span class=k>raise</span> <span class=ne>AttributeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>res</span><span class=si>}</span><span class=s2> object has no attribute </span><span class=si>{</span><span class=n>attr_name</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-971><a id=__codelineno-0-971 name=__codelineno-0-971></a>        <span class=n>res</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>res</span><span class=p>,</span> <span class=n>attr_name</span><span class=p>)</span>
</span><span id=__span-0-972><a id=__codelineno-0-972 name=__codelineno-0-972></a>
</span><span id=__span-0-973><a id=__codelineno-0-973 name=__codelineno-0-973></a>    <span class=k>return</span> <span class=n>res</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.import_from_path class="doc doc-heading"> <code class="highlight language-python"><span class=n>import_from_path</span><span class=p>(</span><span class=n>path</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Import the module and the name of the function/class separated by : Examples: path = "/path/to/file.py:func_or_class_name" path = "/path/to/file:focn" path = "path.to.file:focn"</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>path including the file path and object name</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-918>918</a></span>
<span class=normal><a href=#__codelineno-0-919>919</a></span>
<span class=normal><a href=#__codelineno-0-920>920</a></span>
<span class=normal><a href=#__codelineno-0-921>921</a></span>
<span class=normal><a href=#__codelineno-0-922>922</a></span>
<span class=normal><a href=#__codelineno-0-923>923</a></span>
<span class=normal><a href=#__codelineno-0-924>924</a></span>
<span class=normal><a href=#__codelineno-0-925>925</a></span>
<span class=normal><a href=#__codelineno-0-926>926</a></span>
<span class=normal><a href=#__codelineno-0-927>927</a></span>
<span class=normal><a href=#__codelineno-0-928>928</a></span>
<span class=normal><a href=#__codelineno-0-929>929</a></span>
<span class=normal><a href=#__codelineno-0-930>930</a></span>
<span class=normal><a href=#__codelineno-0-931>931</a></span>
<span class=normal><a href=#__codelineno-0-932>932</a></span>
<span class=normal><a href=#__codelineno-0-933>933</a></span>
<span class=normal><a href=#__codelineno-0-934>934</a></span>
<span class=normal><a href=#__codelineno-0-935>935</a></span>
<span class=normal><a href=#__codelineno-0-936>936</a></span>
<span class=normal><a href=#__codelineno-0-937>937</a></span>
<span class=normal><a href=#__codelineno-0-938>938</a></span>
<span class=normal><a href=#__codelineno-0-939>939</a></span>
<span class=normal><a href=#__codelineno-0-940>940</a></span>
<span class=normal><a href=#__codelineno-0-941>941</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-918><a id=__codelineno-0-918 name=__codelineno-0-918></a><span class=k>def</span><span class=w> </span><span class=nf>import_from_path</span><span class=p>(</span><span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-919><a id=__codelineno-0-919 name=__codelineno-0-919></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-920><a id=__codelineno-0-920 name=__codelineno-0-920></a><span class=sd>    Import the module and the name of the function/class separated by :</span>
</span><span id=__span-0-921><a id=__codelineno-0-921 name=__codelineno-0-921></a><span class=sd>    Examples:</span>
</span><span id=__span-0-922><a id=__codelineno-0-922 name=__codelineno-0-922></a><span class=sd>      path = &quot;/path/to/file.py:func_or_class_name&quot;</span>
</span><span id=__span-0-923><a id=__codelineno-0-923 name=__codelineno-0-923></a><span class=sd>      path = &quot;/path/to/file:focn&quot;</span>
</span><span id=__span-0-924><a id=__codelineno-0-924 name=__codelineno-0-924></a><span class=sd>      path = &quot;path.to.file:focn&quot;</span>
</span><span id=__span-0-925><a id=__codelineno-0-925 name=__codelineno-0-925></a><span class=sd>    :param path: path including the file path and object name</span>
</span><span id=__span-0-926><a id=__codelineno-0-926 name=__codelineno-0-926></a><span class=sd>    :return Function or class object</span>
</span><span id=__span-0-927><a id=__codelineno-0-927 name=__codelineno-0-927></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-928><a id=__codelineno-0-928 name=__codelineno-0-928></a>    <span class=n>original_path</span><span class=p>,</span> <span class=n>class_name</span> <span class=o>=</span> <span class=n>path</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;:&quot;</span><span class=p>)</span>
</span><span id=__span-0-929><a id=__codelineno-0-929 name=__codelineno-0-929></a>    <span class=n>_path</span> <span class=o>=</span> <span class=n>original_path</span>
</span><span id=__span-0-930><a id=__codelineno-0-930 name=__codelineno-0-930></a>
</span><span id=__span-0-931><a id=__codelineno-0-931 name=__codelineno-0-931></a>    <span class=n>path</span> <span class=o>=</span> <span class=n>original_path</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s2>&quot;.py&quot;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-932><a id=__codelineno-0-932 name=__codelineno-0-932></a>    <span class=n>path</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=sa>r</span><span class=s2>&quot;/+&quot;</span><span class=p>,</span> <span class=s2>&quot;.&quot;</span><span class=p>,</span> <span class=n>path</span><span class=p>)</span>
</span><span id=__span-0-933><a id=__codelineno-0-933 name=__codelineno-0-933></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-934><a id=__codelineno-0-934 name=__codelineno-0-934></a>        <span class=n>module</span> <span class=o>=</span> <span class=n>importlib</span><span class=o>.</span><span class=n>import_module</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span><span id=__span-0-935><a id=__codelineno-0-935 name=__codelineno-0-935></a>    <span class=k>except</span> <span class=ne>ImportError</span><span class=p>:</span>
</span><span id=__span-0-936><a id=__codelineno-0-936 name=__codelineno-0-936></a>        <span class=k>raise</span> <span class=ne>ImportError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Cannot find module with path </span><span class=si>{</span><span class=n>_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-937><a id=__codelineno-0-937 name=__codelineno-0-937></a>
</span><span id=__span-0-938><a id=__codelineno-0-938 name=__codelineno-0-938></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-939><a id=__codelineno-0-939 name=__codelineno-0-939></a>        <span class=k>return</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>module</span><span class=p>,</span> <span class=n>class_name</span><span class=p>)</span>
</span><span id=__span-0-940><a id=__codelineno-0-940 name=__codelineno-0-940></a>    <span class=k>except</span> <span class=ne>AttributeError</span><span class=p>:</span>
</span><span id=__span-0-941><a id=__codelineno-0-941 name=__codelineno-0-941></a>        <span class=k>raise</span> <span class=ne>AttributeError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Cannot find </span><span class=si>{</span><span class=n>class_name</span><span class=si>}</span><span class=s2> in </span><span class=si>{</span><span class=n>_path</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.interpolate class="doc doc-heading"> <code class="highlight language-python"><span class=n>interpolate</span><span class=p>(</span><span class=n>x_cur</span><span class=p>,</span> <span class=n>x0</span><span class=p>,</span> <span class=n>x1</span><span class=p>,</span> <span class=n>y0</span><span class=p>,</span> <span class=n>y1</span><span class=p>,</span> <span class=n>inter_func</span><span class=o>=</span><span class=s1>&#39;linear&#39;</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>note, caps values at their min of x0 and max x1, designed to not work outside of that range for implementation reasons</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>x_cur</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>the current value for x, should be between x0 and x1</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>x0</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>the minimum for x to interpolate between</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>x1</code> </td> <td> <code><span title=float>float</span></code> </td> <td> <div class=doc-md-description> <p>the maximum for x to interpolate between</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>y0</code> </td> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>the minimum for y to interpolate between</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>y1</code> </td> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>the maximum for y to interpolate between</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>inter_func</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the type of function to interpolate with: linear, cubic, inverse_cubic</p> </div> </td> <td> <code>&#39;linear&#39;</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>the interpolated value projecting x into y for the given interpolation function</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-189>189</a></span>
<span class=normal><a href=#__codelineno-0-190>190</a></span>
<span class=normal><a href=#__codelineno-0-191>191</a></span>
<span class=normal><a href=#__codelineno-0-192>192</a></span>
<span class=normal><a href=#__codelineno-0-193>193</a></span>
<span class=normal><a href=#__codelineno-0-194>194</a></span>
<span class=normal><a href=#__codelineno-0-195>195</a></span>
<span class=normal><a href=#__codelineno-0-196>196</a></span>
<span class=normal><a href=#__codelineno-0-197>197</a></span>
<span class=normal><a href=#__codelineno-0-198>198</a></span>
<span class=normal><a href=#__codelineno-0-199>199</a></span>
<span class=normal><a href=#__codelineno-0-200>200</a></span>
<span class=normal><a href=#__codelineno-0-201>201</a></span>
<span class=normal><a href=#__codelineno-0-202>202</a></span>
<span class=normal><a href=#__codelineno-0-203>203</a></span>
<span class=normal><a href=#__codelineno-0-204>204</a></span>
<span class=normal><a href=#__codelineno-0-205>205</a></span>
<span class=normal><a href=#__codelineno-0-206>206</a></span>
<span class=normal><a href=#__codelineno-0-207>207</a></span>
<span class=normal><a href=#__codelineno-0-208>208</a></span>
<span class=normal><a href=#__codelineno-0-209>209</a></span>
<span class=normal><a href=#__codelineno-0-210>210</a></span>
<span class=normal><a href=#__codelineno-0-211>211</a></span>
<span class=normal><a href=#__codelineno-0-212>212</a></span>
<span class=normal><a href=#__codelineno-0-213>213</a></span>
<span class=normal><a href=#__codelineno-0-214>214</a></span>
<span class=normal><a href=#__codelineno-0-215>215</a></span>
<span class=normal><a href=#__codelineno-0-216>216</a></span>
<span class=normal><a href=#__codelineno-0-217>217</a></span>
<span class=normal><a href=#__codelineno-0-218>218</a></span>
<span class=normal><a href=#__codelineno-0-219>219</a></span>
<span class=normal><a href=#__codelineno-0-220>220</a></span>
<span class=normal><a href=#__codelineno-0-221>221</a></span>
<span class=normal><a href=#__codelineno-0-222>222</a></span>
<span class=normal><a href=#__codelineno-0-223>223</a></span>
<span class=normal><a href=#__codelineno-0-224>224</a></span>
<span class=normal><a href=#__codelineno-0-225>225</a></span>
<span class=normal><a href=#__codelineno-0-226>226</a></span>
<span class=normal><a href=#__codelineno-0-227>227</a></span>
<span class=normal><a href=#__codelineno-0-228>228</a></span>
<span class=normal><a href=#__codelineno-0-229>229</a></span>
<span class=normal><a href=#__codelineno-0-230>230</a></span>
<span class=normal><a href=#__codelineno-0-231>231</a></span>
<span class=normal><a href=#__codelineno-0-232>232</a></span>
<span class=normal><a href=#__codelineno-0-233>233</a></span>
<span class=normal><a href=#__codelineno-0-234>234</a></span>
<span class=normal><a href=#__codelineno-0-235>235</a></span>
<span class=normal><a href=#__codelineno-0-236>236</a></span>
<span class=normal><a href=#__codelineno-0-237>237</a></span>
<span class=normal><a href=#__codelineno-0-238>238</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-189><a id=__codelineno-0-189 name=__codelineno-0-189></a><span class=k>def</span><span class=w> </span><span class=nf>interpolate</span><span class=p>(</span>
</span><span id=__span-0-190><a id=__codelineno-0-190 name=__codelineno-0-190></a>    <span class=n>x_cur</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>x0</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>x1</span><span class=p>:</span> <span class=nb>float</span><span class=p>,</span> <span class=n>y0</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span> <span class=n>y1</span><span class=p>:</span> <span class=n>Any</span><span class=p>,</span> <span class=n>inter_func</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;linear&quot;</span>
</span><span id=__span-0-191><a id=__codelineno-0-191 name=__codelineno-0-191></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Any</span><span class=p>:</span>
</span><span id=__span-0-192><a id=__codelineno-0-192 name=__codelineno-0-192></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-193><a id=__codelineno-0-193 name=__codelineno-0-193></a><span class=sd>    note, caps values at their min of x0 and max x1,</span>
</span><span id=__span-0-194><a id=__codelineno-0-194 name=__codelineno-0-194></a><span class=sd>    designed to not work outside of that range for implementation reasons</span>
</span><span id=__span-0-195><a id=__codelineno-0-195 name=__codelineno-0-195></a>
</span><span id=__span-0-196><a id=__codelineno-0-196 name=__codelineno-0-196></a><span class=sd>    :param x_cur: the current value for x, should be between x0 and x1</span>
</span><span id=__span-0-197><a id=__codelineno-0-197 name=__codelineno-0-197></a><span class=sd>    :param x0: the minimum for x to interpolate between</span>
</span><span id=__span-0-198><a id=__codelineno-0-198 name=__codelineno-0-198></a><span class=sd>    :param x1: the maximum for x to interpolate between</span>
</span><span id=__span-0-199><a id=__codelineno-0-199 name=__codelineno-0-199></a><span class=sd>    :param y0: the minimum for y to interpolate between</span>
</span><span id=__span-0-200><a id=__codelineno-0-200 name=__codelineno-0-200></a><span class=sd>    :param y1: the maximum for y to interpolate between</span>
</span><span id=__span-0-201><a id=__codelineno-0-201 name=__codelineno-0-201></a><span class=sd>    :param inter_func: the type of function to interpolate with:</span>
</span><span id=__span-0-202><a id=__codelineno-0-202 name=__codelineno-0-202></a><span class=sd>        linear, cubic, inverse_cubic</span>
</span><span id=__span-0-203><a id=__codelineno-0-203 name=__codelineno-0-203></a><span class=sd>    :return: the interpolated value projecting x into y for the given</span>
</span><span id=__span-0-204><a id=__codelineno-0-204 name=__codelineno-0-204></a><span class=sd>        interpolation function</span>
</span><span id=__span-0-205><a id=__codelineno-0-205 name=__codelineno-0-205></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-206><a id=__codelineno-0-206 name=__codelineno-0-206></a>    <span class=k>if</span> <span class=n>inter_func</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>INTERPOLATION_FUNCS</span><span class=p>:</span>
</span><span id=__span-0-207><a id=__codelineno-0-207 name=__codelineno-0-207></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-208><a id=__codelineno-0-208 name=__codelineno-0-208></a>            <span class=s2>&quot;unsupported inter_func given of </span><span class=si>{}</span><span class=s2> must be one of </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span><span id=__span-0-209><a id=__codelineno-0-209 name=__codelineno-0-209></a>                <span class=n>inter_func</span><span class=p>,</span> <span class=n>INTERPOLATION_FUNCS</span>
</span><span id=__span-0-210><a id=__codelineno-0-210 name=__codelineno-0-210></a>            <span class=p>)</span>
</span><span id=__span-0-211><a id=__codelineno-0-211 name=__codelineno-0-211></a>        <span class=p>)</span>
</span><span id=__span-0-212><a id=__codelineno-0-212 name=__codelineno-0-212></a>
</span><span id=__span-0-213><a id=__codelineno-0-213 name=__codelineno-0-213></a>    <span class=c1># convert our x to 0-1 range since equations are designed to fit in</span>
</span><span id=__span-0-214><a id=__codelineno-0-214 name=__codelineno-0-214></a>    <span class=c1># (0,0)-(1,1) space</span>
</span><span id=__span-0-215><a id=__codelineno-0-215 name=__codelineno-0-215></a>    <span class=n>x_per</span> <span class=o>=</span> <span class=p>(</span><span class=n>x_cur</span> <span class=o>-</span> <span class=n>x0</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>x1</span> <span class=o>-</span> <span class=n>x0</span><span class=p>)</span>
</span><span id=__span-0-216><a id=__codelineno-0-216 name=__codelineno-0-216></a>
</span><span id=__span-0-217><a id=__codelineno-0-217 name=__codelineno-0-217></a>    <span class=c1># map x to y using the desired function in (0,0)-(1,1) space</span>
</span><span id=__span-0-218><a id=__codelineno-0-218 name=__codelineno-0-218></a>    <span class=k>if</span> <span class=n>inter_func</span> <span class=o>==</span> <span class=s2>&quot;linear&quot;</span><span class=p>:</span>
</span><span id=__span-0-219><a id=__codelineno-0-219 name=__codelineno-0-219></a>        <span class=n>y_per</span> <span class=o>=</span> <span class=n>x_per</span>
</span><span id=__span-0-220><a id=__codelineno-0-220 name=__codelineno-0-220></a>    <span class=k>elif</span> <span class=n>inter_func</span> <span class=o>==</span> <span class=s2>&quot;cubic&quot;</span><span class=p>:</span>
</span><span id=__span-0-221><a id=__codelineno-0-221 name=__codelineno-0-221></a>        <span class=c1># https://www.wolframalpha.com/input/?i=1-(1-x)%5E3+from+0+to+1</span>
</span><span id=__span-0-222><a id=__codelineno-0-222 name=__codelineno-0-222></a>        <span class=n>y_per</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>-</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>x_per</span><span class=p>)</span> <span class=o>**</span> <span class=mi>3</span>
</span><span id=__span-0-223><a id=__codelineno-0-223 name=__codelineno-0-223></a>    <span class=k>elif</span> <span class=n>inter_func</span> <span class=o>==</span> <span class=s2>&quot;inverse_cubic&quot;</span><span class=p>:</span>
</span><span id=__span-0-224><a id=__codelineno-0-224 name=__codelineno-0-224></a>        <span class=c1># https://www.wolframalpha.com/input/?i=1-(1-x)%5E(1%2F3)+from+0+to+1</span>
</span><span id=__span-0-225><a id=__codelineno-0-225 name=__codelineno-0-225></a>        <span class=n>y_per</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>-</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>x_per</span><span class=p>)</span> <span class=o>**</span> <span class=p>(</span><span class=mi>1</span> <span class=o>/</span> <span class=mi>3</span><span class=p>)</span>
</span><span id=__span-0-226><a id=__codelineno-0-226 name=__codelineno-0-226></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-227><a id=__codelineno-0-227 name=__codelineno-0-227></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-228><a id=__codelineno-0-228 name=__codelineno-0-228></a>            <span class=s2>&quot;unsupported inter_func given of </span><span class=si>{}</span><span class=s2> in interpolate&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>inter_func</span><span class=p>)</span>
</span><span id=__span-0-229><a id=__codelineno-0-229 name=__codelineno-0-229></a>        <span class=p>)</span>
</span><span id=__span-0-230><a id=__codelineno-0-230 name=__codelineno-0-230></a>
</span><span id=__span-0-231><a id=__codelineno-0-231 name=__codelineno-0-231></a>    <span class=k>if</span> <span class=n>y_per</span> <span class=o>&lt;=</span> <span class=mf>0.0</span> <span class=o>+</span> <span class=n>sys</span><span class=o>.</span><span class=n>float_info</span><span class=o>.</span><span class=n>epsilon</span><span class=p>:</span>
</span><span id=__span-0-232><a id=__codelineno-0-232 name=__codelineno-0-232></a>        <span class=k>return</span> <span class=n>y0</span>
</span><span id=__span-0-233><a id=__codelineno-0-233 name=__codelineno-0-233></a>
</span><span id=__span-0-234><a id=__codelineno-0-234 name=__codelineno-0-234></a>    <span class=k>if</span> <span class=n>y_per</span> <span class=o>&gt;=</span> <span class=mf>1.0</span> <span class=o>-</span> <span class=n>sys</span><span class=o>.</span><span class=n>float_info</span><span class=o>.</span><span class=n>epsilon</span><span class=p>:</span>
</span><span id=__span-0-235><a id=__codelineno-0-235 name=__codelineno-0-235></a>        <span class=k>return</span> <span class=n>y1</span>
</span><span id=__span-0-236><a id=__codelineno-0-236 name=__codelineno-0-236></a>
</span><span id=__span-0-237><a id=__codelineno-0-237 name=__codelineno-0-237></a>    <span class=c1># scale the threshold based on what we want the current to be</span>
</span><span id=__span-0-238><a id=__codelineno-0-238 name=__codelineno-0-238></a>    <span class=k>return</span> <span class=n>y_per</span> <span class=o>*</span> <span class=p>(</span><span class=n>y1</span> <span class=o>-</span> <span class=n>y0</span><span class=p>)</span> <span class=o>+</span> <span class=n>y0</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.interpolate_list_linear class="doc doc-heading"> <code class="highlight language-python"><span class=n>interpolate_list_linear</span><span class=p>(</span><span class=n>measurements</span><span class=p>,</span> <span class=n>x_val</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>interpolate for input values within a list of measurements linearly</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>measurements</code> </td> <td> <code><span title=typing.List>List</span>[<span title=typing.Tuple>Tuple</span>[<span title=float>float</span>, <span title=float>float</span>]]</code> </td> <td> <div class=doc-md-description> <p>the measurements to interpolate the output value between</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>x_val</code> </td> <td> <code><span title=typing.Union>Union</span>[<span title=float>float</span>, <span title=typing.List>List</span>[<span title=float>float</span>]]</code> </td> <td> <div class=doc-md-description> <p>the target values to interpolate to the second dimension</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.List>List</span>[<span title=typing.Tuple>Tuple</span>[<span title=float>float</span>, <span title=float>float</span>]]</code> </td> <td> <div class=doc-md-description> <p>a list of tuples containing the target values, interpolated values</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-241>241</a></span>
<span class=normal><a href=#__codelineno-0-242>242</a></span>
<span class=normal><a href=#__codelineno-0-243>243</a></span>
<span class=normal><a href=#__codelineno-0-244>244</a></span>
<span class=normal><a href=#__codelineno-0-245>245</a></span>
<span class=normal><a href=#__codelineno-0-246>246</a></span>
<span class=normal><a href=#__codelineno-0-247>247</a></span>
<span class=normal><a href=#__codelineno-0-248>248</a></span>
<span class=normal><a href=#__codelineno-0-249>249</a></span>
<span class=normal><a href=#__codelineno-0-250>250</a></span>
<span class=normal><a href=#__codelineno-0-251>251</a></span>
<span class=normal><a href=#__codelineno-0-252>252</a></span>
<span class=normal><a href=#__codelineno-0-253>253</a></span>
<span class=normal><a href=#__codelineno-0-254>254</a></span>
<span class=normal><a href=#__codelineno-0-255>255</a></span>
<span class=normal><a href=#__codelineno-0-256>256</a></span>
<span class=normal><a href=#__codelineno-0-257>257</a></span>
<span class=normal><a href=#__codelineno-0-258>258</a></span>
<span class=normal><a href=#__codelineno-0-259>259</a></span>
<span class=normal><a href=#__codelineno-0-260>260</a></span>
<span class=normal><a href=#__codelineno-0-261>261</a></span>
<span class=normal><a href=#__codelineno-0-262>262</a></span>
<span class=normal><a href=#__codelineno-0-263>263</a></span>
<span class=normal><a href=#__codelineno-0-264>264</a></span>
<span class=normal><a href=#__codelineno-0-265>265</a></span>
<span class=normal><a href=#__codelineno-0-266>266</a></span>
<span class=normal><a href=#__codelineno-0-267>267</a></span>
<span class=normal><a href=#__codelineno-0-268>268</a></span>
<span class=normal><a href=#__codelineno-0-269>269</a></span>
<span class=normal><a href=#__codelineno-0-270>270</a></span>
<span class=normal><a href=#__codelineno-0-271>271</a></span>
<span class=normal><a href=#__codelineno-0-272>272</a></span>
<span class=normal><a href=#__codelineno-0-273>273</a></span>
<span class=normal><a href=#__codelineno-0-274>274</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-241><a id=__codelineno-0-241 name=__codelineno-0-241></a><span class=k>def</span><span class=w> </span><span class=nf>interpolate_list_linear</span><span class=p>(</span>
</span><span id=__span-0-242><a id=__codelineno-0-242 name=__codelineno-0-242></a>    <span class=n>measurements</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]],</span> <span class=n>x_val</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=n>List</span><span class=p>[</span><span class=nb>float</span><span class=p>]]</span>
</span><span id=__span-0-243><a id=__codelineno-0-243 name=__codelineno-0-243></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]]:</span>
</span><span id=__span-0-244><a id=__codelineno-0-244 name=__codelineno-0-244></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-245><a id=__codelineno-0-245 name=__codelineno-0-245></a><span class=sd>    interpolate for input values within a list of measurements linearly</span>
</span><span id=__span-0-246><a id=__codelineno-0-246 name=__codelineno-0-246></a>
</span><span id=__span-0-247><a id=__codelineno-0-247 name=__codelineno-0-247></a><span class=sd>    :param measurements: the measurements to interpolate the output value between</span>
</span><span id=__span-0-248><a id=__codelineno-0-248 name=__codelineno-0-248></a><span class=sd>    :param x_val: the target values to interpolate to the second dimension</span>
</span><span id=__span-0-249><a id=__codelineno-0-249 name=__codelineno-0-249></a><span class=sd>    :return: a list of tuples containing the target values, interpolated values</span>
</span><span id=__span-0-250><a id=__codelineno-0-250 name=__codelineno-0-250></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-251><a id=__codelineno-0-251 name=__codelineno-0-251></a>    <span class=k>assert</span> <span class=nb>len</span><span class=p>(</span><span class=n>measurements</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span>
</span><span id=__span-0-252><a id=__codelineno-0-252 name=__codelineno-0-252></a>    <span class=n>measurements</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>v</span><span class=p>:</span> <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span><span id=__span-0-253><a id=__codelineno-0-253 name=__codelineno-0-253></a>
</span><span id=__span-0-254><a id=__codelineno-0-254 name=__codelineno-0-254></a>    <span class=n>x_vals</span> <span class=o>=</span> <span class=p>[</span><span class=n>x_val</span><span class=p>]</span> <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>x_val</span><span class=p>,</span> <span class=nb>float</span><span class=p>)</span> <span class=k>else</span> <span class=n>x_val</span>
</span><span id=__span-0-255><a id=__codelineno-0-255 name=__codelineno-0-255></a>    <span class=n>x_vals</span><span class=o>.</span><span class=n>sort</span><span class=p>()</span>
</span><span id=__span-0-256><a id=__codelineno-0-256 name=__codelineno-0-256></a>
</span><span id=__span-0-257><a id=__codelineno-0-257 name=__codelineno-0-257></a>    <span class=n>interpolated</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-258><a id=__codelineno-0-258 name=__codelineno-0-258></a>    <span class=n>lower_index</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-259><a id=__codelineno-0-259 name=__codelineno-0-259></a>    <span class=n>higher_index</span> <span class=o>=</span> <span class=mi>1</span>
</span><span id=__span-0-260><a id=__codelineno-0-260 name=__codelineno-0-260></a>
</span><span id=__span-0-261><a id=__codelineno-0-261 name=__codelineno-0-261></a>    <span class=k>for</span> <span class=n>x_val</span> <span class=ow>in</span> <span class=n>x_vals</span><span class=p>:</span>
</span><span id=__span-0-262><a id=__codelineno-0-262 name=__codelineno-0-262></a>        <span class=k>while</span> <span class=p>(</span>
</span><span id=__span-0-263><a id=__codelineno-0-263 name=__codelineno-0-263></a>            <span class=n>x_val</span> <span class=o>&gt;</span> <span class=n>measurements</span><span class=p>[</span><span class=n>higher_index</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-0-264><a id=__codelineno-0-264 name=__codelineno-0-264></a>            <span class=ow>and</span> <span class=n>higher_index</span> <span class=o>&lt;</span> <span class=nb>len</span><span class=p>(</span><span class=n>measurements</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span>
</span><span id=__span-0-265><a id=__codelineno-0-265 name=__codelineno-0-265></a>        <span class=p>):</span>
</span><span id=__span-0-266><a id=__codelineno-0-266 name=__codelineno-0-266></a>            <span class=n>lower_index</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-267><a id=__codelineno-0-267 name=__codelineno-0-267></a>            <span class=n>higher_index</span> <span class=o>+=</span> <span class=mi>1</span>
</span><span id=__span-0-268><a id=__codelineno-0-268 name=__codelineno-0-268></a>
</span><span id=__span-0-269><a id=__codelineno-0-269 name=__codelineno-0-269></a>        <span class=n>x0</span><span class=p>,</span> <span class=n>y0</span> <span class=o>=</span> <span class=n>measurements</span><span class=p>[</span><span class=n>lower_index</span><span class=p>]</span>
</span><span id=__span-0-270><a id=__codelineno-0-270 name=__codelineno-0-270></a>        <span class=n>x1</span><span class=p>,</span> <span class=n>y1</span> <span class=o>=</span> <span class=n>measurements</span><span class=p>[</span><span class=n>higher_index</span><span class=p>]</span>
</span><span id=__span-0-271><a id=__codelineno-0-271 name=__codelineno-0-271></a>        <span class=n>y_val</span> <span class=o>=</span> <span class=n>y0</span> <span class=o>+</span> <span class=p>(</span><span class=n>x_val</span> <span class=o>-</span> <span class=n>x0</span><span class=p>)</span> <span class=o>*</span> <span class=p>((</span><span class=n>y1</span> <span class=o>-</span> <span class=n>y0</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>x1</span> <span class=o>-</span> <span class=n>x0</span><span class=p>))</span>
</span><span id=__span-0-272><a id=__codelineno-0-272 name=__codelineno-0-272></a>        <span class=n>interpolated</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>x_val</span><span class=p>,</span> <span class=n>y_val</span><span class=p>))</span>
</span><span id=__span-0-273><a id=__codelineno-0-273 name=__codelineno-0-273></a>
</span><span id=__span-0-274><a id=__codelineno-0-274 name=__codelineno-0-274></a>    <span class=k>return</span> <span class=n>interpolated</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.interpolated_integral class="doc doc-heading"> <code class="highlight language-python"><span class=n>interpolated_integral</span><span class=p>(</span><span class=n>measurements</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Calculate the interpolated integal for a group of measurements of the form [(x0, y0), (x1, y1), ...]</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>measurements</code> </td> <td> <code><span title=typing.List>List</span>[<span title=typing.Tuple>Tuple</span>[<span title=float>float</span>, <span title=float>float</span>]]</code> </td> <td> <div class=doc-md-description> <p>the measurements to calculate the integral for</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>the integral or area under the curve for the measurements given</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-277>277</a></span>
<span class=normal><a href=#__codelineno-0-278>278</a></span>
<span class=normal><a href=#__codelineno-0-279>279</a></span>
<span class=normal><a href=#__codelineno-0-280>280</a></span>
<span class=normal><a href=#__codelineno-0-281>281</a></span>
<span class=normal><a href=#__codelineno-0-282>282</a></span>
<span class=normal><a href=#__codelineno-0-283>283</a></span>
<span class=normal><a href=#__codelineno-0-284>284</a></span>
<span class=normal><a href=#__codelineno-0-285>285</a></span>
<span class=normal><a href=#__codelineno-0-286>286</a></span>
<span class=normal><a href=#__codelineno-0-287>287</a></span>
<span class=normal><a href=#__codelineno-0-288>288</a></span>
<span class=normal><a href=#__codelineno-0-289>289</a></span>
<span class=normal><a href=#__codelineno-0-290>290</a></span>
<span class=normal><a href=#__codelineno-0-291>291</a></span>
<span class=normal><a href=#__codelineno-0-292>292</a></span>
<span class=normal><a href=#__codelineno-0-293>293</a></span>
<span class=normal><a href=#__codelineno-0-294>294</a></span>
<span class=normal><a href=#__codelineno-0-295>295</a></span>
<span class=normal><a href=#__codelineno-0-296>296</a></span>
<span class=normal><a href=#__codelineno-0-297>297</a></span>
<span class=normal><a href=#__codelineno-0-298>298</a></span>
<span class=normal><a href=#__codelineno-0-299>299</a></span>
<span class=normal><a href=#__codelineno-0-300>300</a></span>
<span class=normal><a href=#__codelineno-0-301>301</a></span>
<span class=normal><a href=#__codelineno-0-302>302</a></span>
<span class=normal><a href=#__codelineno-0-303>303</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-277><a id=__codelineno-0-277 name=__codelineno-0-277></a><span class=k>def</span><span class=w> </span><span class=nf>interpolated_integral</span><span class=p>(</span><span class=n>measurements</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>float</span><span class=p>,</span> <span class=nb>float</span><span class=p>]]):</span>
</span><span id=__span-0-278><a id=__codelineno-0-278 name=__codelineno-0-278></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-279><a id=__codelineno-0-279 name=__codelineno-0-279></a><span class=sd>    Calculate the interpolated integal for a group of measurements of the form</span>
</span><span id=__span-0-280><a id=__codelineno-0-280 name=__codelineno-0-280></a><span class=sd>    [(x0, y0), (x1, y1), ...]</span>
</span><span id=__span-0-281><a id=__codelineno-0-281 name=__codelineno-0-281></a>
</span><span id=__span-0-282><a id=__codelineno-0-282 name=__codelineno-0-282></a><span class=sd>    :param measurements: the measurements to calculate the integral for</span>
</span><span id=__span-0-283><a id=__codelineno-0-283 name=__codelineno-0-283></a><span class=sd>    :return: the integral or area under the curve for the measurements given</span>
</span><span id=__span-0-284><a id=__codelineno-0-284 name=__codelineno-0-284></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-285><a id=__codelineno-0-285 name=__codelineno-0-285></a>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>measurements</span><span class=p>)</span> <span class=o>&lt;</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-286><a id=__codelineno-0-286 name=__codelineno-0-286></a>        <span class=k>return</span> <span class=mf>0.0</span>
</span><span id=__span-0-287><a id=__codelineno-0-287 name=__codelineno-0-287></a>
</span><span id=__span-0-288><a id=__codelineno-0-288 name=__codelineno-0-288></a>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>measurements</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-289><a id=__codelineno-0-289 name=__codelineno-0-289></a>        <span class=k>return</span> <span class=n>measurements</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-290><a id=__codelineno-0-290 name=__codelineno-0-290></a>
</span><span id=__span-0-291><a id=__codelineno-0-291 name=__codelineno-0-291></a>    <span class=n>measurements</span><span class=o>.</span><span class=n>sort</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=k>lambda</span> <span class=n>v</span><span class=p>:</span> <span class=n>v</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span><span id=__span-0-292><a id=__codelineno-0-292 name=__codelineno-0-292></a>    <span class=n>integral</span> <span class=o>=</span> <span class=mf>0.0</span>
</span><span id=__span-0-293><a id=__codelineno-0-293 name=__codelineno-0-293></a>
</span><span id=__span-0-294><a id=__codelineno-0-294 name=__codelineno-0-294></a>    <span class=k>for</span> <span class=n>index</span><span class=p>,</span> <span class=p>(</span><span class=n>x_val</span><span class=p>,</span> <span class=n>y_val</span><span class=p>)</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>measurements</span><span class=p>):</span>
</span><span id=__span-0-295><a id=__codelineno-0-295 name=__codelineno-0-295></a>        <span class=k>if</span> <span class=n>index</span> <span class=o>&gt;=</span> <span class=nb>len</span><span class=p>(</span><span class=n>measurements</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span><span class=p>:</span>
</span><span id=__span-0-296><a id=__codelineno-0-296 name=__codelineno-0-296></a>            <span class=k>continue</span>
</span><span id=__span-0-297><a id=__codelineno-0-297 name=__codelineno-0-297></a>
</span><span id=__span-0-298><a id=__codelineno-0-298 name=__codelineno-0-298></a>        <span class=n>x_next</span><span class=p>,</span> <span class=n>y_next</span> <span class=o>=</span> <span class=n>measurements</span><span class=p>[</span><span class=n>index</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
</span><span id=__span-0-299><a id=__codelineno-0-299 name=__codelineno-0-299></a>        <span class=n>x_dist</span> <span class=o>=</span> <span class=n>x_next</span> <span class=o>-</span> <span class=n>x_val</span>
</span><span id=__span-0-300><a id=__codelineno-0-300 name=__codelineno-0-300></a>        <span class=n>area</span> <span class=o>=</span> <span class=n>y_val</span> <span class=o>*</span> <span class=n>x_dist</span> <span class=o>+</span> <span class=p>(</span><span class=n>y_next</span> <span class=o>-</span> <span class=n>y_val</span><span class=p>)</span> <span class=o>*</span> <span class=n>x_dist</span> <span class=o>/</span> <span class=mf>2.0</span>
</span><span id=__span-0-301><a id=__codelineno-0-301 name=__codelineno-0-301></a>        <span class=n>integral</span> <span class=o>+=</span> <span class=n>area</span>
</span><span id=__span-0-302><a id=__codelineno-0-302 name=__codelineno-0-302></a>
</span><span id=__span-0-303><a id=__codelineno-0-303 name=__codelineno-0-303></a>    <span class=k>return</span> <span class=n>integral</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.is_package_available class="doc doc-heading"> <code class="highlight language-python"><span class=n>is_package_available</span><span class=p>(</span><span class=n>package_name</span><span class=p>,</span> <span class=n>return_version</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>A helper function to check if a package is available and optionally return its version. This function enforces a check that the package is available and is not just a directory/file with the same name as the package.</p> <p>inspired from: https://github.com/huggingface/transformers/blob/965cf677695dd363285831afca8cf479cf0c600c/src/transformers/utils/import_utils.py#L41</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>package_name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>The package name to check for</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>return_version</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>True to return the version of the package if available</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Union>Union</span>[<span title=typing.Tuple>Tuple</span>[<span title=bool>bool</span>, <span title=str>str</span>], <span title=bool>bool</span>]</code> </td> <td> <div class=doc-md-description> <p>True if the package is available, False otherwise or a tuple of (bool, version) if return_version is True</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-883>883</a></span>
<span class=normal><a href=#__codelineno-0-884>884</a></span>
<span class=normal><a href=#__codelineno-0-885>885</a></span>
<span class=normal><a href=#__codelineno-0-886>886</a></span>
<span class=normal><a href=#__codelineno-0-887>887</a></span>
<span class=normal><a href=#__codelineno-0-888>888</a></span>
<span class=normal><a href=#__codelineno-0-889>889</a></span>
<span class=normal><a href=#__codelineno-0-890>890</a></span>
<span class=normal><a href=#__codelineno-0-891>891</a></span>
<span class=normal><a href=#__codelineno-0-892>892</a></span>
<span class=normal><a href=#__codelineno-0-893>893</a></span>
<span class=normal><a href=#__codelineno-0-894>894</a></span>
<span class=normal><a href=#__codelineno-0-895>895</a></span>
<span class=normal><a href=#__codelineno-0-896>896</a></span>
<span class=normal><a href=#__codelineno-0-897>897</a></span>
<span class=normal><a href=#__codelineno-0-898>898</a></span>
<span class=normal><a href=#__codelineno-0-899>899</a></span>
<span class=normal><a href=#__codelineno-0-900>900</a></span>
<span class=normal><a href=#__codelineno-0-901>901</a></span>
<span class=normal><a href=#__codelineno-0-902>902</a></span>
<span class=normal><a href=#__codelineno-0-903>903</a></span>
<span class=normal><a href=#__codelineno-0-904>904</a></span>
<span class=normal><a href=#__codelineno-0-905>905</a></span>
<span class=normal><a href=#__codelineno-0-906>906</a></span>
<span class=normal><a href=#__codelineno-0-907>907</a></span>
<span class=normal><a href=#__codelineno-0-908>908</a></span>
<span class=normal><a href=#__codelineno-0-909>909</a></span>
<span class=normal><a href=#__codelineno-0-910>910</a></span>
<span class=normal><a href=#__codelineno-0-911>911</a></span>
<span class=normal><a href=#__codelineno-0-912>912</a></span>
<span class=normal><a href=#__codelineno-0-913>913</a></span>
<span class=normal><a href=#__codelineno-0-914>914</a></span>
<span class=normal><a href=#__codelineno-0-915>915</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-883><a id=__codelineno-0-883 name=__codelineno-0-883></a><span class=k>def</span><span class=w> </span><span class=nf>is_package_available</span><span class=p>(</span>
</span><span id=__span-0-884><a id=__codelineno-0-884 name=__codelineno-0-884></a>    <span class=n>package_name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-885><a id=__codelineno-0-885 name=__codelineno-0-885></a>    <span class=n>return_version</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-886><a id=__codelineno-0-886 name=__codelineno-0-886></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>Tuple</span><span class=p>[</span><span class=nb>bool</span><span class=p>,</span> <span class=nb>str</span><span class=p>],</span> <span class=nb>bool</span><span class=p>]:</span>
</span><span id=__span-0-887><a id=__codelineno-0-887 name=__codelineno-0-887></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-888><a id=__codelineno-0-888 name=__codelineno-0-888></a><span class=sd>    A helper function to check if a package is available</span>
</span><span id=__span-0-889><a id=__codelineno-0-889 name=__codelineno-0-889></a><span class=sd>    and optionally return its version. This function enforces</span>
</span><span id=__span-0-890><a id=__codelineno-0-890 name=__codelineno-0-890></a><span class=sd>    a check that the package is available and is not</span>
</span><span id=__span-0-891><a id=__codelineno-0-891 name=__codelineno-0-891></a><span class=sd>    just a directory/file with the same name as the package.</span>
</span><span id=__span-0-892><a id=__codelineno-0-892 name=__codelineno-0-892></a>
</span><span id=__span-0-893><a id=__codelineno-0-893 name=__codelineno-0-893></a><span class=sd>    inspired from:</span>
</span><span id=__span-0-894><a id=__codelineno-0-894 name=__codelineno-0-894></a><span class=sd>    https://github.com/huggingface/transformers/blob/965cf677695dd363285831afca8cf479cf0c600c/src/transformers/utils/import_utils.py#L41</span>
</span><span id=__span-0-895><a id=__codelineno-0-895 name=__codelineno-0-895></a>
</span><span id=__span-0-896><a id=__codelineno-0-896 name=__codelineno-0-896></a><span class=sd>    :param package_name: The package name to check for</span>
</span><span id=__span-0-897><a id=__codelineno-0-897 name=__codelineno-0-897></a><span class=sd>    :param return_version: True to return the version of</span>
</span><span id=__span-0-898><a id=__codelineno-0-898 name=__codelineno-0-898></a><span class=sd>        the package if available</span>
</span><span id=__span-0-899><a id=__codelineno-0-899 name=__codelineno-0-899></a><span class=sd>    :return: True if the package is available, False otherwise or a tuple of</span>
</span><span id=__span-0-900><a id=__codelineno-0-900 name=__codelineno-0-900></a><span class=sd>        (bool, version) if return_version is True</span>
</span><span id=__span-0-901><a id=__codelineno-0-901 name=__codelineno-0-901></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-902><a id=__codelineno-0-902 name=__codelineno-0-902></a>
</span><span id=__span-0-903><a id=__codelineno-0-903 name=__codelineno-0-903></a>    <span class=n>package_exists</span> <span class=o>=</span> <span class=n>importlib</span><span class=o>.</span><span class=n>util</span><span class=o>.</span><span class=n>find_spec</span><span class=p>(</span><span class=n>package_name</span><span class=p>)</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span>
</span><span id=__span-0-904><a id=__codelineno-0-904 name=__codelineno-0-904></a>    <span class=n>package_version</span> <span class=o>=</span> <span class=s2>&quot;N/A&quot;</span>
</span><span id=__span-0-905><a id=__codelineno-0-905 name=__codelineno-0-905></a>    <span class=k>if</span> <span class=n>package_exists</span><span class=p>:</span>
</span><span id=__span-0-906><a id=__codelineno-0-906 name=__codelineno-0-906></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-907><a id=__codelineno-0-907 name=__codelineno-0-907></a>            <span class=n>package_version</span> <span class=o>=</span> <span class=n>importlib</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>version</span><span class=p>(</span><span class=n>package_name</span><span class=p>)</span>
</span><span id=__span-0-908><a id=__codelineno-0-908 name=__codelineno-0-908></a>            <span class=n>package_exists</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-909><a id=__codelineno-0-909 name=__codelineno-0-909></a>        <span class=k>except</span> <span class=n>importlib</span><span class=o>.</span><span class=n>metadata</span><span class=o>.</span><span class=n>PackageNotFoundError</span><span class=p>:</span>
</span><span id=__span-0-910><a id=__codelineno-0-910 name=__codelineno-0-910></a>            <span class=n>package_exists</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-0-911><a id=__codelineno-0-911 name=__codelineno-0-911></a>        <span class=n>logger</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Detected </span><span class=si>{</span><span class=n>package_name</span><span class=si>}</span><span class=s2> version </span><span class=si>{</span><span class=n>package_version</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-0-912><a id=__codelineno-0-912 name=__codelineno-0-912></a>    <span class=k>if</span> <span class=n>return_version</span><span class=p>:</span>
</span><span id=__span-0-913><a id=__codelineno-0-913 name=__codelineno-0-913></a>        <span class=k>return</span> <span class=n>package_exists</span><span class=p>,</span> <span class=n>package_version</span>
</span><span id=__span-0-914><a id=__codelineno-0-914 name=__codelineno-0-914></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-915><a id=__codelineno-0-915 name=__codelineno-0-915></a>        <span class=k>return</span> <span class=n>package_exists</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.is_url class="doc doc-heading"> <code class="highlight language-python"><span class=n>is_url</span><span class=p>(</span><span class=n>val</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>val</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>value to check if it is a url or not</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>True if value is a URL, False otherwise</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-403>403</a></span>
<span class=normal><a href=#__codelineno-0-404>404</a></span>
<span class=normal><a href=#__codelineno-0-405>405</a></span>
<span class=normal><a href=#__codelineno-0-406>406</a></span>
<span class=normal><a href=#__codelineno-0-407>407</a></span>
<span class=normal><a href=#__codelineno-0-408>408</a></span>
<span class=normal><a href=#__codelineno-0-409>409</a></span>
<span class=normal><a href=#__codelineno-0-410>410</a></span>
<span class=normal><a href=#__codelineno-0-411>411</a></span>
<span class=normal><a href=#__codelineno-0-412>412</a></span>
<span class=normal><a href=#__codelineno-0-413>413</a></span>
<span class=normal><a href=#__codelineno-0-414>414</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-403><a id=__codelineno-0-403 name=__codelineno-0-403></a><span class=k>def</span><span class=w> </span><span class=nf>is_url</span><span class=p>(</span><span class=n>val</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-404><a id=__codelineno-0-404 name=__codelineno-0-404></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-405><a id=__codelineno-0-405 name=__codelineno-0-405></a><span class=sd>    :param val: value to check if it is a url or not</span>
</span><span id=__span-0-406><a id=__codelineno-0-406 name=__codelineno-0-406></a><span class=sd>    :return: True if value is a URL, False otherwise</span>
</span><span id=__span-0-407><a id=__codelineno-0-407 name=__codelineno-0-407></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-408><a id=__codelineno-0-408 name=__codelineno-0-408></a>
</span><span id=__span-0-409><a id=__codelineno-0-409 name=__codelineno-0-409></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-410><a id=__codelineno-0-410 name=__codelineno-0-410></a>        <span class=n>result</span> <span class=o>=</span> <span class=n>urlparse</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
</span><span id=__span-0-411><a id=__codelineno-0-411 name=__codelineno-0-411></a>
</span><span id=__span-0-412><a id=__codelineno-0-412 name=__codelineno-0-412></a>        <span class=k>return</span> <span class=nb>all</span><span class=p>([</span><span class=n>result</span><span class=o>.</span><span class=n>scheme</span><span class=p>,</span> <span class=n>result</span><span class=o>.</span><span class=n>netloc</span><span class=p>])</span>
</span><span id=__span-0-413><a id=__codelineno-0-413 name=__codelineno-0-413></a>    <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
</span><span id=__span-0-414><a id=__codelineno-0-414 name=__codelineno-0-414></a>        <span class=k>return</span> <span class=kc>False</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.json_to_jsonl class="doc doc-heading"> <code class="highlight language-python"><span class=n>json_to_jsonl</span><span class=p>(</span><span class=n>json_file_path</span><span class=p>,</span> <span class=n>overwrite</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p 1=1 _a_:='"a":'>Converts a json list file to jsonl file format (used for sharding efficienty) e.x. [{"a": 1}, {"a": 1}] would convert to: {"a": 1}</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>json_file_path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>file path to a json file path containing a json list of objects</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>overwrite</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>If True, the existing json file will be overwritten, if False, the file will have the same name but with a .jsonl extension</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-843>843</a></span>
<span class=normal><a href=#__codelineno-0-844>844</a></span>
<span class=normal><a href=#__codelineno-0-845>845</a></span>
<span class=normal><a href=#__codelineno-0-846>846</a></span>
<span class=normal><a href=#__codelineno-0-847>847</a></span>
<span class=normal><a href=#__codelineno-0-848>848</a></span>
<span class=normal><a href=#__codelineno-0-849>849</a></span>
<span class=normal><a href=#__codelineno-0-850>850</a></span>
<span class=normal><a href=#__codelineno-0-851>851</a></span>
<span class=normal><a href=#__codelineno-0-852>852</a></span>
<span class=normal><a href=#__codelineno-0-853>853</a></span>
<span class=normal><a href=#__codelineno-0-854>854</a></span>
<span class=normal><a href=#__codelineno-0-855>855</a></span>
<span class=normal><a href=#__codelineno-0-856>856</a></span>
<span class=normal><a href=#__codelineno-0-857>857</a></span>
<span class=normal><a href=#__codelineno-0-858>858</a></span>
<span class=normal><a href=#__codelineno-0-859>859</a></span>
<span class=normal><a href=#__codelineno-0-860>860</a></span>
<span class=normal><a href=#__codelineno-0-861>861</a></span>
<span class=normal><a href=#__codelineno-0-862>862</a></span>
<span class=normal><a href=#__codelineno-0-863>863</a></span>
<span class=normal><a href=#__codelineno-0-864>864</a></span>
<span class=normal><a href=#__codelineno-0-865>865</a></span>
<span class=normal><a href=#__codelineno-0-866>866</a></span>
<span class=normal><a href=#__codelineno-0-867>867</a></span>
<span class=normal><a href=#__codelineno-0-868>868</a></span>
<span class=normal><a href=#__codelineno-0-869>869</a></span>
<span class=normal><a href=#__codelineno-0-870>870</a></span>
<span class=normal><a href=#__codelineno-0-871>871</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-843><a id=__codelineno-0-843 name=__codelineno-0-843></a><span class=k>def</span><span class=w> </span><span class=nf>json_to_jsonl</span><span class=p>(</span><span class=n>json_file_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>overwrite</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>):</span>
</span><span id=__span-0-844><a id=__codelineno-0-844 name=__codelineno-0-844></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-845><a id=__codelineno-0-845 name=__codelineno-0-845></a><span class=sd>    Converts a json list file to jsonl file format (used for sharding efficienty)</span>
</span><span id=__span-0-846><a id=__codelineno-0-846 name=__codelineno-0-846></a><span class=sd>        e.x.</span>
</span><span id=__span-0-847><a id=__codelineno-0-847 name=__codelineno-0-847></a><span class=sd>            [{&quot;a&quot;: 1}, {&quot;a&quot;: 1}]</span>
</span><span id=__span-0-848><a id=__codelineno-0-848 name=__codelineno-0-848></a><span class=sd>        would convert to:</span>
</span><span id=__span-0-849><a id=__codelineno-0-849 name=__codelineno-0-849></a><span class=sd>            {&quot;a&quot;: 1}</span>
</span><span id=__span-0-850><a id=__codelineno-0-850 name=__codelineno-0-850></a><span class=sd>            {&quot;a&quot;: 1}</span>
</span><span id=__span-0-851><a id=__codelineno-0-851 name=__codelineno-0-851></a><span class=sd>    :param json_file_path: file path to a json file path containing a json list</span>
</span><span id=__span-0-852><a id=__codelineno-0-852 name=__codelineno-0-852></a><span class=sd>        of objects</span>
</span><span id=__span-0-853><a id=__codelineno-0-853 name=__codelineno-0-853></a><span class=sd>    :param overwrite: If True, the existing json file will be overwritten, if False,</span>
</span><span id=__span-0-854><a id=__codelineno-0-854 name=__codelineno-0-854></a><span class=sd>        the file will have the same name but with a .jsonl extension</span>
</span><span id=__span-0-855><a id=__codelineno-0-855 name=__codelineno-0-855></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-856><a id=__codelineno-0-856 name=__codelineno-0-856></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>json_file_path</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&quot;.json&quot;</span><span class=p>):</span>
</span><span id=__span-0-857><a id=__codelineno-0-857 name=__codelineno-0-857></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;json file must have .json extension&quot;</span><span class=p>)</span>
</span><span id=__span-0-858><a id=__codelineno-0-858 name=__codelineno-0-858></a>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>json_file_path</span><span class=p>)</span> <span class=k>as</span> <span class=n>json_file</span><span class=p>:</span>
</span><span id=__span-0-859><a id=__codelineno-0-859 name=__codelineno-0-859></a>        <span class=n>json_data</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>json_file</span><span class=p>)</span>
</span><span id=__span-0-860><a id=__codelineno-0-860 name=__codelineno-0-860></a>
</span><span id=__span-0-861><a id=__codelineno-0-861 name=__codelineno-0-861></a>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>json_data</span><span class=p>,</span> <span class=n>List</span><span class=p>):</span>
</span><span id=__span-0-862><a id=__codelineno-0-862 name=__codelineno-0-862></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-863><a id=__codelineno-0-863 name=__codelineno-0-863></a>            <span class=s2>&quot;Json data must be a list to conver to jsonl format. &quot;</span>
</span><span id=__span-0-864><a id=__codelineno-0-864 name=__codelineno-0-864></a>            <span class=sa>f</span><span class=s2>&quot;found </span><span class=si>{</span><span class=nb>type</span><span class=p>(</span><span class=n>json_data</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
</span><span id=__span-0-865><a id=__codelineno-0-865 name=__codelineno-0-865></a>        <span class=p>)</span>
</span><span id=__span-0-866><a id=__codelineno-0-866 name=__codelineno-0-866></a>
</span><span id=__span-0-867><a id=__codelineno-0-867 name=__codelineno-0-867></a>    <span class=n>jsonl_file_path</span> <span class=o>=</span> <span class=n>json_file_path</span> <span class=o>+</span> <span class=p>(</span><span class=s2>&quot;&quot;</span> <span class=k>if</span> <span class=n>overwrite</span> <span class=k>else</span> <span class=s2>&quot;l&quot;</span><span class=p>)</span>
</span><span id=__span-0-868><a id=__codelineno-0-868 name=__codelineno-0-868></a>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>jsonl_file_path</span><span class=p>,</span> <span class=s2>&quot;w&quot;</span><span class=p>)</span> <span class=k>as</span> <span class=n>jsonl_file</span><span class=p>:</span>
</span><span id=__span-0-869><a id=__codelineno-0-869 name=__codelineno-0-869></a>        <span class=k>for</span> <span class=n>json_line</span> <span class=ow>in</span> <span class=n>json_data</span><span class=p>:</span>
</span><span id=__span-0-870><a id=__codelineno-0-870 name=__codelineno-0-870></a>            <span class=n>json</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>json_line</span><span class=p>,</span> <span class=n>jsonl_file</span><span class=p>)</span>  <span class=c1># append json line</span>
</span><span id=__span-0-871><a id=__codelineno-0-871 name=__codelineno-0-871></a>            <span class=n>jsonl_file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>)</span>  <span class=c1># newline</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.load_labeled_data class="doc doc-heading"> <code class="highlight language-python"><span class=n>load_labeled_data</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>labels</span><span class=p>,</span> <span class=n>raise_on_error</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Load labels and data from disk or from memory and group them together. Assumes sorted ordering for on disk. Will match between when a file glob is passed for either data and/or labels.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code><span title=typing.Union>Union</span>[<span title=str>str</span>, <span title=typing.Iterable>Iterable</span>[<span title=typing.Union>Union</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>, <span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>]]]]</code> </td> <td> <div class=doc-md-description> <p>the file glob, file path to numpy data tar ball, or list of arrays to use for data</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>labels</code> </td> <td> <code><span title=typing.Union>Union</span>[None, <span title=str>str</span>, <span title=typing.Iterable>Iterable</span>[<span title=typing.Union>Union</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>, <span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>]]]]</code> </td> <td> <div class=doc-md-description> <p>the file glob, file path to numpy data tar ball, or list of arrays to use for labels, if any</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>raise_on_error</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>True to raise on any error that occurs; False to log a warning, ignore, and continue</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.List>List</span>[<span title=typing.Tuple>Tuple</span>[<span title=typing.Union>Union</span>[<span title=numpy.ndarray>ndarray</span>, <span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>]], <span title=typing.Union>Union</span>[None, <span title=numpy.ndarray>ndarray</span>, <span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>]]]]</code> </td> <td> <div class=doc-md-description> <p>a list containing tuples of the data, labels. If labels was passed in as None, will now contain a None for the second index in each tuple</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-551>551</a></span>
<span class=normal><a href=#__codelineno-0-552>552</a></span>
<span class=normal><a href=#__codelineno-0-553>553</a></span>
<span class=normal><a href=#__codelineno-0-554>554</a></span>
<span class=normal><a href=#__codelineno-0-555>555</a></span>
<span class=normal><a href=#__codelineno-0-556>556</a></span>
<span class=normal><a href=#__codelineno-0-557>557</a></span>
<span class=normal><a href=#__codelineno-0-558>558</a></span>
<span class=normal><a href=#__codelineno-0-559>559</a></span>
<span class=normal><a href=#__codelineno-0-560>560</a></span>
<span class=normal><a href=#__codelineno-0-561>561</a></span>
<span class=normal><a href=#__codelineno-0-562>562</a></span>
<span class=normal><a href=#__codelineno-0-563>563</a></span>
<span class=normal><a href=#__codelineno-0-564>564</a></span>
<span class=normal><a href=#__codelineno-0-565>565</a></span>
<span class=normal><a href=#__codelineno-0-566>566</a></span>
<span class=normal><a href=#__codelineno-0-567>567</a></span>
<span class=normal><a href=#__codelineno-0-568>568</a></span>
<span class=normal><a href=#__codelineno-0-569>569</a></span>
<span class=normal><a href=#__codelineno-0-570>570</a></span>
<span class=normal><a href=#__codelineno-0-571>571</a></span>
<span class=normal><a href=#__codelineno-0-572>572</a></span>
<span class=normal><a href=#__codelineno-0-573>573</a></span>
<span class=normal><a href=#__codelineno-0-574>574</a></span>
<span class=normal><a href=#__codelineno-0-575>575</a></span>
<span class=normal><a href=#__codelineno-0-576>576</a></span>
<span class=normal><a href=#__codelineno-0-577>577</a></span>
<span class=normal><a href=#__codelineno-0-578>578</a></span>
<span class=normal><a href=#__codelineno-0-579>579</a></span>
<span class=normal><a href=#__codelineno-0-580>580</a></span>
<span class=normal><a href=#__codelineno-0-581>581</a></span>
<span class=normal><a href=#__codelineno-0-582>582</a></span>
<span class=normal><a href=#__codelineno-0-583>583</a></span>
<span class=normal><a href=#__codelineno-0-584>584</a></span>
<span class=normal><a href=#__codelineno-0-585>585</a></span>
<span class=normal><a href=#__codelineno-0-586>586</a></span>
<span class=normal><a href=#__codelineno-0-587>587</a></span>
<span class=normal><a href=#__codelineno-0-588>588</a></span>
<span class=normal><a href=#__codelineno-0-589>589</a></span>
<span class=normal><a href=#__codelineno-0-590>590</a></span>
<span class=normal><a href=#__codelineno-0-591>591</a></span>
<span class=normal><a href=#__codelineno-0-592>592</a></span>
<span class=normal><a href=#__codelineno-0-593>593</a></span>
<span class=normal><a href=#__codelineno-0-594>594</a></span>
<span class=normal><a href=#__codelineno-0-595>595</a></span>
<span class=normal><a href=#__codelineno-0-596>596</a></span>
<span class=normal><a href=#__codelineno-0-597>597</a></span>
<span class=normal><a href=#__codelineno-0-598>598</a></span>
<span class=normal><a href=#__codelineno-0-599>599</a></span>
<span class=normal><a href=#__codelineno-0-600>600</a></span>
<span class=normal><a href=#__codelineno-0-601>601</a></span>
<span class=normal><a href=#__codelineno-0-602>602</a></span>
<span class=normal><a href=#__codelineno-0-603>603</a></span>
<span class=normal><a href=#__codelineno-0-604>604</a></span>
<span class=normal><a href=#__codelineno-0-605>605</a></span>
<span class=normal><a href=#__codelineno-0-606>606</a></span>
<span class=normal><a href=#__codelineno-0-607>607</a></span>
<span class=normal><a href=#__codelineno-0-608>608</a></span>
<span class=normal><a href=#__codelineno-0-609>609</a></span>
<span class=normal><a href=#__codelineno-0-610>610</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-551><a id=__codelineno-0-551 name=__codelineno-0-551></a><span class=k>def</span><span class=w> </span><span class=nf>load_labeled_data</span><span class=p>(</span>
</span><span id=__span-0-552><a id=__codelineno-0-552 name=__codelineno-0-552></a>    <span class=n>data</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]]]],</span>
</span><span id=__span-0-553><a id=__codelineno-0-553 name=__codelineno-0-553></a>    <span class=n>labels</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span>
</span><span id=__span-0-554><a id=__codelineno-0-554 name=__codelineno-0-554></a>        <span class=kc>None</span><span class=p>,</span> <span class=nb>str</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]]]</span>
</span><span id=__span-0-555><a id=__codelineno-0-555 name=__codelineno-0-555></a>    <span class=p>],</span>
</span><span id=__span-0-556><a id=__codelineno-0-556 name=__codelineno-0-556></a>    <span class=n>raise_on_error</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-557><a id=__codelineno-0-557 name=__codelineno-0-557></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span>
</span><span id=__span-0-558><a id=__codelineno-0-558 name=__codelineno-0-558></a>    <span class=n>Tuple</span><span class=p>[</span>
</span><span id=__span-0-559><a id=__codelineno-0-559 name=__codelineno-0-559></a>        <span class=n>Union</span><span class=p>[</span><span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]],</span>
</span><span id=__span-0-560><a id=__codelineno-0-560 name=__codelineno-0-560></a>        <span class=n>Union</span><span class=p>[</span><span class=kc>None</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]],</span>
</span><span id=__span-0-561><a id=__codelineno-0-561 name=__codelineno-0-561></a>    <span class=p>]</span>
</span><span id=__span-0-562><a id=__codelineno-0-562 name=__codelineno-0-562></a><span class=p>]:</span>
</span><span id=__span-0-563><a id=__codelineno-0-563 name=__codelineno-0-563></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-564><a id=__codelineno-0-564 name=__codelineno-0-564></a><span class=sd>    Load labels and data from disk or from memory and group them together.</span>
</span><span id=__span-0-565><a id=__codelineno-0-565 name=__codelineno-0-565></a><span class=sd>    Assumes sorted ordering for on disk. Will match between when a file glob is passed</span>
</span><span id=__span-0-566><a id=__codelineno-0-566 name=__codelineno-0-566></a><span class=sd>    for either data and/or labels.</span>
</span><span id=__span-0-567><a id=__codelineno-0-567 name=__codelineno-0-567></a>
</span><span id=__span-0-568><a id=__codelineno-0-568 name=__codelineno-0-568></a><span class=sd>    :param data: the file glob, file path to numpy data tar ball, or list of arrays to</span>
</span><span id=__span-0-569><a id=__codelineno-0-569 name=__codelineno-0-569></a><span class=sd>        use for data</span>
</span><span id=__span-0-570><a id=__codelineno-0-570 name=__codelineno-0-570></a><span class=sd>    :param labels: the file glob, file path to numpy data tar ball, or list of arrays</span>
</span><span id=__span-0-571><a id=__codelineno-0-571 name=__codelineno-0-571></a><span class=sd>        to use for labels, if any</span>
</span><span id=__span-0-572><a id=__codelineno-0-572 name=__codelineno-0-572></a><span class=sd>    :param raise_on_error: True to raise on any error that occurs;</span>
</span><span id=__span-0-573><a id=__codelineno-0-573 name=__codelineno-0-573></a><span class=sd>        False to log a warning, ignore, and continue</span>
</span><span id=__span-0-574><a id=__codelineno-0-574 name=__codelineno-0-574></a><span class=sd>    :return: a list containing tuples of the data, labels. If labels was passed in</span>
</span><span id=__span-0-575><a id=__codelineno-0-575 name=__codelineno-0-575></a><span class=sd>        as None, will now contain a None for the second index in each tuple</span>
</span><span id=__span-0-576><a id=__codelineno-0-576 name=__codelineno-0-576></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-577><a id=__codelineno-0-577 name=__codelineno-0-577></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-578><a id=__codelineno-0-578 name=__codelineno-0-578></a>        <span class=n>data</span> <span class=o>=</span> <span class=n>load_numpy_list</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span><span id=__span-0-579><a id=__codelineno-0-579 name=__codelineno-0-579></a>
</span><span id=__span-0-580><a id=__codelineno-0-580 name=__codelineno-0-580></a>    <span class=k>if</span> <span class=n>labels</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-0-581><a id=__codelineno-0-581 name=__codelineno-0-581></a>        <span class=n>labels</span> <span class=o>=</span> <span class=p>[</span><span class=kc>None</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>))]</span>
</span><span id=__span-0-582><a id=__codelineno-0-582 name=__codelineno-0-582></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>labels</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-583><a id=__codelineno-0-583 name=__codelineno-0-583></a>        <span class=n>labels</span> <span class=o>=</span> <span class=n>load_numpy_list</span><span class=p>(</span><span class=n>labels</span><span class=p>)</span>
</span><span id=__span-0-584><a id=__codelineno-0-584 name=__codelineno-0-584></a>
</span><span id=__span-0-585><a id=__codelineno-0-585 name=__codelineno-0-585></a>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>)</span> <span class=o>!=</span> <span class=nb>len</span><span class=p>(</span><span class=n>labels</span><span class=p>)</span> <span class=ow>and</span> <span class=n>labels</span><span class=p>:</span>
</span><span id=__span-0-586><a id=__codelineno-0-586 name=__codelineno-0-586></a>        <span class=c1># always raise this error, lengths must match</span>
</span><span id=__span-0-587><a id=__codelineno-0-587 name=__codelineno-0-587></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-588><a id=__codelineno-0-588 name=__codelineno-0-588></a>            <span class=s2>&quot;len(data) given of </span><span class=si>{}</span><span class=s2> does not match len(labels) given of </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span>
</span><span id=__span-0-589><a id=__codelineno-0-589 name=__codelineno-0-589></a>                <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>),</span> <span class=nb>len</span><span class=p>(</span><span class=n>labels</span><span class=p>)</span>
</span><span id=__span-0-590><a id=__codelineno-0-590 name=__codelineno-0-590></a>            <span class=p>)</span>
</span><span id=__span-0-591><a id=__codelineno-0-591 name=__codelineno-0-591></a>        <span class=p>)</span>
</span><span id=__span-0-592><a id=__codelineno-0-592 name=__codelineno-0-592></a>
</span><span id=__span-0-593><a id=__codelineno-0-593 name=__codelineno-0-593></a>    <span class=n>labeled_data</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-594><a id=__codelineno-0-594 name=__codelineno-0-594></a>
</span><span id=__span-0-595><a id=__codelineno-0-595 name=__codelineno-0-595></a>    <span class=k>for</span> <span class=n>dat</span><span class=p>,</span> <span class=n>lab</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>labels</span><span class=p>):</span>
</span><span id=__span-0-596><a id=__codelineno-0-596 name=__codelineno-0-596></a>        <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-597><a id=__codelineno-0-597 name=__codelineno-0-597></a>            <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>dat</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-598><a id=__codelineno-0-598 name=__codelineno-0-598></a>                <span class=n>dat</span> <span class=o>=</span> <span class=n>load_numpy</span><span class=p>(</span><span class=n>dat</span><span class=p>)</span>
</span><span id=__span-0-599><a id=__codelineno-0-599 name=__codelineno-0-599></a>
</span><span id=__span-0-600><a id=__codelineno-0-600 name=__codelineno-0-600></a>            <span class=k>if</span> <span class=n>lab</span> <span class=ow>is</span> <span class=ow>not</span> <span class=kc>None</span> <span class=ow>and</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>lab</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-601><a id=__codelineno-0-601 name=__codelineno-0-601></a>                <span class=n>lab</span> <span class=o>=</span> <span class=n>load_numpy</span><span class=p>(</span><span class=n>lab</span><span class=p>)</span>
</span><span id=__span-0-602><a id=__codelineno-0-602 name=__codelineno-0-602></a>
</span><span id=__span-0-603><a id=__codelineno-0-603 name=__codelineno-0-603></a>            <span class=n>labeled_data</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>dat</span><span class=p>,</span> <span class=n>lab</span><span class=p>))</span>
</span><span id=__span-0-604><a id=__codelineno-0-604 name=__codelineno-0-604></a>        <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>err</span><span class=p>:</span>
</span><span id=__span-0-605><a id=__codelineno-0-605 name=__codelineno-0-605></a>            <span class=k>if</span> <span class=n>raise_on_error</span><span class=p>:</span>
</span><span id=__span-0-606><a id=__codelineno-0-606 name=__codelineno-0-606></a>                <span class=k>raise</span> <span class=n>err</span>
</span><span id=__span-0-607><a id=__codelineno-0-607 name=__codelineno-0-607></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-608><a id=__codelineno-0-608 name=__codelineno-0-608></a>                <span class=n>logger</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s2>&quot;Error creating labeled data: </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>err</span><span class=p>))</span>
</span><span id=__span-0-609><a id=__codelineno-0-609 name=__codelineno-0-609></a>
</span><span id=__span-0-610><a id=__codelineno-0-610 name=__codelineno-0-610></a>    <span class=k>return</span> <span class=n>labeled_data</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.load_numpy class="doc doc-heading"> <code class="highlight language-python"><span class=n>load_numpy</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Load a numpy file into either an ndarray or an OrderedDict representing what was in the npz file</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>file_path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the file_path to load</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Union>Union</span>[<span title=numpy.ndarray>ndarray</span>, <span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>]]</code> </td> <td> <div class=doc-md-description> <p>the loaded values from the file</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-427>427</a></span>
<span class=normal><a href=#__codelineno-0-428>428</a></span>
<span class=normal><a href=#__codelineno-0-429>429</a></span>
<span class=normal><a href=#__codelineno-0-430>430</a></span>
<span class=normal><a href=#__codelineno-0-431>431</a></span>
<span class=normal><a href=#__codelineno-0-432>432</a></span>
<span class=normal><a href=#__codelineno-0-433>433</a></span>
<span class=normal><a href=#__codelineno-0-434>434</a></span>
<span class=normal><a href=#__codelineno-0-435>435</a></span>
<span class=normal><a href=#__codelineno-0-436>436</a></span>
<span class=normal><a href=#__codelineno-0-437>437</a></span>
<span class=normal><a href=#__codelineno-0-438>438</a></span>
<span class=normal><a href=#__codelineno-0-439>439</a></span>
<span class=normal><a href=#__codelineno-0-440>440</a></span>
<span class=normal><a href=#__codelineno-0-441>441</a></span>
<span class=normal><a href=#__codelineno-0-442>442</a></span>
<span class=normal><a href=#__codelineno-0-443>443</a></span>
<span class=normal><a href=#__codelineno-0-444>444</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-427><a id=__codelineno-0-427 name=__codelineno-0-427></a><span class=k>def</span><span class=w> </span><span class=nf>load_numpy</span><span class=p>(</span><span class=n>file_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]]:</span>
</span><span id=__span-0-428><a id=__codelineno-0-428 name=__codelineno-0-428></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-429><a id=__codelineno-0-429 name=__codelineno-0-429></a><span class=sd>    Load a numpy file into either an ndarray or an OrderedDict representing what</span>
</span><span id=__span-0-430><a id=__codelineno-0-430 name=__codelineno-0-430></a><span class=sd>    was in the npz file</span>
</span><span id=__span-0-431><a id=__codelineno-0-431 name=__codelineno-0-431></a>
</span><span id=__span-0-432><a id=__codelineno-0-432 name=__codelineno-0-432></a><span class=sd>    :param file_path: the file_path to load</span>
</span><span id=__span-0-433><a id=__codelineno-0-433 name=__codelineno-0-433></a><span class=sd>    :return: the loaded values from the file</span>
</span><span id=__span-0-434><a id=__codelineno-0-434 name=__codelineno-0-434></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-435><a id=__codelineno-0-435 name=__codelineno-0-435></a>    <span class=n>file_path</span> <span class=o>=</span> <span class=n>clean_path</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span><span id=__span-0-436><a id=__codelineno-0-436 name=__codelineno-0-436></a>    <span class=n>array</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span><span id=__span-0-437><a id=__codelineno-0-437 name=__codelineno-0-437></a>
</span><span id=__span-0-438><a id=__codelineno-0-438 name=__codelineno-0-438></a>    <span class=k>if</span> <span class=ow>not</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>array</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
</span><span id=__span-0-439><a id=__codelineno-0-439 name=__codelineno-0-439></a>        <span class=n>tmp_arrray</span> <span class=o>=</span> <span class=n>array</span>
</span><span id=__span-0-440><a id=__codelineno-0-440 name=__codelineno-0-440></a>        <span class=n>array</span> <span class=o>=</span> <span class=n>OrderedDict</span><span class=p>()</span>
</span><span id=__span-0-441><a id=__codelineno-0-441 name=__codelineno-0-441></a>        <span class=k>for</span> <span class=n>key</span><span class=p>,</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>tmp_arrray</span><span class=o>.</span><span class=n>items</span><span class=p>():</span>
</span><span id=__span-0-442><a id=__codelineno-0-442 name=__codelineno-0-442></a>            <span class=n>array</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>val</span>
</span><span id=__span-0-443><a id=__codelineno-0-443 name=__codelineno-0-443></a>
</span><span id=__span-0-444><a id=__codelineno-0-444 name=__codelineno-0-444></a>    <span class=k>return</span> <span class=n>array</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.load_numpy_from_tar class="doc doc-heading"> <code class="highlight language-python"><span class=n>load_numpy_from_tar</span><span class=p>(</span><span class=n>path</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Load numpy data into a list from a tar file. All files contained in the tar are expected to be the numpy files.</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>path to the tarfile to load the numpy data from</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.List>List</span>[<span title=typing.Union>Union</span>[<span title=numpy.ndarray>ndarray</span>, <span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>]]]</code> </td> <td> <div class=doc-md-description> <p>the list of loaded numpy data, either arrays or ordereddicts of arrays</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-496>496</a></span>
<span class=normal><a href=#__codelineno-0-497>497</a></span>
<span class=normal><a href=#__codelineno-0-498>498</a></span>
<span class=normal><a href=#__codelineno-0-499>499</a></span>
<span class=normal><a href=#__codelineno-0-500>500</a></span>
<span class=normal><a href=#__codelineno-0-501>501</a></span>
<span class=normal><a href=#__codelineno-0-502>502</a></span>
<span class=normal><a href=#__codelineno-0-503>503</a></span>
<span class=normal><a href=#__codelineno-0-504>504</a></span>
<span class=normal><a href=#__codelineno-0-505>505</a></span>
<span class=normal><a href=#__codelineno-0-506>506</a></span>
<span class=normal><a href=#__codelineno-0-507>507</a></span>
<span class=normal><a href=#__codelineno-0-508>508</a></span>
<span class=normal><a href=#__codelineno-0-509>509</a></span>
<span class=normal><a href=#__codelineno-0-510>510</a></span>
<span class=normal><a href=#__codelineno-0-511>511</a></span>
<span class=normal><a href=#__codelineno-0-512>512</a></span>
<span class=normal><a href=#__codelineno-0-513>513</a></span>
<span class=normal><a href=#__codelineno-0-514>514</a></span>
<span class=normal><a href=#__codelineno-0-515>515</a></span>
<span class=normal><a href=#__codelineno-0-516>516</a></span>
<span class=normal><a href=#__codelineno-0-517>517</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-496><a id=__codelineno-0-496 name=__codelineno-0-496></a><span class=k>def</span><span class=w> </span><span class=nf>load_numpy_from_tar</span><span class=p>(</span>
</span><span id=__span-0-497><a id=__codelineno-0-497 name=__codelineno-0-497></a>    <span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-498><a id=__codelineno-0-498 name=__codelineno-0-498></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]]]:</span>
</span><span id=__span-0-499><a id=__codelineno-0-499 name=__codelineno-0-499></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-500><a id=__codelineno-0-500 name=__codelineno-0-500></a><span class=sd>    Load numpy data into a list from a tar file.</span>
</span><span id=__span-0-501><a id=__codelineno-0-501 name=__codelineno-0-501></a><span class=sd>    All files contained in the tar are expected to be the numpy files.</span>
</span><span id=__span-0-502><a id=__codelineno-0-502 name=__codelineno-0-502></a><span class=sd>    :param path: path to the tarfile to load the numpy data from</span>
</span><span id=__span-0-503><a id=__codelineno-0-503 name=__codelineno-0-503></a><span class=sd>    :return: the list of loaded numpy data, either arrays or ordereddicts of arrays</span>
</span><span id=__span-0-504><a id=__codelineno-0-504 name=__codelineno-0-504></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-505><a id=__codelineno-0-505 name=__codelineno-0-505></a>    <span class=n>tar</span> <span class=o>=</span> <span class=n>tarfile</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=s2>&quot;r&quot;</span><span class=p>)</span>
</span><span id=__span-0-506><a id=__codelineno-0-506 name=__codelineno-0-506></a>    <span class=n>files</span> <span class=o>=</span> <span class=n>tar</span><span class=o>.</span><span class=n>getmembers</span><span class=p>()</span>
</span><span id=__span-0-507><a id=__codelineno-0-507 name=__codelineno-0-507></a>    <span class=n>files</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>([</span><span class=n>file</span><span class=o>.</span><span class=n>name</span> <span class=k>for</span> <span class=n>file</span> <span class=ow>in</span> <span class=n>files</span><span class=p>])</span>
</span><span id=__span-0-508><a id=__codelineno-0-508 name=__codelineno-0-508></a>    <span class=n>data</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-509><a id=__codelineno-0-509 name=__codelineno-0-509></a>
</span><span id=__span-0-510><a id=__codelineno-0-510 name=__codelineno-0-510></a>    <span class=k>for</span> <span class=n>file</span> <span class=ow>in</span> <span class=n>files</span><span class=p>:</span>
</span><span id=__span-0-511><a id=__codelineno-0-511 name=__codelineno-0-511></a>        <span class=n>extracted</span> <span class=o>=</span> <span class=n>BytesIO</span><span class=p>()</span>
</span><span id=__span-0-512><a id=__codelineno-0-512 name=__codelineno-0-512></a>        <span class=n>extracted</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>tar</span><span class=o>.</span><span class=n>extractfile</span><span class=p>(</span><span class=n>file</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>())</span>
</span><span id=__span-0-513><a id=__codelineno-0-513 name=__codelineno-0-513></a>        <span class=n>extracted</span><span class=o>.</span><span class=n>seek</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-0-514><a id=__codelineno-0-514 name=__codelineno-0-514></a>        <span class=n>array</span> <span class=o>=</span> <span class=n>numpy</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=n>extracted</span><span class=p>)</span>
</span><span id=__span-0-515><a id=__codelineno-0-515 name=__codelineno-0-515></a>        <span class=n>data</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>_fix_loaded_numpy</span><span class=p>(</span><span class=n>array</span><span class=p>))</span>
</span><span id=__span-0-516><a id=__codelineno-0-516 name=__codelineno-0-516></a>
</span><span id=__span-0-517><a id=__codelineno-0-517 name=__codelineno-0-517></a>    <span class=k>return</span> <span class=n>data</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.load_numpy_list class="doc doc-heading"> <code class="highlight language-python"><span class=n>load_numpy_list</span><span class=p>(</span><span class=n>data</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Load numpy data into a list</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>data</code> </td> <td> <code><span title=typing.Union>Union</span>[<span title=str>str</span>, <span title=typing.Iterable>Iterable</span>[<span title=typing.Union>Union</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>, <span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>]]]]</code> </td> <td> <div class=doc-md-description> <p>the data to load, one of: [folder path, iterable of file paths, iterable of numpy arrays]</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.List>List</span>[<span title=typing.Union>Union</span>[<span title=numpy.ndarray>ndarray</span>, <span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>]]]</code> </td> <td> <div class=doc-md-description> <p>the list of loaded data items</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-520>520</a></span>
<span class=normal><a href=#__codelineno-0-521>521</a></span>
<span class=normal><a href=#__codelineno-0-522>522</a></span>
<span class=normal><a href=#__codelineno-0-523>523</a></span>
<span class=normal><a href=#__codelineno-0-524>524</a></span>
<span class=normal><a href=#__codelineno-0-525>525</a></span>
<span class=normal><a href=#__codelineno-0-526>526</a></span>
<span class=normal><a href=#__codelineno-0-527>527</a></span>
<span class=normal><a href=#__codelineno-0-528>528</a></span>
<span class=normal><a href=#__codelineno-0-529>529</a></span>
<span class=normal><a href=#__codelineno-0-530>530</a></span>
<span class=normal><a href=#__codelineno-0-531>531</a></span>
<span class=normal><a href=#__codelineno-0-532>532</a></span>
<span class=normal><a href=#__codelineno-0-533>533</a></span>
<span class=normal><a href=#__codelineno-0-534>534</a></span>
<span class=normal><a href=#__codelineno-0-535>535</a></span>
<span class=normal><a href=#__codelineno-0-536>536</a></span>
<span class=normal><a href=#__codelineno-0-537>537</a></span>
<span class=normal><a href=#__codelineno-0-538>538</a></span>
<span class=normal><a href=#__codelineno-0-539>539</a></span>
<span class=normal><a href=#__codelineno-0-540>540</a></span>
<span class=normal><a href=#__codelineno-0-541>541</a></span>
<span class=normal><a href=#__codelineno-0-542>542</a></span>
<span class=normal><a href=#__codelineno-0-543>543</a></span>
<span class=normal><a href=#__codelineno-0-544>544</a></span>
<span class=normal><a href=#__codelineno-0-545>545</a></span>
<span class=normal><a href=#__codelineno-0-546>546</a></span>
<span class=normal><a href=#__codelineno-0-547>547</a></span>
<span class=normal><a href=#__codelineno-0-548>548</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-520><a id=__codelineno-0-520 name=__codelineno-0-520></a><span class=k>def</span><span class=w> </span><span class=nf>load_numpy_list</span><span class=p>(</span>
</span><span id=__span-0-521><a id=__codelineno-0-521 name=__codelineno-0-521></a>    <span class=n>data</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]]]],</span>
</span><span id=__span-0-522><a id=__codelineno-0-522 name=__codelineno-0-522></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=n>Union</span><span class=p>[</span><span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]]]:</span>
</span><span id=__span-0-523><a id=__codelineno-0-523 name=__codelineno-0-523></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-524><a id=__codelineno-0-524 name=__codelineno-0-524></a><span class=sd>    Load numpy data into a list</span>
</span><span id=__span-0-525><a id=__codelineno-0-525 name=__codelineno-0-525></a><span class=sd>    :param data: the data to load, one of:</span>
</span><span id=__span-0-526><a id=__codelineno-0-526 name=__codelineno-0-526></a><span class=sd>        [folder path, iterable of file paths, iterable of numpy arrays]</span>
</span><span id=__span-0-527><a id=__codelineno-0-527 name=__codelineno-0-527></a><span class=sd>    :return: the list of loaded data items</span>
</span><span id=__span-0-528><a id=__codelineno-0-528 name=__codelineno-0-528></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-529><a id=__codelineno-0-529 name=__codelineno-0-529></a>    <span class=n>loaded</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-530><a id=__codelineno-0-530 name=__codelineno-0-530></a>
</span><span id=__span-0-531><a id=__codelineno-0-531 name=__codelineno-0-531></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-532><a id=__codelineno-0-532 name=__codelineno-0-532></a>        <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isfile</span><span class=p>(</span><span class=n>data</span><span class=p>)</span> <span class=ow>and</span> <span class=n>tarfile</span><span class=o>.</span><span class=n>is_tarfile</span><span class=p>(</span><span class=n>data</span><span class=p>):</span>
</span><span id=__span-0-533><a id=__codelineno-0-533 name=__codelineno-0-533></a>            <span class=n>data</span> <span class=o>=</span> <span class=n>load_numpy_from_tar</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span><span id=__span-0-534><a id=__codelineno-0-534 name=__codelineno-0-534></a>        <span class=k>elif</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isfile</span><span class=p>(</span><span class=n>data</span><span class=p>)</span> <span class=ow>and</span> <span class=s2>&quot;.np&quot;</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span><span id=__span-0-535><a id=__codelineno-0-535 name=__codelineno-0-535></a>            <span class=c1># treat as a numpy file to load from</span>
</span><span id=__span-0-536><a id=__codelineno-0-536 name=__codelineno-0-536></a>            <span class=n>data</span> <span class=o>=</span> <span class=p>[</span><span class=n>load_numpy</span><span class=p>(</span><span class=n>data</span><span class=p>)]</span>
</span><span id=__span-0-537><a id=__codelineno-0-537 name=__codelineno-0-537></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-538><a id=__codelineno-0-538 name=__codelineno-0-538></a>            <span class=c1># load from directory or glob</span>
</span><span id=__span-0-539><a id=__codelineno-0-539 name=__codelineno-0-539></a>            <span class=n>glob_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=s2>&quot;*&quot;</span><span class=p>)</span> <span class=k>if</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isdir</span><span class=p>(</span><span class=n>data</span><span class=p>)</span> <span class=k>else</span> <span class=n>data</span>
</span><span id=__span-0-540><a id=__codelineno-0-540 name=__codelineno-0-540></a>            <span class=n>data</span> <span class=o>=</span> <span class=nb>sorted</span><span class=p>(</span><span class=n>glob</span><span class=o>.</span><span class=n>glob</span><span class=p>(</span><span class=n>glob_path</span><span class=p>))</span>
</span><span id=__span-0-541><a id=__codelineno-0-541 name=__codelineno-0-541></a>
</span><span id=__span-0-542><a id=__codelineno-0-542 name=__codelineno-0-542></a>    <span class=k>for</span> <span class=n>dat</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span><span id=__span-0-543><a id=__codelineno-0-543 name=__codelineno-0-543></a>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>dat</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-544><a id=__codelineno-0-544 name=__codelineno-0-544></a>            <span class=n>dat</span> <span class=o>=</span> <span class=n>load_numpy</span><span class=p>(</span><span class=n>dat</span><span class=p>)</span>
</span><span id=__span-0-545><a id=__codelineno-0-545 name=__codelineno-0-545></a>
</span><span id=__span-0-546><a id=__codelineno-0-546 name=__codelineno-0-546></a>        <span class=n>loaded</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>dat</span><span class=p>)</span>
</span><span id=__span-0-547><a id=__codelineno-0-547 name=__codelineno-0-547></a>
</span><span id=__span-0-548><a id=__codelineno-0-548 name=__codelineno-0-548></a>    <span class=k>return</span> <span class=n>loaded</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.patch_attr class="doc doc-heading"> <code class="highlight language-python"><span class=n>patch_attr</span><span class=p>(</span><span class=n>base</span><span class=p>,</span> <span class=n>attr</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Patch the value of an object attribute. Original value is restored upon exit</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>base</code> </td> <td> <code><span title=object>object</span></code> </td> <td> <div class=doc-md-description> <p>object which has the attribute to patch</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>attr</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>name of the the attribute to patch</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>value</code> </td> <td> <code><span title=typing.Any>Any</span></code> </td> <td> <div class=doc-md-description> <p>used to replace original value Usage: &gt;&gt;&gt; from types import SimpleNamespace &gt;&gt;&gt; obj = SimpleNamespace() &gt;&gt;&gt; with patch_attr(obj, "attribute", "value"): ... assert obj.attribute == "value" &gt;&gt;&gt; assert not hasattr(obj, "attribute")</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-1053>1053</a></span>
<span class=normal><a href=#__codelineno-0-1054>1054</a></span>
<span class=normal><a href=#__codelineno-0-1055>1055</a></span>
<span class=normal><a href=#__codelineno-0-1056>1056</a></span>
<span class=normal><a href=#__codelineno-0-1057>1057</a></span>
<span class=normal><a href=#__codelineno-0-1058>1058</a></span>
<span class=normal><a href=#__codelineno-0-1059>1059</a></span>
<span class=normal><a href=#__codelineno-0-1060>1060</a></span>
<span class=normal><a href=#__codelineno-0-1061>1061</a></span>
<span class=normal><a href=#__codelineno-0-1062>1062</a></span>
<span class=normal><a href=#__codelineno-0-1063>1063</a></span>
<span class=normal><a href=#__codelineno-0-1064>1064</a></span>
<span class=normal><a href=#__codelineno-0-1065>1065</a></span>
<span class=normal><a href=#__codelineno-0-1066>1066</a></span>
<span class=normal><a href=#__codelineno-0-1067>1067</a></span>
<span class=normal><a href=#__codelineno-0-1068>1068</a></span>
<span class=normal><a href=#__codelineno-0-1069>1069</a></span>
<span class=normal><a href=#__codelineno-0-1070>1070</a></span>
<span class=normal><a href=#__codelineno-0-1071>1071</a></span>
<span class=normal><a href=#__codelineno-0-1072>1072</a></span>
<span class=normal><a href=#__codelineno-0-1073>1073</a></span>
<span class=normal><a href=#__codelineno-0-1074>1074</a></span>
<span class=normal><a href=#__codelineno-0-1075>1075</a></span>
<span class=normal><a href=#__codelineno-0-1076>1076</a></span>
<span class=normal><a href=#__codelineno-0-1077>1077</a></span>
<span class=normal><a href=#__codelineno-0-1078>1078</a></span>
<span class=normal><a href=#__codelineno-0-1079>1079</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-1053><a id=__codelineno-0-1053 name=__codelineno-0-1053></a><span class=nd>@contextlib</span><span class=o>.</span><span class=n>contextmanager</span>
</span><span id=__span-0-1054><a id=__codelineno-0-1054 name=__codelineno-0-1054></a><span class=k>def</span><span class=w> </span><span class=nf>patch_attr</span><span class=p>(</span><span class=n>base</span><span class=p>:</span> <span class=nb>object</span><span class=p>,</span> <span class=n>attr</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>value</span><span class=p>:</span> <span class=n>Any</span><span class=p>):</span>
</span><span id=__span-0-1055><a id=__codelineno-0-1055 name=__codelineno-0-1055></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-1056><a id=__codelineno-0-1056 name=__codelineno-0-1056></a><span class=sd>    Patch the value of an object attribute. Original value is restored upon exit</span>
</span><span id=__span-0-1057><a id=__codelineno-0-1057 name=__codelineno-0-1057></a>
</span><span id=__span-0-1058><a id=__codelineno-0-1058 name=__codelineno-0-1058></a><span class=sd>    :param base: object which has the attribute to patch</span>
</span><span id=__span-0-1059><a id=__codelineno-0-1059 name=__codelineno-0-1059></a><span class=sd>    :param attr: name of the the attribute to patch</span>
</span><span id=__span-0-1060><a id=__codelineno-0-1060 name=__codelineno-0-1060></a><span class=sd>    :param value: used to replace original value</span>
</span><span id=__span-0-1061><a id=__codelineno-0-1061 name=__codelineno-0-1061></a>
</span><span id=__span-0-1062><a id=__codelineno-0-1062 name=__codelineno-0-1062></a><span class=sd>    Usage:</span>
</span><span id=__span-0-1063><a id=__codelineno-0-1063 name=__codelineno-0-1063></a><span class=sd>    &gt;&gt;&gt; from types import SimpleNamespace</span>
</span><span id=__span-0-1064><a id=__codelineno-0-1064 name=__codelineno-0-1064></a><span class=sd>    &gt;&gt;&gt; obj = SimpleNamespace()</span>
</span><span id=__span-0-1065><a id=__codelineno-0-1065 name=__codelineno-0-1065></a><span class=sd>    &gt;&gt;&gt; with patch_attr(obj, &quot;attribute&quot;, &quot;value&quot;):</span>
</span><span id=__span-0-1066><a id=__codelineno-0-1066 name=__codelineno-0-1066></a><span class=sd>    ...     assert obj.attribute == &quot;value&quot;</span>
</span><span id=__span-0-1067><a id=__codelineno-0-1067 name=__codelineno-0-1067></a><span class=sd>    &gt;&gt;&gt; assert not hasattr(obj, &quot;attribute&quot;)</span>
</span><span id=__span-0-1068><a id=__codelineno-0-1068 name=__codelineno-0-1068></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-1069><a id=__codelineno-0-1069 name=__codelineno-0-1069></a>    <span class=n>_sentinel</span> <span class=o>=</span> <span class=nb>object</span><span class=p>()</span>
</span><span id=__span-0-1070><a id=__codelineno-0-1070 name=__codelineno-0-1070></a>    <span class=n>original_value</span> <span class=o>=</span> <span class=nb>getattr</span><span class=p>(</span><span class=n>base</span><span class=p>,</span> <span class=n>attr</span><span class=p>,</span> <span class=n>_sentinel</span><span class=p>)</span>
</span><span id=__span-0-1071><a id=__codelineno-0-1071 name=__codelineno-0-1071></a>
</span><span id=__span-0-1072><a id=__codelineno-0-1072 name=__codelineno-0-1072></a>    <span class=nb>setattr</span><span class=p>(</span><span class=n>base</span><span class=p>,</span> <span class=n>attr</span><span class=p>,</span> <span class=n>value</span><span class=p>)</span>
</span><span id=__span-0-1073><a id=__codelineno-0-1073 name=__codelineno-0-1073></a>    <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-1074><a id=__codelineno-0-1074 name=__codelineno-0-1074></a>        <span class=k>yield</span>
</span><span id=__span-0-1075><a id=__codelineno-0-1075 name=__codelineno-0-1075></a>    <span class=k>finally</span><span class=p>:</span>
</span><span id=__span-0-1076><a id=__codelineno-0-1076 name=__codelineno-0-1076></a>        <span class=k>if</span> <span class=n>original_value</span> <span class=ow>is</span> <span class=ow>not</span> <span class=n>_sentinel</span><span class=p>:</span>
</span><span id=__span-0-1077><a id=__codelineno-0-1077 name=__codelineno-0-1077></a>            <span class=nb>setattr</span><span class=p>(</span><span class=n>base</span><span class=p>,</span> <span class=n>attr</span><span class=p>,</span> <span class=n>original_value</span><span class=p>)</span>
</span><span id=__span-0-1078><a id=__codelineno-0-1078 name=__codelineno-0-1078></a>        <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-1079><a id=__codelineno-0-1079 name=__codelineno-0-1079></a>            <span class=nb>delattr</span><span class=p>(</span><span class=n>base</span><span class=p>,</span> <span class=n>attr</span><span class=p>)</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.path_file_count class="doc doc-heading"> <code class="highlight language-python"><span class=n>path_file_count</span><span class=p>(</span><span class=n>path</span><span class=p>,</span> <span class=n>pattern</span><span class=o>=</span><span class=s1>&#39;*&#39;</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return the number of files that match the given pattern under the given path</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the path to the directory to look for files under</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>pattern</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the pattern the files must match to be counted</p> </div> </td> <td> <code>&#39;*&#39;</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>the number of files matching the pattern under the directory</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-353>353</a></span>
<span class=normal><a href=#__codelineno-0-354>354</a></span>
<span class=normal><a href=#__codelineno-0-355>355</a></span>
<span class=normal><a href=#__codelineno-0-356>356</a></span>
<span class=normal><a href=#__codelineno-0-357>357</a></span>
<span class=normal><a href=#__codelineno-0-358>358</a></span>
<span class=normal><a href=#__codelineno-0-359>359</a></span>
<span class=normal><a href=#__codelineno-0-360>360</a></span>
<span class=normal><a href=#__codelineno-0-361>361</a></span>
<span class=normal><a href=#__codelineno-0-362>362</a></span>
<span class=normal><a href=#__codelineno-0-363>363</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-353><a id=__codelineno-0-353 name=__codelineno-0-353></a><span class=k>def</span><span class=w> </span><span class=nf>path_file_count</span><span class=p>(</span><span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>pattern</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;*&quot;</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span><span id=__span-0-354><a id=__codelineno-0-354 name=__codelineno-0-354></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-355><a id=__codelineno-0-355 name=__codelineno-0-355></a><span class=sd>    Return the number of files that match the given pattern under the given path</span>
</span><span id=__span-0-356><a id=__codelineno-0-356 name=__codelineno-0-356></a>
</span><span id=__span-0-357><a id=__codelineno-0-357 name=__codelineno-0-357></a><span class=sd>    :param path: the path to the directory to look for files under</span>
</span><span id=__span-0-358><a id=__codelineno-0-358 name=__codelineno-0-358></a><span class=sd>    :param pattern: the pattern the files must match to be counted</span>
</span><span id=__span-0-359><a id=__codelineno-0-359 name=__codelineno-0-359></a><span class=sd>    :return: the number of files matching the pattern under the directory</span>
</span><span id=__span-0-360><a id=__codelineno-0-360 name=__codelineno-0-360></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-361><a id=__codelineno-0-361 name=__codelineno-0-361></a>    <span class=n>path</span> <span class=o>=</span> <span class=n>clean_path</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span><span id=__span-0-362><a id=__codelineno-0-362 name=__codelineno-0-362></a>
</span><span id=__span-0-363><a id=__codelineno-0-363 name=__codelineno-0-363></a>    <span class=k>return</span> <span class=nb>len</span><span class=p>(</span><span class=n>fnmatch</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=n>path</span><span class=p>),</span> <span class=n>pattern</span><span class=p>))</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.path_file_size class="doc doc-heading"> <code class="highlight language-python"><span class=n>path_file_size</span><span class=p>(</span><span class=n>path</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Return the total size, in bytes, for a path on the file system</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>path</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the path (directory or file) to get the size for</p> </div> </td> <td> <em>required</em> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>the size of the path, in bytes, as stored on disk</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-366>366</a></span>
<span class=normal><a href=#__codelineno-0-367>367</a></span>
<span class=normal><a href=#__codelineno-0-368>368</a></span>
<span class=normal><a href=#__codelineno-0-369>369</a></span>
<span class=normal><a href=#__codelineno-0-370>370</a></span>
<span class=normal><a href=#__codelineno-0-371>371</a></span>
<span class=normal><a href=#__codelineno-0-372>372</a></span>
<span class=normal><a href=#__codelineno-0-373>373</a></span>
<span class=normal><a href=#__codelineno-0-374>374</a></span>
<span class=normal><a href=#__codelineno-0-375>375</a></span>
<span class=normal><a href=#__codelineno-0-376>376</a></span>
<span class=normal><a href=#__codelineno-0-377>377</a></span>
<span class=normal><a href=#__codelineno-0-378>378</a></span>
<span class=normal><a href=#__codelineno-0-379>379</a></span>
<span class=normal><a href=#__codelineno-0-380>380</a></span>
<span class=normal><a href=#__codelineno-0-381>381</a></span>
<span class=normal><a href=#__codelineno-0-382>382</a></span>
<span class=normal><a href=#__codelineno-0-383>383</a></span>
<span class=normal><a href=#__codelineno-0-384>384</a></span>
<span class=normal><a href=#__codelineno-0-385>385</a></span>
<span class=normal><a href=#__codelineno-0-386>386</a></span>
<span class=normal><a href=#__codelineno-0-387>387</a></span>
<span class=normal><a href=#__codelineno-0-388>388</a></span>
<span class=normal><a href=#__codelineno-0-389>389</a></span>
<span class=normal><a href=#__codelineno-0-390>390</a></span>
<span class=normal><a href=#__codelineno-0-391>391</a></span>
<span class=normal><a href=#__codelineno-0-392>392</a></span>
<span class=normal><a href=#__codelineno-0-393>393</a></span>
<span class=normal><a href=#__codelineno-0-394>394</a></span>
<span class=normal><a href=#__codelineno-0-395>395</a></span>
<span class=normal><a href=#__codelineno-0-396>396</a></span>
<span class=normal><a href=#__codelineno-0-397>397</a></span>
<span class=normal><a href=#__codelineno-0-398>398</a></span>
<span class=normal><a href=#__codelineno-0-399>399</a></span>
<span class=normal><a href=#__codelineno-0-400>400</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-366><a id=__codelineno-0-366 name=__codelineno-0-366></a><span class=k>def</span><span class=w> </span><span class=nf>path_file_size</span><span class=p>(</span><span class=n>path</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
</span><span id=__span-0-367><a id=__codelineno-0-367 name=__codelineno-0-367></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-368><a id=__codelineno-0-368 name=__codelineno-0-368></a><span class=sd>    Return the total size, in bytes, for a path on the file system</span>
</span><span id=__span-0-369><a id=__codelineno-0-369 name=__codelineno-0-369></a>
</span><span id=__span-0-370><a id=__codelineno-0-370 name=__codelineno-0-370></a><span class=sd>    :param path: the path (directory or file) to get the size for</span>
</span><span id=__span-0-371><a id=__codelineno-0-371 name=__codelineno-0-371></a><span class=sd>    :return: the size of the path, in bytes, as stored on disk</span>
</span><span id=__span-0-372><a id=__codelineno-0-372 name=__codelineno-0-372></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-373><a id=__codelineno-0-373 name=__codelineno-0-373></a>
</span><span id=__span-0-374><a id=__codelineno-0-374 name=__codelineno-0-374></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isdir</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span><span id=__span-0-375><a id=__codelineno-0-375 name=__codelineno-0-375></a>        <span class=n>stat</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>stat</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>
</span><span id=__span-0-376><a id=__codelineno-0-376 name=__codelineno-0-376></a>
</span><span id=__span-0-377><a id=__codelineno-0-377 name=__codelineno-0-377></a>        <span class=k>return</span> <span class=n>stat</span><span class=o>.</span><span class=n>st_size</span>
</span><span id=__span-0-378><a id=__codelineno-0-378 name=__codelineno-0-378></a>
</span><span id=__span-0-379><a id=__codelineno-0-379 name=__codelineno-0-379></a>    <span class=n>total_size</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-0-380><a id=__codelineno-0-380 name=__codelineno-0-380></a>    <span class=n>seen</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-0-381><a id=__codelineno-0-381 name=__codelineno-0-381></a>
</span><span id=__span-0-382><a id=__codelineno-0-382 name=__codelineno-0-382></a>    <span class=k>for</span> <span class=n>dir_path</span><span class=p>,</span> <span class=n>dir_names</span><span class=p>,</span> <span class=n>filenames</span> <span class=ow>in</span> <span class=n>os</span><span class=o>.</span><span class=n>walk</span><span class=p>(</span><span class=n>path</span><span class=p>):</span>
</span><span id=__span-0-383><a id=__codelineno-0-383 name=__codelineno-0-383></a>        <span class=k>for</span> <span class=n>file</span> <span class=ow>in</span> <span class=n>filenames</span><span class=p>:</span>
</span><span id=__span-0-384><a id=__codelineno-0-384 name=__codelineno-0-384></a>            <span class=n>file_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>dir_path</span><span class=p>,</span> <span class=n>file</span><span class=p>)</span>
</span><span id=__span-0-385><a id=__codelineno-0-385 name=__codelineno-0-385></a>
</span><span id=__span-0-386><a id=__codelineno-0-386 name=__codelineno-0-386></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-387><a id=__codelineno-0-387 name=__codelineno-0-387></a>                <span class=n>stat</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>stat</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span><span id=__span-0-388><a id=__codelineno-0-388 name=__codelineno-0-388></a>            <span class=k>except</span> <span class=ne>OSError</span><span class=p>:</span>
</span><span id=__span-0-389><a id=__codelineno-0-389 name=__codelineno-0-389></a>                <span class=k>continue</span>
</span><span id=__span-0-390><a id=__codelineno-0-390 name=__codelineno-0-390></a>
</span><span id=__span-0-391><a id=__codelineno-0-391 name=__codelineno-0-391></a>            <span class=k>try</span><span class=p>:</span>
</span><span id=__span-0-392><a id=__codelineno-0-392 name=__codelineno-0-392></a>                <span class=n>seen</span><span class=p>[</span><span class=n>stat</span><span class=o>.</span><span class=n>st_ino</span><span class=p>]</span>
</span><span id=__span-0-393><a id=__codelineno-0-393 name=__codelineno-0-393></a>            <span class=k>except</span> <span class=ne>KeyError</span><span class=p>:</span>
</span><span id=__span-0-394><a id=__codelineno-0-394 name=__codelineno-0-394></a>                <span class=n>seen</span><span class=p>[</span><span class=n>stat</span><span class=o>.</span><span class=n>st_ino</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-0-395><a id=__codelineno-0-395 name=__codelineno-0-395></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-396><a id=__codelineno-0-396 name=__codelineno-0-396></a>                <span class=k>continue</span>
</span><span id=__span-0-397><a id=__codelineno-0-397 name=__codelineno-0-397></a>
</span><span id=__span-0-398><a id=__codelineno-0-398 name=__codelineno-0-398></a>            <span class=n>total_size</span> <span class=o>+=</span> <span class=n>stat</span><span class=o>.</span><span class=n>st_size</span>
</span><span id=__span-0-399><a id=__codelineno-0-399 name=__codelineno-0-399></a>
</span><span id=__span-0-400><a id=__codelineno-0-400 name=__codelineno-0-400></a>    <span class=k>return</span> <span class=n>total_size</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.save_numpy class="doc doc-heading"> <code class="highlight language-python"><span class=n>save_numpy</span><span class=p>(</span><span class=n>array</span><span class=p>,</span> <span class=n>export_dir</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>npz</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p>Save a numpy array or collection of numpy arrays to disk</p> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>array</code> </td> <td> <code><span title=typing.Union>Union</span>[<span title=numpy.ndarray>ndarray</span>, <span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>], <span title=typing.Iterable>Iterable</span>[<span title=numpy.ndarray>ndarray</span>]]</code> </td> <td> <div class=doc-md-description> <p>the array or collection of arrays to save</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>export_dir</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the directory to export the numpy file into</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the name of the file to export to (without extension)</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>npz</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>True to save as an npz compressed file, False for standard npy. Note, npy can only be used for single numpy arrays</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> </td> <td> <div class=doc-md-description> <p>the saved path</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-447>447</a></span>
<span class=normal><a href=#__codelineno-0-448>448</a></span>
<span class=normal><a href=#__codelineno-0-449>449</a></span>
<span class=normal><a href=#__codelineno-0-450>450</a></span>
<span class=normal><a href=#__codelineno-0-451>451</a></span>
<span class=normal><a href=#__codelineno-0-452>452</a></span>
<span class=normal><a href=#__codelineno-0-453>453</a></span>
<span class=normal><a href=#__codelineno-0-454>454</a></span>
<span class=normal><a href=#__codelineno-0-455>455</a></span>
<span class=normal><a href=#__codelineno-0-456>456</a></span>
<span class=normal><a href=#__codelineno-0-457>457</a></span>
<span class=normal><a href=#__codelineno-0-458>458</a></span>
<span class=normal><a href=#__codelineno-0-459>459</a></span>
<span class=normal><a href=#__codelineno-0-460>460</a></span>
<span class=normal><a href=#__codelineno-0-461>461</a></span>
<span class=normal><a href=#__codelineno-0-462>462</a></span>
<span class=normal><a href=#__codelineno-0-463>463</a></span>
<span class=normal><a href=#__codelineno-0-464>464</a></span>
<span class=normal><a href=#__codelineno-0-465>465</a></span>
<span class=normal><a href=#__codelineno-0-466>466</a></span>
<span class=normal><a href=#__codelineno-0-467>467</a></span>
<span class=normal><a href=#__codelineno-0-468>468</a></span>
<span class=normal><a href=#__codelineno-0-469>469</a></span>
<span class=normal><a href=#__codelineno-0-470>470</a></span>
<span class=normal><a href=#__codelineno-0-471>471</a></span>
<span class=normal><a href=#__codelineno-0-472>472</a></span>
<span class=normal><a href=#__codelineno-0-473>473</a></span>
<span class=normal><a href=#__codelineno-0-474>474</a></span>
<span class=normal><a href=#__codelineno-0-475>475</a></span>
<span class=normal><a href=#__codelineno-0-476>476</a></span>
<span class=normal><a href=#__codelineno-0-477>477</a></span>
<span class=normal><a href=#__codelineno-0-478>478</a></span>
<span class=normal><a href=#__codelineno-0-479>479</a></span>
<span class=normal><a href=#__codelineno-0-480>480</a></span>
<span class=normal><a href=#__codelineno-0-481>481</a></span>
<span class=normal><a href=#__codelineno-0-482>482</a></span>
<span class=normal><a href=#__codelineno-0-483>483</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-447><a id=__codelineno-0-447 name=__codelineno-0-447></a><span class=k>def</span><span class=w> </span><span class=nf>save_numpy</span><span class=p>(</span>
</span><span id=__span-0-448><a id=__codelineno-0-448 name=__codelineno-0-448></a>    <span class=n>array</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>],</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]],</span>
</span><span id=__span-0-449><a id=__codelineno-0-449 name=__codelineno-0-449></a>    <span class=n>export_dir</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-450><a id=__codelineno-0-450 name=__codelineno-0-450></a>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-451><a id=__codelineno-0-451 name=__codelineno-0-451></a>    <span class=n>npz</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-452><a id=__codelineno-0-452 name=__codelineno-0-452></a><span class=p>):</span>
</span><span id=__span-0-453><a id=__codelineno-0-453 name=__codelineno-0-453></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-454><a id=__codelineno-0-454 name=__codelineno-0-454></a><span class=sd>    Save a numpy array or collection of numpy arrays to disk</span>
</span><span id=__span-0-455><a id=__codelineno-0-455 name=__codelineno-0-455></a>
</span><span id=__span-0-456><a id=__codelineno-0-456 name=__codelineno-0-456></a><span class=sd>    :param array: the array or collection of arrays to save</span>
</span><span id=__span-0-457><a id=__codelineno-0-457 name=__codelineno-0-457></a><span class=sd>    :param export_dir: the directory to export the numpy file into</span>
</span><span id=__span-0-458><a id=__codelineno-0-458 name=__codelineno-0-458></a><span class=sd>    :param name: the name of the file to export to (without extension)</span>
</span><span id=__span-0-459><a id=__codelineno-0-459 name=__codelineno-0-459></a><span class=sd>    :param npz: True to save as an npz compressed file, False for standard npy.</span>
</span><span id=__span-0-460><a id=__codelineno-0-460 name=__codelineno-0-460></a><span class=sd>        Note, npy can only be used for single numpy arrays</span>
</span><span id=__span-0-461><a id=__codelineno-0-461 name=__codelineno-0-461></a><span class=sd>    :return: the saved path</span>
</span><span id=__span-0-462><a id=__codelineno-0-462 name=__codelineno-0-462></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-463><a id=__codelineno-0-463 name=__codelineno-0-463></a>    <span class=n>create_dirs</span><span class=p>(</span><span class=n>export_dir</span><span class=p>)</span>
</span><span id=__span-0-464><a id=__codelineno-0-464 name=__codelineno-0-464></a>    <span class=n>export_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
</span><span id=__span-0-465><a id=__codelineno-0-465 name=__codelineno-0-465></a>        <span class=n>export_dir</span><span class=p>,</span> <span class=s2>&quot;</span><span class=si>{}</span><span class=s2>.</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=s2>&quot;npz&quot;</span> <span class=k>if</span> <span class=n>npz</span> <span class=k>else</span> <span class=s2>&quot;npy&quot;</span><span class=p>)</span>
</span><span id=__span-0-466><a id=__codelineno-0-466 name=__codelineno-0-466></a>    <span class=p>)</span>
</span><span id=__span-0-467><a id=__codelineno-0-467 name=__codelineno-0-467></a>
</span><span id=__span-0-468><a id=__codelineno-0-468 name=__codelineno-0-468></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>array</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=ow>and</span> <span class=n>npz</span><span class=p>:</span>
</span><span id=__span-0-469><a id=__codelineno-0-469 name=__codelineno-0-469></a>        <span class=n>numpy</span><span class=o>.</span><span class=n>savez_compressed</span><span class=p>(</span><span class=n>export_path</span><span class=p>,</span> <span class=n>array</span><span class=p>)</span>
</span><span id=__span-0-470><a id=__codelineno-0-470 name=__codelineno-0-470></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>array</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
</span><span id=__span-0-471><a id=__codelineno-0-471 name=__codelineno-0-471></a>        <span class=n>numpy</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>export_path</span><span class=p>,</span> <span class=n>array</span><span class=p>)</span>
</span><span id=__span-0-472><a id=__codelineno-0-472 name=__codelineno-0-472></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>array</span><span class=p>,</span> <span class=n>Dict</span><span class=p>)</span> <span class=ow>and</span> <span class=n>npz</span><span class=p>:</span>
</span><span id=__span-0-473><a id=__codelineno-0-473 name=__codelineno-0-473></a>        <span class=n>numpy</span><span class=o>.</span><span class=n>savez_compressed</span><span class=p>(</span><span class=n>export_path</span><span class=p>,</span> <span class=o>**</span><span class=n>array</span><span class=p>)</span>
</span><span id=__span-0-474><a id=__codelineno-0-474 name=__codelineno-0-474></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>array</span><span class=p>,</span> <span class=n>Dict</span><span class=p>):</span>
</span><span id=__span-0-475><a id=__codelineno-0-475 name=__codelineno-0-475></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Dict can only be exported to an npz file&quot;</span><span class=p>)</span>
</span><span id=__span-0-476><a id=__codelineno-0-476 name=__codelineno-0-476></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>array</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>)</span> <span class=ow>and</span> <span class=n>npz</span><span class=p>:</span>
</span><span id=__span-0-477><a id=__codelineno-0-477 name=__codelineno-0-477></a>        <span class=n>numpy</span><span class=o>.</span><span class=n>savez_compressed</span><span class=p>(</span><span class=n>export_path</span><span class=p>,</span> <span class=o>*</span><span class=p>[</span><span class=n>val</span> <span class=k>for</span> <span class=n>val</span> <span class=ow>in</span> <span class=n>array</span><span class=p>])</span>
</span><span id=__span-0-478><a id=__codelineno-0-478 name=__codelineno-0-478></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>array</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>):</span>
</span><span id=__span-0-479><a id=__codelineno-0-479 name=__codelineno-0-479></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Iterable can only be exported to an npz file&quot;</span><span class=p>)</span>
</span><span id=__span-0-480><a id=__codelineno-0-480 name=__codelineno-0-480></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-481><a id=__codelineno-0-481 name=__codelineno-0-481></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;Unrecognized type given for array </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>array</span><span class=p>))</span>
</span><span id=__span-0-482><a id=__codelineno-0-482 name=__codelineno-0-482></a>
</span><span id=__span-0-483><a id=__codelineno-0-483 name=__codelineno-0-483></a>    <span class=k>return</span> <span class=n>export_path</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.tensor_export class="doc doc-heading"> <code class="highlight language-python"><span class=n>tensor_export</span><span class=p>(</span><span class=n>tensor</span><span class=p>,</span> <span class=n>export_dir</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>npz</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>tensor</code> </td> <td> <code><span title=typing.Union>Union</span>[<span title=numpy.ndarray>ndarray</span>, <span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>], <span title=typing.Iterable>Iterable</span>[<span title=numpy.ndarray>ndarray</span>]]</code> </td> <td> <div class=doc-md-description> <p>tensor to export to a saved numpy array file</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>export_dir</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the directory to export the file in</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>name</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the name of the file, .npy will be appended to it</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>npz</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>True to export as an npz file, False otherwise</p> </div> </td> <td> <code>True</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the path of the numpy file the tensor was exported to</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-696>696</a></span>
<span class=normal><a href=#__codelineno-0-697>697</a></span>
<span class=normal><a href=#__codelineno-0-698>698</a></span>
<span class=normal><a href=#__codelineno-0-699>699</a></span>
<span class=normal><a href=#__codelineno-0-700>700</a></span>
<span class=normal><a href=#__codelineno-0-701>701</a></span>
<span class=normal><a href=#__codelineno-0-702>702</a></span>
<span class=normal><a href=#__codelineno-0-703>703</a></span>
<span class=normal><a href=#__codelineno-0-704>704</a></span>
<span class=normal><a href=#__codelineno-0-705>705</a></span>
<span class=normal><a href=#__codelineno-0-706>706</a></span>
<span class=normal><a href=#__codelineno-0-707>707</a></span>
<span class=normal><a href=#__codelineno-0-708>708</a></span>
<span class=normal><a href=#__codelineno-0-709>709</a></span>
<span class=normal><a href=#__codelineno-0-710>710</a></span>
<span class=normal><a href=#__codelineno-0-711>711</a></span>
<span class=normal><a href=#__codelineno-0-712>712</a></span>
<span class=normal><a href=#__codelineno-0-713>713</a></span>
<span class=normal><a href=#__codelineno-0-714>714</a></span>
<span class=normal><a href=#__codelineno-0-715>715</a></span>
<span class=normal><a href=#__codelineno-0-716>716</a></span>
<span class=normal><a href=#__codelineno-0-717>717</a></span>
<span class=normal><a href=#__codelineno-0-718>718</a></span>
<span class=normal><a href=#__codelineno-0-719>719</a></span>
<span class=normal><a href=#__codelineno-0-720>720</a></span>
<span class=normal><a href=#__codelineno-0-721>721</a></span>
<span class=normal><a href=#__codelineno-0-722>722</a></span>
<span class=normal><a href=#__codelineno-0-723>723</a></span>
<span class=normal><a href=#__codelineno-0-724>724</a></span>
<span class=normal><a href=#__codelineno-0-725>725</a></span>
<span class=normal><a href=#__codelineno-0-726>726</a></span>
<span class=normal><a href=#__codelineno-0-727>727</a></span>
<span class=normal><a href=#__codelineno-0-728>728</a></span>
<span class=normal><a href=#__codelineno-0-729>729</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-696><a id=__codelineno-0-696 name=__codelineno-0-696></a><span class=k>def</span><span class=w> </span><span class=nf>tensor_export</span><span class=p>(</span>
</span><span id=__span-0-697><a id=__codelineno-0-697 name=__codelineno-0-697></a>    <span class=n>tensor</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>],</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]],</span>
</span><span id=__span-0-698><a id=__codelineno-0-698 name=__codelineno-0-698></a>    <span class=n>export_dir</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-699><a id=__codelineno-0-699 name=__codelineno-0-699></a>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-700><a id=__codelineno-0-700 name=__codelineno-0-700></a>    <span class=n>npz</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span>
</span><span id=__span-0-701><a id=__codelineno-0-701 name=__codelineno-0-701></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
</span><span id=__span-0-702><a id=__codelineno-0-702 name=__codelineno-0-702></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-703><a id=__codelineno-0-703 name=__codelineno-0-703></a><span class=sd>    :param tensor: tensor to export to a saved numpy array file</span>
</span><span id=__span-0-704><a id=__codelineno-0-704 name=__codelineno-0-704></a><span class=sd>    :param export_dir: the directory to export the file in</span>
</span><span id=__span-0-705><a id=__codelineno-0-705 name=__codelineno-0-705></a><span class=sd>    :param name: the name of the file, .npy will be appended to it</span>
</span><span id=__span-0-706><a id=__codelineno-0-706 name=__codelineno-0-706></a><span class=sd>    :param npz: True to export as an npz file, False otherwise</span>
</span><span id=__span-0-707><a id=__codelineno-0-707 name=__codelineno-0-707></a><span class=sd>    :return: the path of the numpy file the tensor was exported to</span>
</span><span id=__span-0-708><a id=__codelineno-0-708 name=__codelineno-0-708></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-709><a id=__codelineno-0-709 name=__codelineno-0-709></a>    <span class=n>create_dirs</span><span class=p>(</span><span class=n>export_dir</span><span class=p>)</span>
</span><span id=__span-0-710><a id=__codelineno-0-710 name=__codelineno-0-710></a>    <span class=n>export_path</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
</span><span id=__span-0-711><a id=__codelineno-0-711 name=__codelineno-0-711></a>        <span class=n>export_dir</span><span class=p>,</span> <span class=s2>&quot;</span><span class=si>{}</span><span class=s2>.</span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=s2>&quot;npz&quot;</span> <span class=k>if</span> <span class=n>npz</span> <span class=k>else</span> <span class=s2>&quot;npy&quot;</span><span class=p>)</span>
</span><span id=__span-0-712><a id=__codelineno-0-712 name=__codelineno-0-712></a>    <span class=p>)</span>
</span><span id=__span-0-713><a id=__codelineno-0-713 name=__codelineno-0-713></a>
</span><span id=__span-0-714><a id=__codelineno-0-714 name=__codelineno-0-714></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tensor</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>)</span> <span class=ow>and</span> <span class=n>npz</span><span class=p>:</span>
</span><span id=__span-0-715><a id=__codelineno-0-715 name=__codelineno-0-715></a>        <span class=n>numpy</span><span class=o>.</span><span class=n>savez_compressed</span><span class=p>(</span><span class=n>export_path</span><span class=p>,</span> <span class=n>tensor</span><span class=p>)</span>
</span><span id=__span-0-716><a id=__codelineno-0-716 name=__codelineno-0-716></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tensor</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
</span><span id=__span-0-717><a id=__codelineno-0-717 name=__codelineno-0-717></a>        <span class=n>numpy</span><span class=o>.</span><span class=n>save</span><span class=p>(</span><span class=n>export_path</span><span class=p>,</span> <span class=n>tensor</span><span class=p>)</span>
</span><span id=__span-0-718><a id=__codelineno-0-718 name=__codelineno-0-718></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tensor</span><span class=p>,</span> <span class=n>Dict</span><span class=p>)</span> <span class=ow>and</span> <span class=n>npz</span><span class=p>:</span>
</span><span id=__span-0-719><a id=__codelineno-0-719 name=__codelineno-0-719></a>        <span class=n>numpy</span><span class=o>.</span><span class=n>savez_compressed</span><span class=p>(</span><span class=n>export_path</span><span class=p>,</span> <span class=o>**</span><span class=n>tensor</span><span class=p>)</span>
</span><span id=__span-0-720><a id=__codelineno-0-720 name=__codelineno-0-720></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tensor</span><span class=p>,</span> <span class=n>Dict</span><span class=p>):</span>
</span><span id=__span-0-721><a id=__codelineno-0-721 name=__codelineno-0-721></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;tensor dictionaries can only be saved as npz&quot;</span><span class=p>)</span>
</span><span id=__span-0-722><a id=__codelineno-0-722 name=__codelineno-0-722></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tensor</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>)</span> <span class=ow>and</span> <span class=n>npz</span><span class=p>:</span>
</span><span id=__span-0-723><a id=__codelineno-0-723 name=__codelineno-0-723></a>        <span class=n>numpy</span><span class=o>.</span><span class=n>savez_compressed</span><span class=p>(</span><span class=n>export_path</span><span class=p>,</span> <span class=o>*</span><span class=n>tensor</span><span class=p>)</span>
</span><span id=__span-0-724><a id=__codelineno-0-724 name=__codelineno-0-724></a>    <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>tensor</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>):</span>
</span><span id=__span-0-725><a id=__codelineno-0-725 name=__codelineno-0-725></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;tensor iterables can only be saved as npz&quot;</span><span class=p>)</span>
</span><span id=__span-0-726><a id=__codelineno-0-726 name=__codelineno-0-726></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-727><a id=__codelineno-0-727 name=__codelineno-0-727></a>        <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;unknown type give for tensor </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>tensor</span><span class=p>))</span>
</span><span id=__span-0-728><a id=__codelineno-0-728 name=__codelineno-0-728></a>
</span><span id=__span-0-729><a id=__codelineno-0-729 name=__codelineno-0-729></a>    <span class=k>return</span> <span class=n>export_path</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.tensors_export class="doc doc-heading"> <code class="highlight language-python"><span class=n>tensors_export</span><span class=p>(</span><span class=n>tensors</span><span class=p>,</span> <span class=n>export_dir</span><span class=p>,</span> <span class=n>name_prefix</span><span class=p>,</span> <span class=n>counter</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>break_batch</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>tensors</code> </td> <td> <code><span title=typing.Union>Union</span>[<span title=numpy.ndarray>ndarray</span>, <span title=typing.Dict>Dict</span>[<span title=str>str</span>, <span title=numpy.ndarray>ndarray</span>], <span title=typing.Iterable>Iterable</span>[<span title=numpy.ndarray>ndarray</span>]]</code> </td> <td> <div class=doc-md-description> <p>the tensors to export to a saved numpy array file</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>export_dir</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the directory to export the files in</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>name_prefix</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the prefix name for the tensors to save as, will append info about the position of the tensor in a list or dict in addition to the .npy file format</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>counter</code> </td> <td> <code><span title=int>int</span></code> </td> <td> <div class=doc-md-description> <p>the current counter to save the tensor at</p> </div> </td> <td> <code>0</code> </td> </tr> <tr class=doc-section-item> <td> <code>break_batch</code> </td> <td> <code><span title=bool>bool</span></code> </td> <td> <div class=doc-md-description> <p>treat the tensor as a batch and break apart into multiple tensors</p> </div> </td> <td> <code>False</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.List>List</span>[<span title=str>str</span>]</code> </td> <td> <div class=doc-md-description> <p>the exported paths</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-732>732</a></span>
<span class=normal><a href=#__codelineno-0-733>733</a></span>
<span class=normal><a href=#__codelineno-0-734>734</a></span>
<span class=normal><a href=#__codelineno-0-735>735</a></span>
<span class=normal><a href=#__codelineno-0-736>736</a></span>
<span class=normal><a href=#__codelineno-0-737>737</a></span>
<span class=normal><a href=#__codelineno-0-738>738</a></span>
<span class=normal><a href=#__codelineno-0-739>739</a></span>
<span class=normal><a href=#__codelineno-0-740>740</a></span>
<span class=normal><a href=#__codelineno-0-741>741</a></span>
<span class=normal><a href=#__codelineno-0-742>742</a></span>
<span class=normal><a href=#__codelineno-0-743>743</a></span>
<span class=normal><a href=#__codelineno-0-744>744</a></span>
<span class=normal><a href=#__codelineno-0-745>745</a></span>
<span class=normal><a href=#__codelineno-0-746>746</a></span>
<span class=normal><a href=#__codelineno-0-747>747</a></span>
<span class=normal><a href=#__codelineno-0-748>748</a></span>
<span class=normal><a href=#__codelineno-0-749>749</a></span>
<span class=normal><a href=#__codelineno-0-750>750</a></span>
<span class=normal><a href=#__codelineno-0-751>751</a></span>
<span class=normal><a href=#__codelineno-0-752>752</a></span>
<span class=normal><a href=#__codelineno-0-753>753</a></span>
<span class=normal><a href=#__codelineno-0-754>754</a></span>
<span class=normal><a href=#__codelineno-0-755>755</a></span>
<span class=normal><a href=#__codelineno-0-756>756</a></span>
<span class=normal><a href=#__codelineno-0-757>757</a></span>
<span class=normal><a href=#__codelineno-0-758>758</a></span>
<span class=normal><a href=#__codelineno-0-759>759</a></span>
<span class=normal><a href=#__codelineno-0-760>760</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-732><a id=__codelineno-0-732 name=__codelineno-0-732></a><span class=k>def</span><span class=w> </span><span class=nf>tensors_export</span><span class=p>(</span>
</span><span id=__span-0-733><a id=__codelineno-0-733 name=__codelineno-0-733></a>    <span class=n>tensors</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>],</span> <span class=n>Iterable</span><span class=p>[</span><span class=n>numpy</span><span class=o>.</span><span class=n>ndarray</span><span class=p>]],</span>
</span><span id=__span-0-734><a id=__codelineno-0-734 name=__codelineno-0-734></a>    <span class=n>export_dir</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-735><a id=__codelineno-0-735 name=__codelineno-0-735></a>    <span class=n>name_prefix</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span><span id=__span-0-736><a id=__codelineno-0-736 name=__codelineno-0-736></a>    <span class=n>counter</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span>
</span><span id=__span-0-737><a id=__codelineno-0-737 name=__codelineno-0-737></a>    <span class=n>break_batch</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
</span><span id=__span-0-738><a id=__codelineno-0-738 name=__codelineno-0-738></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>List</span><span class=p>[</span><span class=nb>str</span><span class=p>]:</span>
</span><span id=__span-0-739><a id=__codelineno-0-739 name=__codelineno-0-739></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-740><a id=__codelineno-0-740 name=__codelineno-0-740></a><span class=sd>    :param tensors: the tensors to export to a saved numpy array file</span>
</span><span id=__span-0-741><a id=__codelineno-0-741 name=__codelineno-0-741></a><span class=sd>    :param export_dir: the directory to export the files in</span>
</span><span id=__span-0-742><a id=__codelineno-0-742 name=__codelineno-0-742></a><span class=sd>    :param name_prefix: the prefix name for the tensors to save as, will append</span>
</span><span id=__span-0-743><a id=__codelineno-0-743 name=__codelineno-0-743></a><span class=sd>        info about the position of the tensor in a list or dict in addition</span>
</span><span id=__span-0-744><a id=__codelineno-0-744 name=__codelineno-0-744></a><span class=sd>        to the .npy file format</span>
</span><span id=__span-0-745><a id=__codelineno-0-745 name=__codelineno-0-745></a><span class=sd>    :param counter: the current counter to save the tensor at</span>
</span><span id=__span-0-746><a id=__codelineno-0-746 name=__codelineno-0-746></a><span class=sd>    :param break_batch: treat the tensor as a batch and break apart into</span>
</span><span id=__span-0-747><a id=__codelineno-0-747 name=__codelineno-0-747></a><span class=sd>        multiple tensors</span>
</span><span id=__span-0-748><a id=__codelineno-0-748 name=__codelineno-0-748></a><span class=sd>    :return: the exported paths</span>
</span><span id=__span-0-749><a id=__codelineno-0-749 name=__codelineno-0-749></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-750><a id=__codelineno-0-750 name=__codelineno-0-750></a>    <span class=n>create_dirs</span><span class=p>(</span><span class=n>export_dir</span><span class=p>)</span>
</span><span id=__span-0-751><a id=__codelineno-0-751 name=__codelineno-0-751></a>    <span class=n>exported_paths</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-752><a id=__codelineno-0-752 name=__codelineno-0-752></a>
</span><span id=__span-0-753><a id=__codelineno-0-753 name=__codelineno-0-753></a>    <span class=k>if</span> <span class=n>break_batch</span><span class=p>:</span>
</span><span id=__span-0-754><a id=__codelineno-0-754 name=__codelineno-0-754></a>        <span class=n>_tensors_export_batch</span><span class=p>(</span><span class=n>tensors</span><span class=p>,</span> <span class=n>export_dir</span><span class=p>,</span> <span class=n>name_prefix</span><span class=p>,</span> <span class=n>counter</span><span class=p>,</span> <span class=n>exported_paths</span><span class=p>)</span>
</span><span id=__span-0-755><a id=__codelineno-0-755 name=__codelineno-0-755></a>    <span class=k>else</span><span class=p>:</span>
</span><span id=__span-0-756><a id=__codelineno-0-756 name=__codelineno-0-756></a>        <span class=n>_tensors_export_recursive</span><span class=p>(</span>
</span><span id=__span-0-757><a id=__codelineno-0-757 name=__codelineno-0-757></a>            <span class=n>tensors</span><span class=p>,</span> <span class=n>export_dir</span><span class=p>,</span> <span class=n>name_prefix</span><span class=p>,</span> <span class=n>counter</span><span class=p>,</span> <span class=n>exported_paths</span>
</span><span id=__span-0-758><a id=__codelineno-0-758 name=__codelineno-0-758></a>        <span class=p>)</span>
</span><span id=__span-0-759><a id=__codelineno-0-759 name=__codelineno-0-759></a>
</span><span id=__span-0-760><a id=__codelineno-0-760 name=__codelineno-0-760></a>    <span class=k>return</span> <span class=n>exported_paths</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h2 id=llmcompressor.utils.helpers.validate_str_iterable class="doc doc-heading"> <code class="highlight language-python"><span class=n>validate_str_iterable</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=n>error_desc</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span></code> </h2> <div class="doc doc-contents "> <p><span class=doc-section-title>Parameters:</span></p> <table> <thead> <tr> <th>Name</th> <th>Type</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code>val</code> </td> <td> <code><span title=typing.Union>Union</span>[<span title=str>str</span>, <span title=typing.Iterable>Iterable</span>[<span title=str>str</span>]]</code> </td> <td> <div class=doc-md-description> <p>the value to validate, check that it is a list (and flattens it), otherwise checks that it's an <strong>ALL</strong> or <strong>ALL_PRUNABLE</strong> string, otherwise raises a ValueError</p> </div> </td> <td> <em>required</em> </td> </tr> <tr class=doc-section-item> <td> <code>error_desc</code> </td> <td> <code><span title=str>str</span></code> </td> <td> <div class=doc-md-description> <p>the description to raise an error with in the event that the val wasn't valid</p> </div> </td> <td> <code>&#39;&#39;</code> </td> </tr> </tbody> </table> <p><span class=doc-section-title>Returns:</span></p> <table> <thead> <tr> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr class=doc-section-item> <td> <code><span title=typing.Union>Union</span>[<span title=str>str</span>, <span title=typing.Iterable>Iterable</span>[<span title=str>str</span>]]</code> </td> <td> <div class=doc-md-description> <p>the validated version of the param</p> </div> </td> </tr> </tbody> </table> <details class=quote> <summary>Source code in <code>src/llmcompressor/utils/helpers.py</code></summary> <div class="language-python highlight"><table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal><a href=#__codelineno-0-117>117</a></span>
<span class=normal><a href=#__codelineno-0-118>118</a></span>
<span class=normal><a href=#__codelineno-0-119>119</a></span>
<span class=normal><a href=#__codelineno-0-120>120</a></span>
<span class=normal><a href=#__codelineno-0-121>121</a></span>
<span class=normal><a href=#__codelineno-0-122>122</a></span>
<span class=normal><a href=#__codelineno-0-123>123</a></span>
<span class=normal><a href=#__codelineno-0-124>124</a></span>
<span class=normal><a href=#__codelineno-0-125>125</a></span>
<span class=normal><a href=#__codelineno-0-126>126</a></span>
<span class=normal><a href=#__codelineno-0-127>127</a></span>
<span class=normal><a href=#__codelineno-0-128>128</a></span>
<span class=normal><a href=#__codelineno-0-129>129</a></span>
<span class=normal><a href=#__codelineno-0-130>130</a></span>
<span class=normal><a href=#__codelineno-0-131>131</a></span>
<span class=normal><a href=#__codelineno-0-132>132</a></span>
<span class=normal><a href=#__codelineno-0-133>133</a></span>
<span class=normal><a href=#__codelineno-0-134>134</a></span>
<span class=normal><a href=#__codelineno-0-135>135</a></span>
<span class=normal><a href=#__codelineno-0-136>136</a></span>
<span class=normal><a href=#__codelineno-0-137>137</a></span>
<span class=normal><a href=#__codelineno-0-138>138</a></span>
<span class=normal><a href=#__codelineno-0-139>139</a></span></pre></div></td><td class=code><div><pre><span></span><code><span id=__span-0-117><a id=__codelineno-0-117 name=__codelineno-0-117></a><span class=k>def</span><span class=w> </span><span class=nf>validate_str_iterable</span><span class=p>(</span>
</span><span id=__span-0-118><a id=__codelineno-0-118 name=__codelineno-0-118></a>    <span class=n>val</span><span class=p>:</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>[</span><span class=nb>str</span><span class=p>]],</span> <span class=n>error_desc</span><span class=p>:</span> <span class=nb>str</span> <span class=o>=</span> <span class=s2>&quot;&quot;</span>
</span><span id=__span-0-119><a id=__codelineno-0-119 name=__codelineno-0-119></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Union</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>[</span><span class=nb>str</span><span class=p>]]:</span>
</span><span id=__span-0-120><a id=__codelineno-0-120 name=__codelineno-0-120></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
</span><span id=__span-0-121><a id=__codelineno-0-121 name=__codelineno-0-121></a><span class=sd>    :param val: the value to validate, check that it is a list (and flattens it),</span>
</span><span id=__span-0-122><a id=__codelineno-0-122 name=__codelineno-0-122></a><span class=sd>        otherwise checks that it&#39;s an __ALL__ or __ALL_PRUNABLE__ string,</span>
</span><span id=__span-0-123><a id=__codelineno-0-123 name=__codelineno-0-123></a><span class=sd>        otherwise raises a ValueError</span>
</span><span id=__span-0-124><a id=__codelineno-0-124 name=__codelineno-0-124></a><span class=sd>    :param error_desc: the description to raise an error with in the event that</span>
</span><span id=__span-0-125><a id=__codelineno-0-125 name=__codelineno-0-125></a><span class=sd>        the val wasn&#39;t valid</span>
</span><span id=__span-0-126><a id=__codelineno-0-126 name=__codelineno-0-126></a><span class=sd>    :return: the validated version of the param</span>
</span><span id=__span-0-127><a id=__codelineno-0-127 name=__codelineno-0-127></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-0-128><a id=__codelineno-0-128 name=__codelineno-0-128></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=nb>str</span><span class=p>):</span>
</span><span id=__span-0-129><a id=__codelineno-0-129 name=__codelineno-0-129></a>        <span class=k>if</span> <span class=n>val</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span> <span class=o>!=</span> <span class=n>ALL_TOKEN</span> <span class=ow>and</span> <span class=n>val</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span> <span class=o>!=</span> <span class=n>ALL_PRUNABLE_TOKEN</span><span class=p>:</span>
</span><span id=__span-0-130><a id=__codelineno-0-130 name=__codelineno-0-130></a>            <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
</span><span id=__span-0-131><a id=__codelineno-0-131 name=__codelineno-0-131></a>                <span class=s2>&quot;unsupported string (</span><span class=si>{}</span><span class=s2>) given in </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=n>error_desc</span><span class=p>)</span>
</span><span id=__span-0-132><a id=__codelineno-0-132 name=__codelineno-0-132></a>            <span class=p>)</span>
</span><span id=__span-0-133><a id=__codelineno-0-133 name=__codelineno-0-133></a>
</span><span id=__span-0-134><a id=__codelineno-0-134 name=__codelineno-0-134></a>        <span class=k>return</span> <span class=n>val</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span>
</span><span id=__span-0-135><a id=__codelineno-0-135 name=__codelineno-0-135></a>
</span><span id=__span-0-136><a id=__codelineno-0-136 name=__codelineno-0-136></a>    <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=n>Iterable</span><span class=p>):</span>
</span><span id=__span-0-137><a id=__codelineno-0-137 name=__codelineno-0-137></a>        <span class=k>return</span> <span class=n>flatten_iterable</span><span class=p>(</span><span class=n>val</span><span class=p>)</span>
</span><span id=__span-0-138><a id=__codelineno-0-138 name=__codelineno-0-138></a>
</span><span id=__span-0-139><a id=__codelineno-0-139 name=__codelineno-0-139></a>    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;unsupported type (</span><span class=si>{}</span><span class=s2>) given in </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>val</span><span class=p>,</span> <span class=n>error_desc</span><span class=p>))</span>
</span></code></pre></div></td></tr></table></div> </details> </div> </div> </div> </div> </div> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../dev/ class="md-footer__link md-footer__link--prev" aria-label="Previous: llmcompressor.utils.dev"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> llmcompressor.utils.dev </div> </div> </a> <a href=../metric_logging/ class="md-footer__link md-footer__link--next" aria-label="Next: llmcompressor.utils.metric_logging"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> llmcompressor.utils.metric_logging </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["content.action.edit", "content.code.annotate", "content.code.copy", "content.code.select", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.path", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "default": ["stable", "development"], "provider": "mike"}}</script> <script src=../../../../assets/javascripts/bundle.13a4f30d.min.js></script> <script src=../../../../scripts/mathjax.js></script> <script src=https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js></script> </body> </html>